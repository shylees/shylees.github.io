{"title":"10 axios","date":"2021-05-01T16:00:00.000Z","date_formatted":{"ll":"May 2, 2021","L":"05/02/2021","MM-DD":"05-02"},"link":"learningNotes/vue/10 axios","tags":["vue"],"categories":["learningNotes"],"updated":"2021-05-02T16:00:00.000Z","content":"<p>[toc]</p>\n<h2 id=\"1.axios功能特点\">1.axios功能特点<a title=\"#1.axios功能特点\" href=\"#1.axios功能特点\"></a></h2>\n<ul>\n<li>在浏览器中发送XMLHttpRequests请求</li>\n<li>在node.js中发送http请求</li>\n<li>支持Promise API</li>\n<li>拦截请求和响应</li>\n<li>转换请求和响应数据</li>\n</ul>\n<h2 id=\"2.axios请求方式\">2.axios请求方式<a title=\"#2.axios请求方式\" href=\"#2.axios请求方式\"></a></h2>\n<ul>\n<li><code>axios(config)</code> 默认get请求</li>\n<li><code>axios.request(config)</code></li>\n<li><code>axios.get(url[,config])</code></li>\n<li><code>axios.delete(url[,config])</code></li>\n<li><code>axios.head(url[,config])</code></li>\n<li><code>axios.post(url[,data[,config]])</code></li>\n<li><code>axios.put(url[,data[,config]])</code></li>\n<li><code>axios.patch(url[,data[,config]])</code></li>\n</ul>\n<h2 id=\"3.axios框架的基本使用\">3.axios框架的基本使用<a title=\"#3.axios框架的基本使用\" href=\"#3.axios框架的基本使用\"></a></h2>\n<p>接口：<a href=\"http://123.207.32.32:8000/home/multidata\">http://123.207.32.32:8000/home/multidata</a></p>\n<p>axios默认是get方法</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//get请求</span></span><br><span class=\"line\"><span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>:<span class=\"string\">&quot;http://123.207.32.32:8000/home/multidata&quot;</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//带参数</span></span><br><span class=\"line\"><span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>:<span class=\"string\">&quot;http://123.207.32.32:8000/home/data?type=pop&amp;page=1&quot;</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//get请求的参数拼接</span></span><br><span class=\"line\"><span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>:<span class=\"string\">&quot;http://123.207.32.32:8000/home/data&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">params</span>:&#123;</span><br><span class=\"line\">        <span class=\"attr\">type</span>:<span class=\"string\">&#x27;pop&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">page</span>:<span class=\"number\">1</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"2.axios发送并发请求\">2.axios发送并发请求<a title=\"#2.axios发送并发请求\" href=\"#2.axios发送并发请求\"></a></h2>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.<span class=\"title function_\">all</span>([<span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">url</span>: <span class=\"string\">&quot;http://123.207.32.32:8000/home/multidata&quot;</span></span><br><span class=\"line\">    &#125;), <span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">url</span>: <span class=\"string\">&quot;http://123.207.32.32:8000/home/data&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">params</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">type</span>: <span class=\"string\">&#x27;pop&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">page</span>: <span class=\"number\">2</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)])</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">results</span> =&gt;</span> &#123;</span><br><span class=\"line\">         <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(results);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 使用axios.spread可将数组[res1,res2]展开</span></span><br><span class=\"line\">axios.<span class=\"title function_\">all</span>([<span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">url</span>: <span class=\"string\">&quot;http://123.207.32.32:8000/home/multidata&quot;</span></span><br><span class=\"line\">    &#125;), <span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">url</span>: <span class=\"string\">&quot;http://123.207.32.32:8000/home/data&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">params</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">type</span>: <span class=\"string\">&#x27;pop&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">page</span>: <span class=\"number\">2</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)])</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(axios.<span class=\"title function_\">spread</span>(<span class=\"function\">(<span class=\"params\">res1, res2</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res1);</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res2);</span><br><span class=\"line\">    &#125;))</span><br></pre></td></tr></table></figure>\n<h2 id=\"3.全局配置\">3.全局配置<a title=\"#3.全局配置\" href=\"#3.全局配置\"></a></h2>\n<p>因为BaseURL是固定的，可以抽取/利用axios的全局配置</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 3.全局配置 </span></span><br><span class=\"line\"><span class=\"comment\">//超时 ms</span></span><br><span class=\"line\">axios.<span class=\"property\">defaults</span>.<span class=\"property\">baseURL</span> = <span class=\"string\">&quot;http://123.207.32.32:8000&quot;</span></span><br><span class=\"line\">axios.<span class=\"property\">defaults</span>.<span class=\"property\">timeout</span> = <span class=\"number\">5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//get请求</span></span><br><span class=\"line\"><span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>: <span class=\"string\">&quot;/home/multidata&quot;</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// console.log(res);</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.2常见的配置选项\">3.2常见的配置选项<a title=\"#3.2常见的配置选项\" href=\"#3.2常见的配置选项\"></a></h3>\n<p>如果是put  params</p>\n<p>如果是post data</p>\n<img src='https://s1.328888.xyz/2022/04/09/XaK8e.jpg'>\n<h2 id=\"4.axios实例和模块封装\">4.axios实例和模块封装<a title=\"#4.axios实例和模块封装\" href=\"#4.axios实例和模块封装\"></a></h2>\n<h3 id=\"4.1如果有多个请求接口时-使用实例会比较好\">4.1如果有多个请求接口时 使用实例会比较好<a title=\"#4.1如果有多个请求接口时-使用实例会比较好\" href=\"#4.1如果有多个请求接口时-使用实例会比较好\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//main.js</span></span><br><span class=\"line\"><span class=\"comment\">// 4.创建对应的实例</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> instance1 = axios.<span class=\"title function_\">create</span>(&#123;</span><br><span class=\"line\">    baseURL = <span class=\"string\">&quot;htp://123.207.32.32:8000&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">timeout</span>: <span class=\"number\">5000</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">instance1</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>: <span class=\"string\">&quot;/home/multidata&quot;</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">instance1</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>: <span class=\"string\">&quot;/home/data&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">params</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;pop&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">page</span>: <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> instance2 = axios.<span class=\"title function_\">create</span>(&#123;</span><br><span class=\"line\">  baseURL = <span class=\"string\">&quot;htp://123.207.33.11:8000&quot;</span>,</span><br><span class=\"line\">  <span class=\"attr\">timeout</span>: <span class=\"number\">5000</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"4.2-模块封装\">4.2 模块封装<a title=\"#4.2-模块封装\" href=\"#4.2-模块封装\"></a></h3>\n<p>如果有个第三方的东西需要导入，不要每一个组件都导入这个第三方框架，这样每个页面对这个框架依赖性太强了，如果有一天这个第三方的东西不再维护了，所有页面都得换掉</p>\n<p>所以尽量封装成一个文件，这样改的话就改一个文件的就可以了</p>\n<h4 id=\"4.2.1.每个页面都导入的情况\">4.2.1.每个页面都导入的情况<a title=\"#4.2.1.每个页面都导入的情况\" href=\"#4.2.1.每个页面都导入的情况\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//vue</span></span><br><span class=\"line\">&lt;h2&gt;&#123;&#123; categories &#125;&#125;&lt;/h2&gt;</span><br><span class=\"line\"><span class=\"keyword\">import</span> axios <span class=\"keyword\">from</span> <span class=\"string\">&#x27;axios&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>:<span class=\"string\">&quot;HelloWorld&quot;</span>,</span><br><span class=\"line\">    <span class=\"title function_\">data</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">            <span class=\"attr\">categories</span>:<span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">//生命周期函数  组件创建好后 发送请求</span></span><br><span class=\"line\">    <span class=\"title function_\">created</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">url</span>:<span class=\"string\">&quot;http://123.207.32.32:8000/category&quot;</span></span><br><span class=\"line\">        &#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">categories</span> = res;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4.2.2-封装\">4.2.2 封装<a title=\"#4.2.2-封装\" href=\"#4.2.2-封装\"></a></h4>\n<h5 id=\"4.2.2.1-src建文件夹-network-建request.js\">4.2.2.1 src建文件夹 network 建request.js<a title=\"#4.2.2.1-src建文件夹-network-建request.js\" href=\"#4.2.2.1-src建文件夹-network-建request.js\"></a></h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//request.js</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> axios <span class=\"keyword\">from</span> <span class=\"string\">&quot;axios&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">request</span>(<span class=\"params\">config, success, failure</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 1.创建axios的实例</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> instance = axios.<span class=\"title function_\">create</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">baseURL</span>: <span class=\"string\">&quot;http://123.207.32.32:8000&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">timeout</span>: <span class=\"number\">5000</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 发送真正的网络请求</span></span><br><span class=\"line\">    <span class=\"comment\">// 通过两个函数 吧把结果回调出去</span></span><br><span class=\"line\">    <span class=\"title function_\">instance</span>(config).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">        <span class=\"title function_\">success</span>(res)</span><br><span class=\"line\">    &#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">        <span class=\"title function_\">failure</span>(err)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//main.js</span></span><br><span class=\"line\"><span class=\"comment\">//5.封装reque模块</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; request &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./network/request&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">request</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>: <span class=\"string\">&#x27;/home/multidata&#x27;</span></span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h5 id=\"4.2.2.2-另一种封装方法：\">4.2.2.2 另一种封装方法：<a title=\"#4.2.2.2-另一种封装方法：\" href=\"#4.2.2.2-另一种封装方法：\"></a></h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//request.js</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> axios <span class=\"keyword\">from</span> <span class=\"string\">&quot;axios&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">request</span>(<span class=\"params\">config</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 1.创建axios的实例</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> instance = axios.<span class=\"title function_\">create</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">baseURL</span>: <span class=\"string\">&quot;http://123.207.32.32:8000&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">timeout</span>: <span class=\"number\">5000</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">instance</span>(config.<span class=\"property\">baseConfig</span>).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        config.<span class=\"title function_\">success</span>(res)</span><br><span class=\"line\">    &#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">        config.<span class=\"title function_\">failure</span>(err)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//mian.js</span></span><br><span class=\"line\"><span class=\"title function_\">request</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">baseConfig</span>:&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">success</span>:<span class=\"keyword\">function</span>(<span class=\"params\">res</span>)&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">failure</span>:<span class=\"keyword\">function</span>(<span class=\"params\">err</span>)&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h5 id=\"4.2.2.3-推荐使用promise\">4.2.2.3 推荐使用promise<a title=\"#4.2.2.3-推荐使用promise\" href=\"#4.2.2.3-推荐使用promise\"></a></h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//request.js</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> axios <span class=\"keyword\">from</span> <span class=\"string\">&quot;axios&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">request</span>(<span class=\"params\">config, success, failure</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 1.创建axios的实例</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> instance = axios.<span class=\"title function_\">create</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">baseURL</span>: <span class=\"string\">&quot;http://123.207.32.32:8000&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">timeout</span>: <span class=\"number\">5000</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">instance</span>(config).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">        <span class=\"title function_\">success</span>(res)</span><br><span class=\"line\">    &#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">        <span class=\"title function_\">failure</span>(err)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//main.js</span></span><br><span class=\"line\"><span class=\"title function_\">request</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>:<span class=\"string\">&quot;/home/multidata&quot;</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">&#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h5 id=\"4.2.2.4--最终使用-axios的实例的返回值就是promise\">4.2.2.4  最终使用 axios的实例的返回值就是promise<a title=\"#4.2.2.4--最终使用-axios的实例的返回值就是promise\" href=\"#4.2.2.4--最终使用-axios的实例的返回值就是promise\"></a></h5>\n<blockquote>\n<p>因为instance可以直接使用.then .catch方法</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//request.js</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> axios <span class=\"keyword\">from</span> <span class=\"string\">&quot;axios&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">request</span>(<span class=\"params\">config</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 1.创建axios的实例</span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> instance = axios.<span class=\"title function_\">create</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">baseURL</span>: <span class=\"string\">&quot;http://123.207.32.32:8000&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">timeout</span>: <span class=\"number\">5000</span></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"comment\">//发送真正的网络请求</span></span><br><span class=\"line\">       <span class=\"keyword\">return</span> <span class=\"title function_\">instance</span>(config)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//main.js</span></span><br><span class=\"line\"><span class=\"title function_\">request</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>:<span class=\"string\">&quot;/home/multidata&quot;</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">&#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>如果到时候axios不能用了，只需要改4-10行的代码就可以 了</p>\n</blockquote>\n<h2 id=\"5.axios拦截器\">5.axios拦截器<a title=\"#5.axios拦截器\" href=\"#5.axios拦截器\"></a></h2>\n<p>四种拦截器：请求成功/失败 、响应成功/失败：服务器没有具体是数据过来，传了错误码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">request</span>(<span class=\"params\">config</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 1.创建axios的实例</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> instance = axios.<span class=\"title function_\">create</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">baseURL</span>: <span class=\"string\">&quot;http://123.207.32.32:8000&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">timeout</span>: <span class=\"number\">5000</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 2.axios的拦截器</span></span><br><span class=\"line\">    <span class=\"comment\">// 全局 axios.interceptors</span></span><br><span class=\"line\">    <span class=\"comment\">// 实例 instance.interceptors</span></span><br><span class=\"line\">    <span class=\"comment\">// 请求拦截</span></span><br><span class=\"line\">    instance.<span class=\"property\">interceptors</span>.<span class=\"property\">request</span>.<span class=\"title function_\">use</span>(<span class=\"function\"><span class=\"params\">config</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(config); <span class=\"comment\">//拦截下来的是配置 拦截了配置还得给返回回去 不然就会请求失败</span></span><br><span class=\"line\">        <span class=\"comment\">// 1.可以通过拦截的形式给config中的一些信息不符合服务器要求 设置header什么的</span></span><br><span class=\"line\">        <span class=\"comment\">// 2.可能在请求时 show 加载中的图标</span></span><br><span class=\"line\">        <span class=\"comment\">// 3.某些网络请求 是必须携带一些信息 例如登录 带token</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> config;</span><br><span class=\"line\">    &#125;, <span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"comment\">// 响应拦截</span></span><br><span class=\"line\">    instance.<span class=\"property\">interceptors</span>.<span class=\"property\">response</span>.<span class=\"title function_\">use</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//因为一般用的时候只用data就可以了</span></span><br><span class=\"line\">        <span class=\"comment\">// 拦截了结果得返回出去 不然main.js log.res时undefined</span></span><br><span class=\"line\">        <span class=\"comment\">// console.log(res);</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res.<span class=\"property\">data</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;, <span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 3.发送真正的网络请求</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"title function_\">instance</span>(config)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","prev":{"title":"EChart的使用","link":"learningNotes/ECharts的使用"},"next":{"title":"路径别名配置","link":"learningNotes/vue/07 封装tabbar的知识"},"plink":"https://shylees.github.io/learningNotes/vue/10 axios/","toc":[{"id":"1.axios功能特点","title":"1.axios功能特点","index":"1"},{"id":"2.axios请求方式","title":"2.axios请求方式","index":"2"},{"id":"3.axios框架的基本使用","title":"3.axios框架的基本使用","index":"3"},{"id":"2.axios发送并发请求","title":"2.axios发送并发请求","index":"4"},{"id":"3.全局配置","title":"3.全局配置","index":"5","children":[{"id":"3.2常见的配置选项","title":"3.2常见的配置选项","index":"5.1"}]},{"id":"4.axios实例和模块封装","title":"4.axios实例和模块封装","index":"6","children":[{"id":"4.1如果有多个请求接口时-使用实例会比较好","title":"4.1如果有多个请求接口时 使用实例会比较好","index":"6.1"},{"id":"4.2-模块封装","title":"4.2 模块封装","index":"6.2"}]},{"id":"5.axios拦截器","title":"5.axios拦截器","index":"7"}],"copyright":{"custom":"不许转载😡！！！"},"reading_time":"1482 words in 7 min"}