{"title":"滚轮事件","date":"2021-11-12T16:00:00.000Z","date_formatted":{"ll":"Nov 13, 2021","L":"11/13/2021","MM-DD":"11-13"},"link":"furtherNotes/further/04 滚轮事件","tags":["JavaScript"],"categories":["furtherNotes"],"updated":"2021-11-12T16:00:00.000Z","content":"<blockquote>\n<p>参考链接：</p>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/WheelEvent\">https://developer.mozilla.org/zh-CN/docs/Web/API/WheelEvent</a></p>\n<p><a href=\"https://juejin.cn/post/6974018969690734628\">https://juejin.cn/post/6974018969690734628</a></p>\n<p><a href=\"https://blog.csdn.net/TXW6666/article/details/106456045\">https://blog.csdn.net/TXW6666/article/details/106456045</a></p>\n<p><a href=\"https://blog.csdn.net/lijingshan34/article/details/88350456\">https://blog.csdn.net/lijingshan34/article/details/88350456</a></p>\n</blockquote>\n<h2 id=\"滚轮事件-wheelevent\">滚轮事件 wheelEvent<a title=\"#滚轮事件-wheelevent\" href=\"#滚轮事件-wheelevent\"></a></h2>\n<h3 id=\"1.-介绍滚轮事件\">1. 介绍滚轮事件<a title=\"#1.-介绍滚轮事件\" href=\"#1.-介绍滚轮事件\"></a></h3>\n<p>wheelEvent 接口表示用户滚动鼠标滚轮 或 类似输入设备时触发的事件。</p>\n<ul>\n<li>**该事件为标准规定的滚轮事件接口。**早期的浏览器实现过<a href=\"https://developer.mozilla.org/zh-CN/docs/conflicting/Web/API/WheelEvent\" target=\"_blank\"><code>MouseWheelEvent</code></a>和<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/MouseScrollEvent\" target=\"_blank\"><code>MouseScrollEvent</code></a>两种滚轮事件接口，但这两种接口皆非标准，加之各浏览器间对其兼容性极差。</li>\n</ul>\n<blockquote>\n<p>onmousewheel（firefox不支持）  DOMMouseScroll（只有firefox支持）</p>\n<p>因而开发者应使用该标准事件接口取代这两个非标准接口。</p>\n</blockquote>\n<ul>\n<li>\n<p><strong>不要混淆 <code>wheel</code> 事件和 <code>scroll</code> 事件：</strong><code>wheel</code> 事件的默认动作取决于浏览器实现。</p>\n<p>因此 <code>wheel</code> 事件不一定会触发 <code>scroll (en-US)</code> 事件。即便滚轮事件引发了文档内容的滚动行为，也不表示 <code>wheel</code> 事件中的 <code>delta*</code> 值恰好反映文档内容的滚动方向。因此，不要依赖 <code>delta*</code> 属性获知文档内容的滚动方向。可在文档内容滚动事件（<code>scroll</code>）中监视target的<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollLeft\" target=\"_blank\"><code>scrollLeft</code></a>和<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollTop\" target=\"_blank\"><code>scrollTop</code></a>的变化以推断滚动方向。</p>\n</li>\n</ul>\n<h3 id=\"2.-wheel-的事件对象的属性\">2. wheel 的事件对象的属性<a title=\"#2.-wheel-的事件对象的属性\" href=\"#2.-wheel-的事件对象的属性\"></a></h3>\n<h4 id=\"2.1-触发事件\">2.1 触发事件<a title=\"#2.1-触发事件\" href=\"#2.1-触发事件\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;wheel&#x27;</span>,(e)&#123;</span><br><span class=\"line\">    \t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(e)                          </span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n<h4 id=\"2.2-&lt;font-color=&quot;red&quot;&gt;事件对象对比&lt;/font&gt;\">2.2 <font color=\"red\">事件对象对比</font><a title=\"#2.2-&lt;font-color=&quot;red&quot;&gt;事件对象对比&lt;/font&gt;\" href=\"#2.2-&lt;font-color=&quot;red&quot;&gt;事件对象对比&lt;/font&gt;\"></a></h4>\n<p>在谷歌(左)和火狐打印的结果为：</p>\n<ul>\n<li>\n<p><strong>鼠标滚轮事件对象</strong></p>\n<ol>\n<li>\n<p><strong>页面往下( 滚轮往下滚)</strong></p>\n<img src='./img/wheel down1.png' style=\"zoom:67%;float:left\" >\n<img src='./img/wheel down2.jpg' style=\"zoom:70%;float:left\" >\n</li>\n<li>\n<p><strong>页面往上( 滚轮往下滚 )</strong></p>\n<img src='./img/wheel up1.jpg' style=\"zoom:70%;float:left\" >\n<img src='./img/wheel up2.jpg' style=\"zoom:70%;float:left\" >\n</li>\n</ol>\n</li>\n<li>\n<p><strong>触摸板滑动事件对象</strong></p>\n<ol>\n<li>\n<p><strong>页面往下( 触摸板向上滑动 )</strong></p>\n<img src=\"./img/chumoban_down1.jpg\" style=\"zoom:70%; float:left;\" >\n<img src=\"./img/chumoban_down2.jpg\" style=\"zoom:70%; float:left\" >\n</li>\n<li>\n<p><strong>页面往上( 触摸板往下滑动 )</strong></p>\n<img src=\"./img/chumoban_up1.jpg\" style=\"zoom:70%; float:left;\" >\n<img src=\"./img/chumoban_up2.jpg\" style=\"zoom:70%; float:left;\" >\n</li>\n</ol>\n</li>\n</ul>\n<p>总结：<strong>deltalY</strong>：页面向下：&gt; 0 ；页面向上：&lt; 0；</p>\n<p>​           <strong>wheelDelta | wheelDeltaY</strong>：向下 : &lt; 0；向上：&gt;0</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&quot;wheel&quot;</span>, <span class=\"keyword\">function</span> (<span class=\"params\">e</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> evt = e || <span class=\"variable language_\">window</span>.<span class=\"property\">event</span>;   <span class=\"comment\">//后面为了兼容 ie</span></span><br><span class=\"line\">    evt.<span class=\"title function_\">preventDefault</span>();          <span class=\"comment\">//阻止浏览器默认行为u</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (evt.<span class=\"property\">deltaY</span> &gt; <span class=\"number\">0</span> || evt.<span class=\"property\">wheelDelta</span> &lt; <span class=\"number\">0</span>) &#123; ... &#125; </span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (evt.<span class=\"property\">deltaY</span> &lt; <span class=\"number\">0</span> || evt.<span class=\"property\">wheelDelta</span> &gt; <span class=\"number\">0</span>) &#123; ... &#125;</span><br><span class=\"line\">  &#125;,&#123; <span class=\"attr\">passive</span>:<span class=\"literal\">false</span> &#125;);</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.-passive:-false\">3. passive: false<a title=\"#3.-passive:-false\" href=\"#3.-passive:-false\"></a></h3>\n<p><strong>!<code>&#123; passive:false &#125;</code>要加上</strong>，不然滚轮滚动页面的时候会报：<code>Unable to preventDefault inside passive event listener</code></p>\n<p>**原因：**Chorme56+开始为了让页面滚动变得更为流畅，在 window、document 和 body 上注册的 touchstart和 touchmove 事件处理函数，会默认为是 passive: true。</p>\n<blockquote>\n<p>之前：当浏览器首先对默认的事件进行响应的时候，要检查一下是否进行了默认事件的取消。这样就在响应滑动操作之前有那么一丝丝的耽误时间。</p>\n<p>现在：google就决定默认取消了对这个事件的检查，默认时间就取消了。直接执行滑动操作。这样就更加的顺滑了。</p>\n</blockquote>\n<p>浏览器忽略默认事件的preventDefault(), 要是手动阻止会弹出一个警告, 告诉你阻止不了!!!</p>\n<p><strong>解决：</strong></p>\n<ol>\n<li>\n<p><code>window.addEventListener('touchmove', func, &#123; passive: false &#125;)</code></p>\n</li>\n<li>\n<p><code>* &#123; touch-action:none; &#125;</code></p>\n<blockquote>\n<p>touch-action是css中的一个属性，用于设置触摸屏用户如何操纵元素的区域（例如浏览器内置的缩放功能）</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"4.-项目不足\">4. 项目不足<a title=\"#4.-项目不足\" href=\"#4.-项目不足\"></a></h3>\n<p>在项目实现的时候，没办法兼容触摸板滑动，因为触摸板每次滑动的时候会触发多次滚轮事件，就会使得页面从第一个板块滑倒页面底部。</p>\n<p>解决方案：节流防抖？</p>\n<p><strong>A：</strong></p>\n<ol>\n<li>\n<p>节流，页面会有一点延迟，不太友好</p>\n</li>\n<li>\n<p>防抖，鼠标滚动事件不会多次触发，还是处理得蛮好的，但是触摸板事件没办法像滚轮事件那样使用，好像并没有阻止到默认事件。</p>\n</li>\n</ol>\n","prev":{"title":"关于网络攻击那些事儿~","link":"furtherNotes/further/08 前端安全"},"next":{"title":"节流throttle、防抖debounce","link":"furtherNotes/further/05 节流防抖"},"plink":"https://shylees.github.io/furtherNotes/further/04 滚轮事件/","toc":[{"id":"滚轮事件-wheelevent","title":"滚轮事件 wheelEvent","index":"1","children":[{"id":"1.-介绍滚轮事件","title":"1. 介绍滚轮事件","index":"1.1"},{"id":"2.-wheel-的事件对象的属性","title":"2. wheel 的事件对象的属性","index":"1.2"},{"id":"3.-passive:-false","title":"3. passive: false","index":"1.3"},{"id":"4.-项目不足","title":"4. 项目不足","index":"1.4"}]}],"copyright":{"custom":"不许转载😡！！！"},"reading_time":"914 words in 5 min"}