{"title":"webpack 学习笔记","date":"2021-09-12T16:00:00.000Z","date_formatted":{"ll":"2021年9月13日","L":"2021/09/13","MM-DD":"09-13"},"link":"learningNotes/webpack/webpack","tags":["webpack"],"categories":["learningNotes","webpack"],"updated":"2021-09-14T16:00:00.000Z","content":"<h1 id=\"webpack(from-9.13-15)\">webpack(from 9.13-15)<a title=\"#webpack(from-9.13-15)\" href=\"#webpack(from-9.13-15)\"></a></h1>\n<h2 id=\"0.-atguigu-视频-的第三方包的版本\">0. atguigu 视频 的第三方包的版本<a title=\"#0.-atguigu-视频-的第三方包的版本\" href=\"#0.-atguigu-视频-的第三方包的版本\"></a></h2>\n<h4 id=\"0.1-创建项目-初始化项目\">0.1 创建项目 初始化项目<a title=\"#0.1-创建项目-初始化项目\" href=\"#0.1-创建项目-初始化项目\"></a></h4>\n<p>npm init</p>\n<h4 id=\"0.2-包版本\">0.2 包版本<a title=\"#0.2-包版本\" href=\"#0.2-包版本\"></a></h4>\n<h5 id=\"全局安装--g-和-本地安装--d-:\">全局安装 -g 和 本地安装 -D :<a title=\"#全局安装--g-和-本地安装--d-:\" href=\"#全局安装--g-和-本地安装--d-:\"></a></h5>\n<ul>\n<li>\n<p>webpack@4.41.6           我下的—5.52.1</p>\n</li>\n<li>\n<p>webpack-cli@3.3.11                 —4.8.0</p>\n</li>\n</ul>\n<h5 id=\"loader-和一些-pulgin-插件：\">loader 和一些 pulgin 插件：<a title=\"#loader-和一些-pulgin-插件：\" href=\"#loader-和一些-pulgin-插件：\"></a></h5>\n<h6 id=\"1.-处理css：\">1. 处理css：<a title=\"#1.-处理css：\" href=\"#1.-处理css：\"></a></h6>\n<p>css-loader@3.4.2   —6.2.0</p>\n<p>style-loader@1.1.3  —3.2.1</p>\n<h6 id=\"2.-处理less\">2. 处理less<a title=\"#2.-处理less\" href=\"#2.-处理less\"></a></h6>\n<p>less-loader@5.0.0   —10.0.1</p>\n<p>less@3.11.1  —4.1.1</p>\n<h6 id=\"3.-处理html\">3. 处理html<a title=\"#3.-处理html\" href=\"#3.-处理html\"></a></h6>\n<p>html-webpack-plugin@3.2.0   —5.3.2</p>\n<h6 id=\"4.-处理img\">4. 处理img<a title=\"#4.-处理img\" href=\"#4.-处理img\"></a></h6>\n<p>url-loader@3.0.0   —4.1.1</p>\n<p>file-loader@5.0.2   —6.2.0</p>\n<h6 id=\"5.-处理html-img\">5. 处理html img<a title=\"#5.-处理html-img\" href=\"#5.-处理html-img\"></a></h6>\n<p>html-loader@0.5.5   —2.1.2</p>\n<h6 id=\"6.-devserver\">6. devServer<a title=\"#6.-devserver\" href=\"#6.-devserver\"></a></h6>\n<p>webpack-dev-server@3.10.3   —4.2.0</p>\n<h6 id=\"7.-分离css\">7. 分离css<a title=\"#7.-分离css\" href=\"#7.-分离css\"></a></h6>\n<p>mini-css-extract-plugin@0.9.0</p>\n<h6 id=\"8.-css兼容\">8. css兼容<a title=\"#8.-css兼容\" href=\"#8.-css兼容\"></a></h6>\n<p>postcss-roader@3.0.0</p>\n<p>postcss-preset-env@6.7.0</p>\n<h6 id=\"9.-css压缩\">9. css压缩<a title=\"#9.-css压缩\" href=\"#9.-css压缩\"></a></h6>\n<p>optimize-css-assets-webpack-plugin@5.0.3</p>\n<h6 id=\"10.-js兼容\">10. js兼容<a title=\"#10.-js兼容\" href=\"#10.-js兼容\"></a></h6>\n<p>babel-roader@8.0.6</p>\n<p>@babel-preset-env@7.4.8</p>\n<p>@babel/core@7.8.4</p>\n<p>@babel-polyfill@7.8.3</p>\n<p>core-js@3.6.4</p>\n<h6 id=\"11.-pwa\">11. pwa<a title=\"#11.-pwa\" href=\"#11.-pwa\"></a></h6>\n<p>workbox-webpack-plugin@5.0.0</p>\n<p>serve@11.3.0</p>\n<h6 id=\"12.-多进程\">12. 多进程<a title=\"#12.-多进程\" href=\"#12.-多进程\"></a></h6>\n<p>thread-roader@2.1.3</p>\n<h6 id=\"13.-dll\">13. dll<a title=\"#13.-dll\" href=\"#13.-dll\"></a></h6>\n<p>add-asset-html-webpack-plugin@3.1.3</p>\n<p>terser-webpack-plugin@2.3.5</p>\n<h2 id=\"1.webpack-开发环境配置\">1.webpack 开发环境配置<a title=\"#1.webpack-开发环境配置\" href=\"#1.webpack-开发环境配置\"></a></h2>\n<h3 id=\"1.1-基本配置\">1.1 基本配置<a title=\"#1.1-基本配置\" href=\"#1.1-基本配置\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> &#123; resolve &#125; = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 入口起点</span></span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/js/index.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"comment\">// 输出</span></span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;bulit.js&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;build&#x27;</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// loader配置</span></span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      <span class=\"comment\">// 详细loader配置</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// plugins插件的配置</span></span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\"></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span>,</span><br><span class=\"line\">  <span class=\"comment\">// mode: &#x27;production&#x27;,</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1.2-loader的配置\">1.2 loader的配置<a title=\"#1.2-loader的配置\" href=\"#1.2-loader的配置\"></a></h3>\n<h4 id=\"1.2.1-css\">1.2.1 css<a title=\"#1.2.1-css\" href=\"#1.2.1-css\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 配置css</span></span><br><span class=\"line\">     &#123;</span><br><span class=\"line\">       <span class=\"comment\">// 匹配了哪些文件</span></span><br><span class=\"line\">       <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">       <span class=\"comment\">// 使用了哪些loader进行处理</span></span><br><span class=\"line\">       <span class=\"attr\">use</span>: [</span><br><span class=\"line\">         <span class=\"comment\">// use数组中 loader的执行顺序:从右到左  从下到上</span></span><br><span class=\"line\">         <span class=\"comment\">// 创建 style 标签，将js中的样式资源插入到head中</span></span><br><span class=\"line\">         <span class=\"string\">&#x27;style-loader&#x27;</span>,</span><br><span class=\"line\">         <span class=\"comment\">// 将css文件变化 commonjs 模块加载到js中 里面的内容样式是字符串</span></span><br><span class=\"line\">         <span class=\"string\">&#x27;css-loader&#x27;</span></span><br><span class=\"line\">       ]</span><br><span class=\"line\">     &#125;,</span><br></pre></td></tr></table></figure>\n<h4 id=\"1.2.2-less\">1.2.2 less<a title=\"#1.2.2-less\" href=\"#1.2.2-less\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//配置less 要加上上面配置的css</span></span><br><span class=\"line\">     &#123;</span><br><span class=\"line\">       <span class=\"attr\">test</span>: <span class=\"regexp\">/.\\less$/</span>,</span><br><span class=\"line\">       <span class=\"comment\">// 最后一个 将less 编译成css 文件 </span></span><br><span class=\"line\">       <span class=\"comment\">// 需要下载 less-loader less</span></span><br><span class=\"line\">       <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;less-loader&#x27;</span>]</span><br><span class=\"line\">     &#125;,</span><br></pre></td></tr></table></figure>\n<h4 id=\"1.2.3-图片\">1.2.3 图片<a title=\"#1.2.3-图片\" href=\"#1.2.3-图片\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//配置图片资源  默认处理不了 html 中的img</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(jpg|png|gif|jpeg)$/</span>,</span><br><span class=\"line\">          <span class=\"comment\">// 使用一个loader时 可以直接用下面这种方法</span></span><br><span class=\"line\">          <span class=\"comment\">// 下载 url-loader file-loader-&gt; 不用下载</span></span><br><span class=\"line\">          <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;url-loader&#x27;</span>,</span><br><span class=\"line\">          <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">publicPath</span>: <span class=\"string\">&#x27;./img&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">outputPath</span>: <span class=\"string\">&#x27;img&#x27;</span>,</span><br><span class=\"line\">            <span class=\"comment\">// 图片大小小于 8kb 就会被base64 处理</span></span><br><span class=\"line\">            <span class=\"comment\">// 优点：减少请求数量  减轻服务器压力</span></span><br><span class=\"line\">            <span class=\"comment\">// 缺点：图片体积会更大 文件请求速度更慢</span></span><br><span class=\"line\">            <span class=\"attr\">limit</span>: <span class=\"number\">8</span> * <span class=\"number\">1024</span>,</span><br><span class=\"line\">            <span class=\"comment\">// fallback: resolve(&#x27;file-roader&#x27;),</span></span><br><span class=\"line\">            <span class=\"comment\">// 对图片进行重命名</span></span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;img/[name][hash:10].[ext]&#x27;</span>,</span><br><span class=\"line\">            <span class=\"comment\">// 因为url-loader 默认 es6 模块化解析 而html-loader引入图片是commonjs</span></span><br><span class=\"line\">            <span class=\"comment\">// 解析时 会出现 [object Module]</span></span><br><span class=\"line\">            <span class=\"comment\">// 关闭 url-loader 的es6 模块化 使用 commonjs</span></span><br><span class=\"line\">            <span class=\"attr\">esModule</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">        <span class=\"comment\">//或者</span></span><br><span class=\"line\">        <span class=\"comment\">// use: &#123;</span></span><br><span class=\"line\">        <span class=\"comment\">//   loader: &#x27;url-loader&#x27;,</span></span><br><span class=\"line\">        <span class=\"comment\">//   options: &#123;</span></span><br><span class=\"line\">        <span class=\"comment\">//     publicPath: &#x27;./img&#x27;,</span></span><br><span class=\"line\">        <span class=\"comment\">//     outputPath: &#x27;img/&#x27;,</span></span><br><span class=\"line\">        <span class=\"comment\">//     limit: 8192,</span></span><br><span class=\"line\">        <span class=\"comment\">//     esModule: false</span></span><br><span class=\"line\">        <span class=\"comment\">//   &#125;</span></span><br><span class=\"line\">        <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;javascript/auto&#x27;</span>,   <span class=\"comment\">//必要</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"1.2.4-html中的图片\">1.2.4 html中的图片<a title=\"#1.2.4-html中的图片\" href=\"#1.2.4-html中的图片\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//在上面图片配置的基础上</span></span><br><span class=\"line\"> <span class=\"comment\">//处理 html 的img</span></span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.html$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// 引入 img 从而被 url-loader处理</span></span><br><span class=\"line\">        <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;html-loader&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">esModule</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"1.2.5-html\">1.2.5 html<a title=\"#1.2.5-html\" href=\"#1.2.5-html\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//plugins : 下载 -&gt; 导入 -&gt; 使用</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">// plugins插件的配置</span></span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"comment\">// html-webpack-plugin</span></span><br><span class=\"line\">    <span class=\"comment\">// if 直接 new...() 会创建一个空的html 自动引入打包输出的所有资源</span></span><br><span class=\"line\">    <span class=\"comment\">// if new...(&#123; template:&#x27;url&#x27;&#125;) 会有路径中的文件的结果</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">template</span>: <span class=\"string\">&#x27;./src/index.html&#x27;</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ],</span><br></pre></td></tr></table></figure>\n<h4 id=\"1.2.6-热部署\">1.2.6 热部署<a title=\"#1.2.6-热部署\" href=\"#1.2.6-热部署\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 最新 webpack-cil 于这个不匹配</span></span><br><span class=\"line\"><span class=\"comment\">// 开发服务器 devServer 用来自动化 自动编译 打开浏览器 刷新</span></span><br><span class=\"line\"><span class=\"comment\">// 特点 只会在内存中编译打包 不会有任何输出</span></span><br><span class=\"line\"><span class=\"comment\">// 启动 npx webpack-dev-server  </span></span><br><span class=\"line\"><span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 项目构建后目录</span></span><br><span class=\"line\">  <span class=\"attr\">contentBase</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;build&#x27;</span>),</span><br><span class=\"line\">  <span class=\"comment\">// 启动gzip压缩</span></span><br><span class=\"line\">  <span class=\"attr\">compress</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"comment\">// 端口号</span></span><br><span class=\"line\">  <span class=\"attr\">port</span>: <span class=\"number\">3000</span>,</span><br><span class=\"line\">  <span class=\"comment\">// 自动打开浏览器</span></span><br><span class=\"line\">  <span class=\"attr\">open</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"2.webpack-开发环境依赖\">2.webpack 开发环境依赖<a title=\"#2.webpack-开发环境依赖\" href=\"#2.webpack-开发环境依赖\"></a></h2>\n<h3 id=\"2.1-提取css-成单独文件\">2.1 提取css 成单独文件<a title=\"#2.1-提取css-成单独文件\" href=\"#2.1-提取css-成单独文件\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> &#123; resolve &#125; = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>); </span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;html-webpack-plugin&#x27;</span>); </span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">MiniCssExtractPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;mini-css-extract-plugin&#x27;</span>); </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123; </span><br><span class=\"line\">    <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/js/index.js&#x27;</span>, </span><br><span class=\"line\">    <span class=\"attr\">output</span>: &#123; </span><br><span class=\"line\">        <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;js/built.js&#x27;</span>, </span><br><span class=\"line\">        <span class=\"attr\">path</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;build&#x27;</span>) </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123; </span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [ &#123; </span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>, </span><br><span class=\"line\">            <span class=\"attr\">use</span>: [ </span><br><span class=\"line\">                <span class=\"comment\">// 创建 style 标签，将样式放入 </span></span><br><span class=\"line\">                <span class=\"comment\">// &#x27;style-loader&#x27;, </span></span><br><span class=\"line\">                <span class=\"comment\">// 这个 loader 取代 style-loader。作用：提取js中的css成单独文件 MiniCssExtractPlugin.loader, </span></span><br><span class=\"line\">                <span class=\"comment\">// 将 css 文件整合到 js 文件中 </span></span><br><span class=\"line\">                <span class=\"string\">&#x27;css-loader&#x27;</span> ] </span><br><span class=\"line\">        &#125; ] </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [ </span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123; </span><br><span class=\"line\">            <span class=\"attr\">template</span>: <span class=\"string\">&#x27;./src/index.html&#x27;</span> </span><br><span class=\"line\">        &#125;), </span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123; </span><br><span class=\"line\">            <span class=\"comment\">// 对输出的 css 文件进行重命名 </span></span><br><span class=\"line\">            <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;css/built.css&#x27;</span> </span><br><span class=\"line\">        &#125;) </span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span> </span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2.2-css兼容\">2.2 css兼容<a title=\"#2.2-css兼容\" href=\"#2.2-css兼容\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//webpack.config.js</span></span><br><span class=\"line\">&#123; </span><br><span class=\"line\">    <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>, </span><br><span class=\"line\">        <span class=\"attr\">use</span>: [ </span><br><span class=\"line\">            <span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, </span><br><span class=\"line\">            <span class=\"string\">&#x27;css-loader&#x27;</span>, </span><br><span class=\"line\">            &#123; </span><br><span class=\"line\">                <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;postcss-loader&#x27;</span>, </span><br><span class=\"line\">                <span class=\"attr\">options</span>: &#123; </span><br><span class=\"line\">                    <span class=\"attr\">ident</span>: <span class=\"string\">&#x27;postcss&#x27;</span>, </span><br><span class=\"line\">                    <span class=\"attr\">plugins</span>: <span class=\"function\">() =&gt;</span> [ </span><br><span class=\"line\">                        <span class=\"comment\">// postcss 的插件 </span></span><br><span class=\"line\">                        <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;postcss-preset-env&#x27;</span>)() </span><br><span class=\"line\">                    ] </span><br><span class=\"line\">                &#125; </span><br><span class=\"line\">            &#125; </span><br><span class=\"line\">        ]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">plugins</span>: [ </span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123; <span class=\"attr\">template</span>: <span class=\"string\">&#x27;./src/index.html&#x27;</span> &#125;), </span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123; </span><br><span class=\"line\">        <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;css/built.css&#x27;</span> </span><br><span class=\"line\">    &#125;) </span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//package.js</span></span><br><span class=\"line\"><span class=\"string\">&quot;browserslist&quot;</span>: &#123; </span><br><span class=\"line\">    <span class=\"string\">&quot;development&quot;</span>: [ </span><br><span class=\"line\">        <span class=\"string\">&quot;last 1 chrome version&quot;</span>, </span><br><span class=\"line\">        <span class=\"string\">&quot;last 1 firefox version&quot;</span>, </span><br><span class=\"line\">        <span class=\"string\">&quot;last 1 safari version&quot;</span> </span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">&quot;production&quot;</span>: [ </span><br><span class=\"line\">        <span class=\"string\">&quot;&gt;0.2%&quot;</span>, </span><br><span class=\"line\">        <span class=\"string\">&quot;not dead&quot;</span>, </span><br><span class=\"line\">        <span class=\"string\">&quot;not op_mini all&quot;</span> </span><br><span class=\"line\">    ] </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2.3-css压缩\">2.3 css压缩<a title=\"#2.3-css压缩\" href=\"#2.3-css压缩\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    ... <span class=\"comment\">//同上</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">OptimizeCssAssetsWebpackPlugin</span>() </span><br><span class=\"line\">],</span><br></pre></td></tr></table></figure>\n<h3 id=\"2.4-js语法检查-eslint\">2.4 js语法检查 eslint<a title=\"#2.4-js语法检查-eslint\" href=\"#2.4-js语法检查-eslint\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">rules</span>: [ </span><br><span class=\"line\">    <span class=\"comment\">/*语法检查： eslint-loader eslint </span></span><br><span class=\"line\"><span class=\"comment\">    注意：只检查自己写的源代码，第三方的库是不用检查的 </span></span><br><span class=\"line\"><span class=\"comment\">    设置检查规则： package.json 中 eslintConfig 中设置~ </span></span><br><span class=\"line\"><span class=\"comment\">    &quot;eslintConfig&quot;: &#123; &quot;extends&quot;: &quot;airbnb-base&quot; &#125; </span></span><br><span class=\"line\"><span class=\"comment\">    airbnb --&gt; eslint-config-airbnb-base eslint-plugin-import eslint </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    &#123; </span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>, </span><br><span class=\"line\">        <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, </span><br><span class=\"line\">        <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;eslint-loader&#x27;</span>, </span><br><span class=\"line\">        <span class=\"attr\">options</span>: &#123; </span><br><span class=\"line\">            <span class=\"comment\">// 自动修复 eslint 的错误 </span></span><br><span class=\"line\">            <span class=\"attr\">fix</span>: <span class=\"literal\">true</span> </span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//package.json</span></span><br><span class=\"line\"><span class=\"string\">&quot;eslintConfig&quot;</span>: &#123; </span><br><span class=\"line\">    <span class=\"string\">&quot;extends&quot;</span>: <span class=\"string\">&quot;airbnb-base&quot;</span>,</span><br><span class=\"line\">     <span class=\"string\">&quot;env&quot;</span>: &#123; </span><br><span class=\"line\">         <span class=\"string\">&quot;browser&quot;</span>: <span class=\"literal\">true</span> </span><br><span class=\"line\">     &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2.5-js兼容\">2.5 js兼容<a title=\"#2.5-js兼容\" href=\"#2.5-js兼容\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">rules</span>: [ </span><br><span class=\"line\">    &#123; </span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>, </span><br><span class=\"line\">        <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, </span><br><span class=\"line\">        <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;babel-loader&#x27;</span>, </span><br><span class=\"line\">        <span class=\"attr\">options</span>: &#123; </span><br><span class=\"line\">            <span class=\"comment\">// 预设：指示 babel 做怎么样的兼容性处理 </span></span><br><span class=\"line\">            <span class=\"attr\">presets</span>: [ </span><br><span class=\"line\">                [ <span class=\"string\">&#x27;@babel/preset-env&#x27;</span>, </span><br><span class=\"line\">                 &#123; </span><br><span class=\"line\">                     <span class=\"comment\">// 按需加载 </span></span><br><span class=\"line\">                     <span class=\"attr\">useBuiltIns</span>: <span class=\"string\">&#x27;usage&#x27;</span>, </span><br><span class=\"line\">                     <span class=\"comment\">// 指定 core-js 版本 </span></span><br><span class=\"line\">                     <span class=\"attr\">corejs</span>: &#123; <span class=\"attr\">version</span>: <span class=\"number\">3</span> &#125;,</span><br><span class=\"line\">                     <span class=\"comment\">// 指定兼容性做到哪个版本浏览器 </span></span><br><span class=\"line\">                     <span class=\"attr\">targets</span>: &#123; <span class=\"attr\">chrome</span>: <span class=\"string\">&#x27;60&#x27;</span>, <span class=\"attr\">firefox</span>: <span class=\"string\">&#x27;60&#x27;</span>, <span class=\"attr\">ie</span>: <span class=\"string\">&#x27;9&#x27;</span>, <span class=\"attr\">safari</span>: <span class=\"string\">&#x27;10&#x27;</span>, <span class=\"attr\">edge</span>: <span class=\"string\">&#x27;17&#x27;</span> &#125; </span><br><span class=\"line\">                 &#125; </span><br><span class=\"line\">                ] </span><br><span class=\"line\">            ] </span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<h3 id=\"2.6-js压缩\">2.6 js压缩<a title=\"#2.6-js压缩\" href=\"#2.6-js压缩\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 生产环境下会自动压缩 js 代码 </span></span><br><span class=\"line\"><span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2.7-html压缩\">2.7 html压缩<a title=\"#2.7-html压缩\" href=\"#2.7-html压缩\"></a></h3>\n<p>webpack5也能压缩html</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins</span>: [ </span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123; </span><br><span class=\"line\">        <span class=\"attr\">template</span>: <span class=\"string\">&#x27;./src/index.html&#x27;</span>, </span><br><span class=\"line\">        <span class=\"comment\">// 压缩 html 代码 </span></span><br><span class=\"line\">        <span class=\"attr\">minify</span>: &#123; </span><br><span class=\"line\">            <span class=\"comment\">// 移除空格 </span></span><br><span class=\"line\">            <span class=\"attr\">collapseWhitespace</span>: <span class=\"literal\">true</span>, </span><br><span class=\"line\">            <span class=\"comment\">// 移除注释 </span></span><br><span class=\"line\">            <span class=\"attr\">removeComments</span>: <span class=\"literal\">true</span> </span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125;) </span><br><span class=\"line\">],</span><br><span class=\"line\"><span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"3.-webpack优化配置\">3. webpack优化配置<a title=\"#3.-webpack优化配置\" href=\"#3.-webpack优化配置\"></a></h2>\n<h3 id=\"3.1-hmr\">3.1 HMR<a title=\"#3.1-hmr\" href=\"#3.1-hmr\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span>, </span><br><span class=\"line\"><span class=\"attr\">devServer</span>: &#123; </span><br><span class=\"line\">    <span class=\"attr\">contentBase</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;build&#x27;</span>), </span><br><span class=\"line\">    <span class=\"attr\">compress</span>: <span class=\"literal\">true</span>, </span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"number\">3000</span>, </span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span>, </span><br><span class=\"line\">    <span class=\"comment\">// 开启 HMR 功能 </span></span><br><span class=\"line\">    <span class=\"comment\">// 当修改了 webpack 配置，新配置要想生效，必须重新 webpack 服务 </span></span><br><span class=\"line\">        <span class=\"attr\">hot</span>: <span class=\"literal\">true</span> </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.2-source-map\">3.2 <strong>source-map</strong><a title=\"#3.2-source-map\" href=\"#3.2-source-map\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">devtool</span>: <span class=\"string\">&#x27;eval-source-map&#x27;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"3.3-oneof\">3.3 OneOf<a title=\"#3.3-oneof\" href=\"#3.3-oneof\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以下 loader 只会匹配一个 // 注意：不能有两个配置处理同一种类型文件 </span></span><br><span class=\"line\"><span class=\"attr\">oneOf</span>: [</span><br><span class=\"line\">    ..处理css less img js...</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.4-缓存\">3.4 缓存<a title=\"#3.4-缓存\" href=\"#3.4-缓存\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">正常来讲，一个文件只能被一个 loader 处理。 </span></span><br><span class=\"line\"><span class=\"comment\">当一个文件要被多个 loader 处理，那么一定要指定 loader 执行的先后顺序： </span></span><br><span class=\"line\"><span class=\"comment\">先执行 eslint 在执行 babel </span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#123; </span><br><span class=\"line\">       <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>, </span><br><span class=\"line\">       <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, </span><br><span class=\"line\">       <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;babel-loader&#x27;</span>, </span><br><span class=\"line\">       <span class=\"attr\">options</span>: &#123; </span><br><span class=\"line\">           <span class=\"comment\">// 预设：指示 babel 做怎么样的兼容性处理 </span></span><br><span class=\"line\">           <span class=\"attr\">presets</span>: [ </span><br><span class=\"line\">               [ <span class=\"string\">&#x27;@babel/preset-env&#x27;</span>, </span><br><span class=\"line\">                &#123; </span><br><span class=\"line\">                    <span class=\"comment\">// 按需加载 </span></span><br><span class=\"line\">                    <span class=\"attr\">useBuiltIns</span>: <span class=\"string\">&#x27;usage&#x27;</span>, </span><br><span class=\"line\">                    <span class=\"comment\">// 指定 core-js 版本 </span></span><br><span class=\"line\">                    <span class=\"attr\">corejs</span>: &#123; <span class=\"attr\">version</span>: <span class=\"number\">3</span> &#125;,</span><br><span class=\"line\">                    <span class=\"comment\">// 指定兼容性做到哪个版本浏览器 </span></span><br><span class=\"line\">                    <span class=\"attr\">targets</span>: &#123; <span class=\"attr\">chrome</span>: <span class=\"string\">&#x27;60&#x27;</span>, <span class=\"attr\">firefox</span>: <span class=\"string\">&#x27;60&#x27;</span> &#125; </span><br><span class=\"line\">                &#125; </span><br><span class=\"line\">               ] </span><br><span class=\"line\">           ],</span><br><span class=\"line\">           <span class=\"comment\">// 开启 babel 缓存 </span></span><br><span class=\"line\">           <span class=\"comment\">// 第二次构建时，会读取之前的缓存 </span></span><br><span class=\"line\">           <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">       &#125; </span><br><span class=\"line\">   &#125; </span><br></pre></td></tr></table></figure>\n<h3 id=\"3.5-tree-shaking-树摇\">3.5 tree shaking 树摇<a title=\"#3.5-tree-shaking-树摇\" href=\"#3.5-tree-shaking-树摇\"></a></h3>\n<p>前提：必须使用 es6 模块化   开启 production 环境</p>\n<p>作用：减少代码体积</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//package.json</span></span><br><span class=\"line\"><span class=\"comment\">//所有代码都没有副作用 都可以进行树摇</span></span><br><span class=\"line\"><span class=\"comment\">//问题：可能会把 css/ @babel/polyfill 文件干掉</span></span><br><span class=\"line\"><span class=\"attr\">&quot;sideEffects&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">false</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"comment\">//对数组里的文件会忽略该操作</span></span><br><span class=\"line\"><span class=\"attr\">&quot;sideEffects&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">[</span><span class=\"string\">&quot;*.css&quot;</span><span class=\"punctuation\">,</span><span class=\"string\">&quot;*.less&quot;</span><span class=\"punctuation\">]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"3.6-code-spilt-代码分割\">3.6 code spilt 代码分割<a title=\"#3.6-code-spilt-代码分割\" href=\"#3.6-code-spilt-代码分割\"></a></h3>\n<ol>\n<li>\n<p>利用多入口  打包成多个js文件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">entry</span>:&#123;</span><br><span class=\"line\">   <span class=\"attr\">index</span>: ’./src/js/index.<span class=\"property\">js</span>’,</span><br><span class=\"line\">   <span class=\"attr\">test</span>: ’./src/js/test.<span class=\"property\">js</span>’</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>单/多入口 与 optimization 配合</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">entry</span>: ‘./src/index.<span class=\"property\">js</span>’,</span><br><span class=\"line\"><span class=\"comment\">// 或者 多入口</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//1. 可以将node_modules中代码单独打包一个chunk最终输出</span></span><br><span class=\"line\"><span class=\"comment\">//2. 自动分析多入口chunk中，有无公共文件 if有 就会打包成单独一个chunk</span></span><br><span class=\"line\"><span class=\"attr\">optimization</span>:&#123;</span><br><span class=\"line\">\t<span class=\"attr\">splitChunks</span>:&#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">chunk</span>: ’all’</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>在单入口 与 optimization 配合 页面的 js 文件里面使用 import</p>\n<p>通过js代码，让某某个文件被单独打包成一个chunk</p>\n<p>import 动态导入语法：能将某个文件单独打包</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  /* webpackChunkName: &#x27;test&#x27; */ webpack.config.js 中 的[name] == test</span></span><br><span class=\"line\"><span class=\"title function_\">import</span>(<span class=\"comment\">/* webpackChunkName: &#x27;test&#x27; */</span><span class=\"string\">&#x27;./test&#x27;</span>).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">&#123;mul,count&#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//文件加载成功</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//文件加载失败</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"3.7-lazy-loading\">3.7 <strong>lazy loading</strong><a title=\"#3.7-lazy-loading\" href=\"#3.7-lazy-loading\"></a></h3>\n<p>懒加载：文件需要使用是才加载</p>\n<p>预加载 prefetch：使用之前 提前记载js文件  等其他资源加载完毕 浏览器空闲了 再偷偷加载</p>\n<p>eg</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">btn.<span class=\"property\">onclick</span> = <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"comment\">//懒加载</span></span><br><span class=\"line\">    <span class=\"title function_\">import</span>(<span class=\"comment\">/* webpackChunkName: &#x27;test&#x27; */</span><span class=\"string\">&#x27;./test&#x27;</span>).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">&#123;mul,count&#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    \t<span class=\"comment\">//文件加载成功</span></span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">    <span class=\"comment\">//预加载</span></span><br><span class=\"line\">    <span class=\"title function_\">import</span>(<span class=\"comment\">/* webpackChunkName: &#x27;test&#x27; , webpackPrefetch: true */</span><span class=\"string\">&#x27;./test&#x27;</span>).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">&#123;mul,count&#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    \t<span class=\"comment\">//文件加载成功</span></span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.8-pwa\">3.8 pwa<a title=\"#3.8-pwa\" href=\"#3.8-pwa\"></a></h3>\n<p>现在好像已经被淘汰了</p>\n<p>pwa 渐进式网络开发应用程序  离线可访问</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">WorkboxWebpackPlugin</span>.<span class=\"property\">GenerateSW</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//1.帮助serviceworker快速启动</span></span><br><span class=\"line\">    <span class=\"comment\">//2.删除旧的 serviceworker</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//生成一个serviceworker 配置文件</span></span><br><span class=\"line\">    <span class=\"attr\">clicentsClaim</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">skipWaiting</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"comment\">//注册 serviceWorker</span></span><br><span class=\"line\"><span class=\"comment\">//处理兼容性问题</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"string\">&#x27;serviceWorke&#x27;</span> <span class=\"keyword\">in</span> navigator)&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">window</span>.<span class=\"title function_\">onload</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        navigator.<span class=\"property\">serviceWorker</span></span><br><span class=\"line\">        .<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;/service-worker.js&#x27;</span>)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"title function_\">log</span>(<span class=\"string\">&#x27;成功&#x27;</span>)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"title function_\">log</span>(<span class=\"string\">&#x27;失败&#x27;</span>)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//因为eslint不认识 window navigator全局变量</span></span><br><span class=\"line\"><span class=\"comment\">//解决 需要修改 package.json eslintConfig 配置</span></span><br><span class=\"line\"><span class=\"string\">&quot;env&quot;</span>:&#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;browser&quot;</span>:<span class=\"literal\">true</span> <span class=\"comment\">//支持浏览器端全局变量</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>sw 必须运行在服务器上</p>\n<ul>\n<li>\n<p>nodejs</p>\n</li>\n<li>\n<p>npm i serve -g</p>\n<p>serve -s build 启动服务器 将build目录的所有资源 作为静态资源暴露出去</p>\n</li>\n</ul>\n<h3 id=\"3.9-多进程打包\">3.9 多进程打包<a title=\"#3.9-多进程打包\" href=\"#3.9-多进程打包\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123; </span><br><span class=\"line\">    <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>, </span><br><span class=\"line\">    <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, </span><br><span class=\"line\">    <span class=\"attr\">use</span>: [&#123;</span><br><span class=\"line\">        <span class=\"comment\">/*开启多进程打包。 </span></span><br><span class=\"line\"><span class=\"comment\">        进程启动大概为 600ms，进程通信也有开销。 </span></span><br><span class=\"line\"><span class=\"comment\">        只有工作消耗时间比较长，才需要多进程打包 */</span> </span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;thread-loader&#x27;</span>, </span><br><span class=\"line\">            <span class=\"attr\">options</span>: &#123; </span><br><span class=\"line\">                <span class=\"attr\">workers</span>: <span class=\"number\">2</span> <span class=\"comment\">// 进程 2 个 </span></span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">        &#125;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.10-externals\">3.10 <strong>externals</strong><a title=\"#3.10-externals\" href=\"#3.10-externals\"></a></h3>\n<p>不打包 jquery 然后 在html 手动引入cdn</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span>, </span><br><span class=\"line\"><span class=\"attr\">externals</span>: &#123; </span><br><span class=\"line\">    <span class=\"comment\">// 拒绝 jQuery 被打包进来 </span></span><br><span class=\"line\">    <span class=\"attr\">jquery</span>: <span class=\"string\">&#x27;jQuery&#x27;</span> </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.11-dll\">3.11 dll<a title=\"#3.11-dll\" href=\"#3.11-dll\"></a></h3>\n<p>使用dll 对某些 第三方库 进行单独打包</p>\n<ul>\n<li>运行webpack 时 默认查找webpack.config.js</li>\n<li>所以运行 改文件应 <code>webpack --config webpack.dll.js</code></li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.dll.js</span></span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"keyword\">const</span> webpack = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;webpack&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">entry</span>:&#123;</span><br><span class=\"line\">    <span class=\"comment\">//最终打包生成的[name] = jquery</span></span><br><span class=\"line\">    <span class=\"comment\">//[&#x27;jquery&#x27;] = 要打包的库</span></span><br><span class=\"line\">    <span class=\"attr\">jquery</span>:[<span class=\"string\">&#x27;jquery&#x27;</span>]</span><br><span class=\"line\">&#125;，</span><br><span class=\"line\"><span class=\"attr\">output</span>:&#123;</span><br><span class=\"line\">    <span class=\"attr\">filename</span>:<span class=\"string\">&#x27;[name].js&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">path</span>:<span class=\"title function_\">resolve</span>(__dirname,<span class=\"string\">&#x27;dll&#x27;</span>),  <span class=\"comment\">//打包后的位置</span></span><br><span class=\"line\">    <span class=\"attr\">library</span>:<span class=\"string\">&#x27;[name]_[hash]&#x27;</span>  <span class=\"comment\">//打包的库里面向外暴露出去的内容的名字</span></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"><span class=\"attr\">plugins</span>:[</span><br><span class=\"line\">    <span class=\"comment\">// 告诉webpack 不用再打包了</span></span><br><span class=\"line\">    <span class=\"comment\">//打包生成一个manifest.js  提供和jq 的映射</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> webpack.<span class=\"title class_\">DllPlugin</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">name</span>:<span class=\"string\">&#x27;[name]_[hash]&#x27;</span>,  <span class=\"comment\">//映射库的暴露内容名称</span></span><br><span class=\"line\">        <span class=\"attr\">path</span>:<span class=\"title function_\">resolve</span>(__dirname,<span class=\"string\">&#x27;dll/nanifest.json&#x27;</span>)  <span class=\"comment\">//输出文件路径</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>之后再运行webpack 就不会再重复打包jq了</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//webpack.config.js</span></span><br><span class=\"line\"><span class=\"attr\">plugins</span>: [ </span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123; <span class=\"attr\">template</span>: <span class=\"string\">&#x27;./src/index.html&#x27;</span> &#125;), </span><br><span class=\"line\">    <span class=\"comment\">// 告诉 webpack 哪些库不参与打包，同时使用时的名称也得变~ </span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> webpack.<span class=\"title class_\">DllReferencePlugin</span>(&#123; </span><br><span class=\"line\">        <span class=\"attr\">manifest</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;dll/manifest.json&#x27;</span>) </span><br><span class=\"line\">    &#125;), </span><br><span class=\"line\">    <span class=\"comment\">// 将某个文件打包输出去，并在 html 中自动引入该资源 </span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">AddAssetHtmlWebpackPlugin</span>(&#123; </span><br><span class=\"line\">        <span class=\"attr\">filepath</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;dll/jquery.js&#x27;</span>) </span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.12-优化总结\">3.12 优化总结<a title=\"#3.12-优化总结\" href=\"#3.12-优化总结\"></a></h3>\n<ol>\n<li>\n<p>开发环境性能优化</p>\n<ul>\n<li>\n<p>优化打包构建速度</p>\n<p>HMR</p>\n</li>\n<li>\n<p>优化代码调试</p>\n<p>source-map</p>\n</li>\n</ul>\n</li>\n<li>\n<p>生成环境性能优化</p>\n<ul>\n<li>\n<p>优化打包构建速度</p>\n<p>OneOf</p>\n<p>babel缓存</p>\n<p>多进程打包</p>\n<p>externals</p>\n<p>dll</p>\n</li>\n<li>\n<p>优化代码运行的性能</p>\n<p>缓存(hash–chunkhash–contenthash)</p>\n<p>tree shaking</p>\n<p>code split</p>\n<p>懒加载/预加载</p>\n<p>pwa</p>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"4.-webpack-配置详情\">4. webpack 配置详情<a title=\"#4.-webpack-配置详情\" href=\"#4.-webpack-配置详情\"></a></h2>\n<h3 id=\"4.1-entry\">4.1 entry<a title=\"#4.1-entry\" href=\"#4.1-entry\"></a></h3>\n<p>入口起点</p>\n<ol>\n<li>\n<p>String  -&gt; ‘./src/index.js’</p>\n<p>单入口  打包形成一个chunk 输出一个 bundle 文件</p>\n<p>chunk 名称默认是 main</p>\n</li>\n<li>\n<p>array  –&gt; [‘./src/index.js’, ‘./src/add.js’]</p>\n<p>多入口  所有入口文件形成一个chunk 输出一个 bundle 文件</p>\n</li>\n<li>\n<p>object  -&gt; { index : ‘./src/index.js’, add:  ‘./src/add.js’ }</p>\n<p>多入口 几个入口就几个chunk 输出几个bundle</p>\n<p>chunk 名称为 key值</p>\n</li>\n<li>\n<p>特殊用法</p>\n<p>{</p>\n<p>​\t index :[‘./src/index.js’, ‘./src/add.js’],    //一个chunk 一个bundle</p>\n<p>​\t add:  ‘./src/add.js’    //一个chunk 一个bundle</p>\n<p>}</p>\n</li>\n</ol>\n<h3 id=\"4.2-output\">4.2 output<a title=\"#4.2-output\" href=\"#4.2-output\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">output</span>: &#123; </span><br><span class=\"line\">    <span class=\"comment\">// 文件名称（指定名称+目录） </span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;js/[name].js&#x27;</span>, </span><br><span class=\"line\">    <span class=\"comment\">// 输出文件目录（将来所有资源输出的公共目录） </span></span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;build&#x27;</span>), </span><br><span class=\"line\">    <span class=\"comment\">// 所有资源引入公共路径前缀 --&gt; &#x27;imgs/a.jpg&#x27; --&gt; &#x27;/imgs/a.jpg&#x27; </span></span><br><span class=\"line\">    <span class=\"attr\">publicPath</span>: <span class=\"string\">&#x27;/&#x27;</span>, </span><br><span class=\"line\">    <span class=\"attr\">chunkFilename</span>: <span class=\"string\">&#x27;js/[name]_chunk.js&#x27;</span>, <span class=\"comment\">// 非入口 chunk 的名称 </span></span><br><span class=\"line\">    <span class=\"comment\">// library: &#x27;[name]&#x27;, // 整个库向外暴露的变量名 </span></span><br><span class=\"line\">    <span class=\"comment\">// libraryTarget: &#x27;window&#x27; // 变量名添加到哪个上 browser </span></span><br><span class=\"line\">    <span class=\"comment\">// libraryTarget: &#x27;global&#x27; // 变量名添加到哪个上 node </span></span><br><span class=\"line\">    <span class=\"comment\">// libraryTarget: &#x27;commonjs&#x27; </span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"4.3-module\">4.3 module<a title=\"#4.3-module\" href=\"#4.3-module\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">module</span>: &#123; </span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [ </span><br><span class=\"line\">    <span class=\"comment\">// loader 的配置 </span></span><br><span class=\"line\">        &#123; </span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>, </span><br><span class=\"line\">            <span class=\"comment\">// 多个 loader 用 use</span></span><br><span class=\"line\">            <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>] </span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123; </span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>, </span><br><span class=\"line\">            <span class=\"comment\">// 排除 node_modules 下的 js 文件 </span></span><br><span class=\"line\">            <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, </span><br><span class=\"line\">            <span class=\"comment\">// 只检查 src 下的 js 文件 </span></span><br><span class=\"line\">            <span class=\"attr\">include</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;src&#x27;</span>), </span><br><span class=\"line\">            <span class=\"comment\">// 优先执行 enforce: &#x27;pre&#x27;, </span></span><br><span class=\"line\">            <span class=\"comment\">// 延后执行 // enforce: &#x27;post&#x27;, </span></span><br><span class=\"line\">            <span class=\"comment\">// 单个 loader 用 loader </span></span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;eslint-loader&#x27;</span>, </span><br><span class=\"line\">            <span class=\"attr\">options</span>: &#123;&#125; </span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123; </span><br><span class=\"line\">            <span class=\"comment\">// 以下配置只会生效一个 </span></span><br><span class=\"line\">            <span class=\"attr\">oneOf</span>: [] </span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    ] </span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<h3 id=\"4.4-resolve\">4.4 resolve<a title=\"#4.4-resolve\" href=\"#4.4-resolve\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">resolve</span>: &#123; </span><br><span class=\"line\">    <span class=\"comment\">// 配置解析模块路径别名: 优点简写路径 缺点路径没有提示 </span></span><br><span class=\"line\">    <span class=\"attr\">alias</span>: &#123; </span><br><span class=\"line\">        <span class=\"attr\">$css</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;src/css&#x27;</span>) </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">     <span class=\"comment\">// 配置省略文件路径的后缀名 </span></span><br><span class=\"line\">     <span class=\"attr\">extensions</span>: [<span class=\"string\">&#x27;.js&#x27;</span>, <span class=\"string\">&#x27;.json&#x27;</span>, <span class=\"string\">&#x27;.jsx&#x27;</span>, <span class=\"string\">&#x27;.css&#x27;</span>], </span><br><span class=\"line\">     <span class=\"comment\">// 告诉 webpack 解析模块是去找哪个目录 </span></span><br><span class=\"line\">      <span class=\"attr\">modules</span>: [<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../../node_modules&#x27;</span>), <span class=\"string\">&#x27;node_modules&#x27;</span>] </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4.5-dev-server\">4.5 dev server<a title=\"#4.5-dev-server\" href=\"#4.5-dev-server\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">devServer</span>: &#123; </span><br><span class=\"line\">    <span class=\"comment\">// 运行代码的目录 </span></span><br><span class=\"line\">    <span class=\"attr\">contentBase</span>: <span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;build&#x27;</span>), </span><br><span class=\"line\">    <span class=\"comment\">// 监视 contentBase 目录下的所有文件，一旦文件变化就会 reload </span></span><br><span class=\"line\">    <span class=\"attr\">watchContentBase</span>: <span class=\"literal\">true</span>, </span><br><span class=\"line\">    <span class=\"attr\">watchOptions</span>: &#123; </span><br><span class=\"line\">        <span class=\"comment\">// 忽略文件 </span></span><br><span class=\"line\">        <span class=\"attr\">ignored</span>: <span class=\"regexp\">/node_modules/</span> </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">compress</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 启动 gzip 压缩  </span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"number\">5000</span>,     <span class=\"comment\">// 端口号</span></span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&#x27;localhost&#x27;</span>,     <span class=\"comment\">// 域名 </span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span>,     <span class=\"comment\">// 自动打开浏览器 </span></span><br><span class=\"line\">    <span class=\"attr\">hot</span>: <span class=\"literal\">true</span>,     <span class=\"comment\">// 开启 HMR 功能  </span></span><br><span class=\"line\">    <span class=\"attr\">clientLogLevel</span>: <span class=\"string\">&#x27;none&#x27;</span>,    <span class=\"comment\">// 不要显示启动服务器日志信息</span></span><br><span class=\"line\">    <span class=\"comment\">// 除了一些基本启动信息以外，其他内容都不要显示 </span></span><br><span class=\"line\">    <span class=\"attr\">quiet</span>: <span class=\"literal\">true</span>, </span><br><span class=\"line\">    <span class=\"attr\">overlay</span>: <span class=\"literal\">false</span>,<span class=\"comment\">// 如果出错了，不要全屏提示~</span></span><br><span class=\"line\">    <span class=\"comment\">// 服务器代理 --&gt; 解决开发环境跨域问题 </span></span><br><span class=\"line\">    <span class=\"attr\">proxy</span>: &#123; </span><br><span class=\"line\">        <span class=\"comment\">// 一旦 devServer(5000)服务器接受到 /api/xxx 的请求，就会把请求转发到另外一个服务器 (3000)</span></span><br><span class=\"line\">        <span class=\"string\">&#x27;/api&#x27;</span>: &#123; </span><br><span class=\"line\">            <span class=\"attr\">target</span>: <span class=\"string\">&#x27;http://localhost:3000&#x27;</span>, </span><br><span class=\"line\">            <span class=\"comment\">// 发送请求时，请求路径重写：将 /api/xxx --&gt; /xxx （去掉/api） </span></span><br><span class=\"line\">            <span class=\"attr\">pathRewrite</span>: &#123; <span class=\"string\">&#x27;^/api&#x27;</span>: <span class=\"string\">&#x27;&#x27;</span> &#125; </span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4.6-optimization\">4.6 <strong>optimization</strong><a title=\"#4.6-optimization\" href=\"#4.6-optimization\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">optimization</span>: &#123; </span><br><span class=\"line\">    <span class=\"attr\">splitChunks</span>: &#123; </span><br><span class=\"line\">        <span class=\"attr\">chunks</span>: <span class=\"string\">&#x27;all&#x27;</span> </span><br><span class=\"line\">        <span class=\"comment\">// 后面默认值，可以不写~ </span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 将当前模块的记录其他模块的 hash 单独打包为一个文件 runtime </span></span><br><span class=\"line\">    <span class=\"comment\">// 解决：修改 a 文件导致 b 文件的 contenthash 变化 </span></span><br><span class=\"line\">    <span class=\"attr\">runtimeChunk</span>: &#123; </span><br><span class=\"line\">        <span class=\"attr\">name</span>: <span class=\"function\"><span class=\"params\">entrypoint</span> =&gt;</span> <span class=\"string\">`runtime-<span class=\"subst\">$&#123;entrypoint.name&#125;</span>`</span> </span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">minimizer</span>: [ </span><br><span class=\"line\">        <span class=\"comment\">// 配置生产环境的压缩方案：js 和 css </span></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">TerserWebpackPlugin</span>(&#123; </span><br><span class=\"line\">            <span class=\"comment\">// 开启缓存 </span></span><br><span class=\"line\">            <span class=\"attr\">cache</span>: <span class=\"literal\">true</span>, </span><br><span class=\"line\">            <span class=\"comment\">// 开启多进程打包 </span></span><br><span class=\"line\">            <span class=\"attr\">parallel</span>: <span class=\"literal\">true</span>, </span><br><span class=\"line\">            <span class=\"comment\">// 启动 source-map </span></span><br><span class=\"line\">            <span class=\"attr\">sourceMap</span>: <span class=\"literal\">true</span> </span><br><span class=\"line\">        &#125;) </span><br><span class=\"line\">    ] </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","prev":{"title":"Hello World","link":"uncategorized/hello-world"},"next":{"title":"ajax 学习笔记","link":"learningNotes/ajax/ajax"},"plink":"https://shylees.github.io/learningNotes/webpack/webpack/","toc":[{"id":"webpack(from-9.13-15)","title":"webpack(from 9.13-15)","index":"1","children":[{"id":"0.-atguigu-视频-的第三方包的版本","title":"0. atguigu 视频 的第三方包的版本","index":"1.1"},{"id":"1.webpack-开发环境配置","title":"1.webpack 开发环境配置","index":"1.2","children":[{"id":"1.1-基本配置","title":"1.1 基本配置","index":"1.2.1"},{"id":"1.2-loader的配置","title":"1.2 loader的配置","index":"1.2.2"}]},{"id":"2.webpack-开发环境依赖","title":"2.webpack 开发环境依赖","index":"1.3","children":[{"id":"2.1-提取css-成单独文件","title":"2.1 提取css 成单独文件","index":"1.3.1"},{"id":"2.2-css兼容","title":"2.2 css兼容","index":"1.3.2"},{"id":"2.3-css压缩","title":"2.3 css压缩","index":"1.3.3"},{"id":"2.4-js语法检查-eslint","title":"2.4 js语法检查 eslint","index":"1.3.4"},{"id":"2.5-js兼容","title":"2.5 js兼容","index":"1.3.5"},{"id":"2.6-js压缩","title":"2.6 js压缩","index":"1.3.6"},{"id":"2.7-html压缩","title":"2.7 html压缩","index":"1.3.7"}]},{"id":"3.-webpack优化配置","title":"3. webpack优化配置","index":"1.4","children":[{"id":"3.1-hmr","title":"3.1 HMR","index":"1.4.1"},{"id":"3.2-source-map","title":"3.2 source-map","index":"1.4.2"},{"id":"3.3-oneof","title":"3.3 OneOf","index":"1.4.3"},{"id":"3.4-缓存","title":"3.4 缓存","index":"1.4.4"},{"id":"3.5-tree-shaking-树摇","title":"3.5 tree shaking 树摇","index":"1.4.5"},{"id":"3.6-code-spilt-代码分割","title":"3.6 code spilt 代码分割","index":"1.4.6"},{"id":"3.7-lazy-loading","title":"3.7 lazy loading","index":"1.4.7"},{"id":"3.8-pwa","title":"3.8 pwa","index":"1.4.8"},{"id":"3.9-多进程打包","title":"3.9 多进程打包","index":"1.4.9"},{"id":"3.10-externals","title":"3.10 externals","index":"1.4.10"},{"id":"3.11-dll","title":"3.11 dll","index":"1.4.11"},{"id":"3.12-优化总结","title":"3.12 优化总结","index":"1.4.12"}]},{"id":"4.-webpack-配置详情","title":"4. webpack 配置详情","index":"1.5","children":[{"id":"4.1-entry","title":"4.1 entry","index":"1.5.1"},{"id":"4.2-output","title":"4.2 output","index":"1.5.2"},{"id":"4.3-module","title":"4.3 module","index":"1.5.3"},{"id":"4.4-resolve","title":"4.4 resolve","index":"1.5.4"},{"id":"4.5-dev-server","title":"4.5 dev server","index":"1.5.5"},{"id":"4.6-optimization","title":"4.6 optimization","index":"1.5.6"}]}]}],"copyright":{"custom":"不许转载😡！！！"},"reading_time":"3683 words in 18 min"}