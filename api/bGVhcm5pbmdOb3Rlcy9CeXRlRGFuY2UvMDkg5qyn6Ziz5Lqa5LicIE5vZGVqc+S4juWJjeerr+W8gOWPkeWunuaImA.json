{"title":"Nodejs ä¸å‰ç«¯å¼€å‘å®æˆ˜ - å­—èŠ‚é’è®­è¥","date":"2022-01-23T16:00:00.000Z","date_formatted":{"ll":"Jan 24, 2022","L":"01/24/2022","MM-DD":"01-24"},"link":"learningNotes/ByteDance/09 æ¬§é˜³äºšä¸œ Nodejsä¸å‰ç«¯å¼€å‘å®æˆ˜","tags":["Nodejs","é’è®­è¥"],"categories":["learningNotes"],"updated":"2022-01-23T16:00:00.000Z","content":"<h2 id=\"1.-nodejs-çš„åº”ç”¨åœºæ™¯-why\">1. Nodejs çš„åº”ç”¨åœºæ™¯ why<a title=\"#1.-nodejs-çš„åº”ç”¨åœºæ™¯-why\" href=\"#1.-nodejs-çš„åº”ç”¨åœºæ™¯-why\"></a></h2>\n<h4 id=\"å‰ç«¯å·¥ç¨‹åŒ–\">å‰ç«¯å·¥ç¨‹åŒ–<a title=\"#å‰ç«¯å·¥ç¨‹åŒ–\" href=\"#å‰ç«¯å·¥ç¨‹åŒ–\"></a></h4>\n<ul>\n<li>Bundleï¼šwebpackã€viteã€esbuildã€parcel</li>\n<li>Uglifyï¼šuglifyjs</li>\n<li>Transpileï¼šbablejsã€typescript</li>\n<li>å…¶ä»–è¯­è¨€åŠ å…¥ç«äº‰ï¼šesbuildã€parcelã€prisma</li>\n<li>ç°çŠ¶ï¼šéš¾ä»¥æ›¿ä»£</li>\n</ul>\n<h4 id=\"web-æœåŠ¡ç«¯åº”ç”¨\">web æœåŠ¡ç«¯åº”ç”¨<a title=\"#web-æœåŠ¡ç«¯åº”ç”¨\" href=\"#web-æœåŠ¡ç«¯åº”ç”¨\"></a></h4>\n<ul>\n<li>å­¦ä¹ æ›²çº¿å¹³ç¼“ï¼Œå¼€å‘æ•ˆç‡é«˜</li>\n<li>è¿è¡Œæ•ˆç‡æ¥è¿‘å¸¸è§çš„ç¼–è¯‘è¯­è¨€</li>\n<li>ç¤¾åŒºç”Ÿæ€ä¸°å¯ŒåŠå·¥å…·é“¾æˆç†Ÿ npmã€v8 inspector</li>\n<li>ä¸å‰ç«¯ç»“åˆçš„åœºæ™¯ä¼šæœ‰ä¼˜åŠ¿ ssr</li>\n<li>ç°çŠ¶ï¼šç«äº‰æ¿€çƒˆï¼Œnodejs æœ‰è‡ªå·±ç‹¬ç‰¹çš„ä¼˜åŠ¿</li>\n</ul>\n<h4 id=\"electron-è·¨ç«¯æ¡Œé¢åº”ç”¨\">Electron è·¨ç«¯æ¡Œé¢åº”ç”¨<a title=\"#electron-è·¨ç«¯æ¡Œé¢åº”ç”¨\" href=\"#electron-è·¨ç«¯æ¡Œé¢åº”ç”¨\"></a></h4>\n<ul>\n<li>å•†ä¸šåº”ç”¨ï¼švscodeã€slackã€discordã€zoom</li>\n<li>å¤§å‹å…¬å¸å†…çš„æ•ˆç‡å·¥å…·</li>\n<li>ç°çŠ¶ï¼šå¤§éƒ¨åˆ†åœ¨é€‰å‹æ—¶ï¼Œéƒ½å€¼å¾—è€ƒè™‘</li>\n</ul>\n<h4 id=\"nodejs-åœ¨å­—èŠ‚\">Nodejs åœ¨å­—èŠ‚<a title=\"#nodejs-åœ¨å­—èŠ‚\" href=\"#nodejs-åœ¨å­—èŠ‚\"></a></h4>\n<ul>\n<li>BFFã€SSR</li>\n<li>æœåŠ¡ç«¯åº”ç”¨ï¼šå¤´æ¡æœç´¢ã€è¥¿ç“œè§†é¢‘</li>\n<li>Electronï¼šé£è¿ã€é£ä¹¦</li>\n</ul>\n<h2 id=\"2.-nodejs-è¿è¡Œæ—¶ç»“æ„-what\">2. Nodejs è¿è¡Œæ—¶ç»“æ„ what<a title=\"#2.-nodejs-è¿è¡Œæ—¶ç»“æ„-what\" href=\"#2.-nodejs-è¿è¡Œæ—¶ç»“æ„-what\"></a></h2>\n<img src=\"https://i.bmp.ovh/imgs/2022/01/1a6e5ab8fa56abba.png\" style=\"zoom:67%;\" >\n<blockquote>\n<p>ç¤¾åŒºnpmä»£ç  ï¼šacronã€node-inspect è°ƒè¯•ã€npmæœ¬èº«</p>\n<p>N-APIï¼šjsæ€§èƒ½å¤ªä½ï¼Œæƒ³ç”¨æ›´nativeçš„è¯­è¨€</p>\n<p>v8ï¼šå®ç°jsè¿è¡Œæ—¶</p>\n<p>libuvï¼šå°è£…äº†æ“ä½œç³»ç»Ÿapiï¼Œnodejsæœ€æ ¸å¿ƒçš„å†…å®¹</p>\n<p>nghttp2ï¼šä¸ http2 ç›¸å…³çš„æ¨¡å—</p>\n<p>zlibï¼šåšä¸€äº›åœºæ™¯å‹ç¼©è§£å‹ç¼©çš„ç®—æ³•</p>\n<p>c-aresï¼šåšdnsæŸ¥è¯¢çš„åº“</p>\n<p>llhttpï¼šåšhttpåè®®çš„è§£æ</p>\n<p>opensslï¼šç½‘ç»œå±‚çš„åŠ å¯†è§£å¯†åè®®</p>\n</blockquote>\n<h4 id=\"v8ï¼Œlibuv\">V8ï¼Œlibuv<a title=\"#v8ï¼Œlibuv\" href=\"#v8ï¼Œlibuv\"></a></h4>\n<p>V8ï¼šJavaScript Runtimeï¼Œè¯Šæ–­è°ƒè¯•å·¥å…· inspector</p>\n<p>libuvï¼ševentloop äº‹ä»¶å¾ªç¯ï¼Œsyscall ç³»ç»Ÿè°ƒç”¨</p>\n<p>ä¸¾ä¾‹ï¼šç”¨ node-fetch å‘èµ·è¯·æ±‚æ—¶â€¦</p>\n<blockquote>\n<p>nodejs å…¶å®æ˜¯åŸºäº v8 åšçš„ã€‚</p>\n<p>é¢è¯• ï¼šlibuvæ˜¯ç”¨æ¥å¹²å˜›çš„ï¼Ÿ</p>\n</blockquote>\n<h4 id=\"ç‰¹ç‚¹\">ç‰¹ç‚¹<a title=\"#ç‰¹ç‚¹\" href=\"#ç‰¹ç‚¹\"></a></h4>\n<ul>\n<li>\n<p>å¼‚æ­¥ I/O</p>\n</li>\n<li>\n<p>å•çº¿ç¨‹ worker_threadå¯ä»¥èµ·ç‹¬ç«‹çº¿ç¨‹ï¼Œä½†æ¯ä¸ªçº¿ç¨‹çš„æ¨¡å‹æ²¡æœ‰å¤ªå¤§å˜åŒ–</p>\n<p>JS å•çº¿ç¨‹ï¼šJS çº¿ç¨‹ + uv çº¿ç¨‹æ±  + V8 ä»»åŠ¡çº¿ç¨‹æ±  + V8 inspector çº¿ç¨‹</p>\n<p>ä¼˜ç‚¹ï¼šä¸ç”¨è€ƒè™‘å¤šçº¿ç¨‹çŠ¶æ€åŒæ­¥é—®é¢˜ï¼Œä¹Ÿå°±ä¸éœ€è¦é”ï¼›åŒæ—¶è¿˜èƒ½æ¯”è¾ƒè¾ƒé«˜æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æº</p>\n<p>ç¼ºç‚¹ï¼šé˜»å¡ä¼šäº§ç”Ÿæ›´å¤šè´Ÿé¢å½±å“ â€“ ä½¿ç”¨å¤šè¿›ç¨‹ æˆ–è€… å¤šçº¿ç¨‹</p>\n</li>\n<li>\n<p>è·¨å¹³å°</p>\n<p>Nodejs è·¨å¹³å° + JS æ— éœ€ç¼–è¯‘ç¯å¢ƒ ( + web è·¨å¹³å° + è¯Šæ–­å·¥å…·è·¨å¹³å° ) â€“ å¼€å‘æˆæœ¬ä½ã€æ•´ä½“å­¦ä¹ æˆæœ¬ä½</p>\n</li>\n</ul>\n<h2 id=\"3.-ç¼–å†™-http-server-how\">3. ç¼–å†™ Http Server how<a title=\"#3.-ç¼–å†™-http-server-how\" href=\"#3.-ç¼–å†™-http-server-how\"></a></h2>\n<h3 id=\"3.0-å®‰è£…-nodejs\">3.0 å®‰è£… nodejs<a title=\"#3.0-å®‰è£…-nodejs\" href=\"#3.0-å®‰è£…-nodejs\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// json</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;http&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> server = http.<span class=\"title function_\">createServer</span>(<span class=\"function\">(<span class=\"params\">req,res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> bufd = [];</span><br><span class=\"line\">    req.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;data&#x27;</span>,<span class=\"function\">(<span class=\"params\">buf</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        bufs.<span class=\"title function_\">push</span>(buf)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    req.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;end&#x27;</span>,<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> buf = <span class=\"title class_\">Buffer</span>.<span class=\"title function_\">concat</span>(bufs).<span class=\"title function_\">toString</span>(<span class=\"string\">&#x27;utf8&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">let</span> msg = <span class=\"string\">&#x27;hello&#x27;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> ret = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(buf);</span><br><span class=\"line\">            msg = ret.<span class=\"property\">msg</span>;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span>(err)&#123;</span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> responseJson = &#123;</span><br><span class=\"line\">            <span class=\"attr\">msg</span>:<span class=\"string\">`receive:<span class=\"subst\">$&#123;msg&#125;</span>`</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        res.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Content-Type&#x27;</span>, <span class=\"string\">&#x27;application/json&#x27;</span>);</span><br><span class=\"line\">        res.<span class=\"title function_\">end</span>(<span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(responseJson))</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> port = <span class=\"number\">3000</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">server.<span class=\"title function_\">listen</span>(port, <span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`server listen on:<span class=\"subst\">$&#123;port&#125;</span>`</span>);  </span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.1-ç¼–å†™-http-server-+-client-ï¼Œæ”¶å‘-getï¼Œpost\">3.1 ç¼–å†™ Http Server + Client ï¼Œæ”¶å‘ GETï¼ŒPOST<a title=\"#3.1-ç¼–å†™-http-server-+-client-ï¼Œæ”¶å‘-getï¼Œpost\" href=\"#3.1-ç¼–å†™-http-server-+-client-ï¼Œæ”¶å‘-getï¼Œpost\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;http&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> body = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">msg</span>: <span class=\"string\">&#x27;Hello from my own client&#x27;</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> req = http.<span class=\"title function_\">request</span>(<span class=\"string\">&#x27;http://127.0.0.1:3000&#x27;</span>,&#123;</span><br><span class=\"line\">    <span class=\"attr\">method</span>: <span class=\"string\">&#x27;POST&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">headers</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">&#x27;Content-Type&#x27;</span>: <span class=\"string\">&#x27;application/json&#x27;</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> bufs = [];</span><br><span class=\"line\">    res.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;data&#x27;</span>, <span class=\"function\"><span class=\"params\">buf</span> =&gt;</span>&#123;</span><br><span class=\"line\">        bufs.<span class=\"title function_\">push</span>(buf)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    res.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;end&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> buf = <span class=\"title class_\">Buffer</span>.<span class=\"title function_\">concat</span>(bufs);</span><br><span class=\"line\">        <span class=\"keyword\">const</span> json = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(buf);</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;json.msg is:&#x27;</span>, json.<span class=\"property\">msg</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">req.<span class=\"title function_\">end</span>(body)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ç”¨ promise + async await é‡å†™è¿™ä¸¤ä¾‹å­</span></span><br><span class=\"line\"><span class=\"comment\">// æŠ€å·§ï¼šå°†callback è½¬æ¢ä¸º promise</span></span><br><span class=\"line\"><span class=\"comment\">// egï¼šæ”¹å†™ ä¸Šä¸Šä¸ªä»£ç </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;http&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> server = http.<span class=\"title function_\">createServer</span>(<span class=\"keyword\">async</span> (req,res) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> msg = <span class=\"keyword\">await</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123; <span class=\"comment\">//change</span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> bufd = [];</span><br><span class=\"line\">    \treq.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;data&#x27;</span>,<span class=\"function\">(<span class=\"params\">buf</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        \tbufs.<span class=\"title function_\">push</span>(buf)</span><br><span class=\"line\">    \t&#125;)</span><br><span class=\"line\">        req.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;error&#x27;</span>, <span class=\"function\">(<span class=\"params\">err</span>) =&gt;</span> &#123;  <span class=\"comment\">// change</span></span><br><span class=\"line\">            <span class=\"title function_\">reject</span>(err)             <span class=\"comment\">// change</span></span><br><span class=\"line\">        &#125;)                          <span class=\"comment\">// change</span></span><br><span class=\"line\">        req.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;end&#x27;</span>,<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> buf = <span class=\"title class_\">Buffer</span>.<span class=\"title function_\">concat</span>(bufs).<span class=\"title function_\">toString</span>(<span class=\"string\">&#x27;utf8&#x27;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">let</span> msg = <span class=\"string\">&#x27;hello&#x27;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">const</span> ret = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(buf);</span><br><span class=\"line\">                msg = ret.<span class=\"property\">msg</span>;</span><br><span class=\"line\">            &#125;<span class=\"keyword\">catch</span>(err)&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"title function_\">resolve</span>(msg);   <span class=\"comment\">// change</span></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">     <span class=\"keyword\">const</span> responseJson = &#123;</span><br><span class=\"line\">            <span class=\"attr\">msg</span>:<span class=\"string\">`receive:<span class=\"subst\">$&#123;msg&#125;</span>`</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      res.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Content-Type&#x27;</span>, <span class=\"string\">&#x27;application/json&#x27;</span>);</span><br><span class=\"line\">      res.<span class=\"title function_\">end</span>(<span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(responseJson))</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> port = <span class=\"number\">3000</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">server.<span class=\"title function_\">listen</span>(port, <span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`server listen on:<span class=\"subst\">$&#123;port&#125;</span>`</span>);  </span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.2-ç¼–å†™é™æ€èµ„æºæœåŠ¡å™¨\">3.2 ç¼–å†™é™æ€èµ„æºæœåŠ¡å™¨<a title=\"#3.2-ç¼–å†™é™æ€èµ„æºæœåŠ¡å™¨\" href=\"#3.2-ç¼–å†™é™æ€èµ„æºæœåŠ¡å™¨\"></a></h3>\n<p>ç®€å•é™æ€æ–‡ä»¶æœåŠ¡ï¼š</p>\n<p>ä¸é«˜æ€§èƒ½ã€å¯é çš„æœåŠ¡ç›¸æ¯”ï¼Œè¿˜å·®ï¼šCDN ç¼“å­˜åŠ é€Ÿã€åˆ†å¸ƒå¼å‚¨å­˜ã€å®¹ç¾</p>\n<p>å¤–éƒ¨æœåŠ¡ï¼šcloudflareï¼Œä¸ƒç‰›äº‘ï¼Œé˜¿é‡Œäº‘ï¼Œåå±±äº‘</p>\n<blockquote>\n<p>ç”¨ stream é£æ ¼çš„ api æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p>\n<p>å ç”¨å°½å¯èƒ½å°‘çš„å†…å­˜ç©ºé—´ã€å†…å­˜ä½¿ç”¨ç‡æ›´å¥½</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;http&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> fs = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;fs&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;url&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> folderPath = path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;./static&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> server = http.<span class=\"title function_\">createServer</span>(<span class=\"function\">(<span class=\"params\">req,res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// expected http://127.0.0.1:3000/index.html</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> info = url.<span class=\"title function_\">parse</span>(req.<span class=\"property\">url</span>);</span><br><span class=\"line\">    <span class=\"comment\">// static/index.html</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> filepath = path.<span class=\"title function_\">resolve</span>(folderPath, <span class=\"string\">&#x27;./&#x27;</span>, info.<span class=\"property\">path</span>);</span><br><span class=\"line\">    <span class=\"comment\">// stream api..</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> filestream = fs.<span class=\"title function_\">createReadStream</span>(filepath);</span><br><span class=\"line\">    res.<span class=\"title function_\">pipe</span>(filestream)</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> port = <span class=\"number\">3000</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">server.<span class=\"title function_\">listen</span>(port, <span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`server listen on:<span class=\"subst\">$&#123;port&#125;</span>`</span>);  </span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.3-ç¼–å†™-react-ssr\">3.3 ç¼–å†™ React SSR<a title=\"#3.3-ç¼–å†™-react-ssr\" href=\"#3.3-ç¼–å†™-react-ssr\"></a></h3>\n<p>SSR â€” server side rendering ç‰¹ç‚¹ï¼š</p>\n<ul>\n<li>ç›¸æ¯”ä¼ ç»Ÿ HTML æ¨¡æ¿å¼•æ“ï¼šé¿å…é‡å¤ç¼–å†™ä»£ç </li>\n<li>ç›¸æ¯” SPAï¼šé¦–å±æ¸²æŸ“æ›´å¿«ï¼Œseo å‹å¥½</li>\n<li>ç¼ºç‚¹ï¼šé€šå¸¸qps è¾ƒä½ï¼Œå‰ç«¯ä»£ç ç¼–å†™æ—¶è¦è€ƒè™‘æœåŠ¡ç«¯æ¸²æŸ“æƒ…å†µ</li>\n</ul>\n<h3 id=\"3.4-é€‚ç”¨-inspector-è¿›è¡Œè°ƒè¯•ã€è¯Šæ–­\">3.4 é€‚ç”¨ inspector è¿›è¡Œè°ƒè¯•ã€è¯Šæ–­<a title=\"#3.4-é€‚ç”¨-inspector-è¿›è¡Œè°ƒè¯•ã€è¯Šæ–­\" href=\"#3.4-é€‚ç”¨-inspector-è¿›è¡Œè°ƒè¯•ã€è¯Šæ–­\"></a></h3>\n<ul>\n<li>v8 inspectorï¼šå¼€ç®±å³ç”¨ï¼Œç‰¹æ€§ä¸°å¯Œå¼ºå¤§ï¼Œä¸å‰ç«¯å¼€å‘ä¸€è‡´ï¼Œè·¨å¹³å°\n<ul>\n<li>å¯åŠ¨æ—¶ <code>node  --inspect æ–‡ä»¶.js </code></li>\n<li>open <a href=\"http://localhost:9229/json\">http://localhost:9229/json</a></li>\n</ul>\n</li>\n<li>åœºæ™¯ï¼š\n<ul>\n<li>æŸ¥çœ‹ console.log å†…å®¹</li>\n<li>breakpoint</li>\n<li>é«˜ cpuã€æ­»å¾ªç¯ï¼šcpuprofile</li>\n<li>é«˜å†…å­˜å ç”¨ï¼šheapsnapshot</li>\n<li>æ€§èƒ½åˆ†æ</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"3.5-éƒ¨ç½²ç®€ä»‹\">3.5 éƒ¨ç½²ç®€ä»‹<a title=\"#3.5-éƒ¨ç½²ç®€ä»‹\" href=\"#3.5-éƒ¨ç½²ç®€ä»‹\"></a></h3>\n<p>è§£å†³çš„é—®é¢˜ï¼š</p>\n<ul>\n<li>å®ˆæŠ¤è¿›ç¨‹ï¼šå½“è¿›ç¨‹é€€å‡ºæ—¶ï¼Œé‡æ–°æ‹‰èµ·</li>\n<li>å¤šè¿›ç¨‹ï¼šcluster ä¾¿æ·åœ°åˆ©ç”¨å¤šè¿›ç¨‹</li>\n<li>è®°å½•è¿›ç¨‹çŠ¶æ€ï¼Œç”¨äºè¯Šæ–­</li>\n</ul>\n<p>å®¹å™¨ç¯å¢ƒï¼š</p>\n<ul>\n<li>é€šå¸¸æœ‰å¥åº·æ£€æŸ¥çš„æ‰‹æ®µï¼Œåªéœ€è¦è€ƒè™‘å¤šæ ¸ cpu åˆ©ç”¨ç‡å³å¯</li>\n</ul>\n<h2 id=\"4.-å»¶ä¼¸è¯é¢˜\">4. å»¶ä¼¸è¯é¢˜<a title=\"#4.-å»¶ä¼¸è¯é¢˜\" href=\"#4.-å»¶ä¼¸è¯é¢˜\"></a></h2>\n<p>nodejs è´¡çŒ®ä»£ç </p>\n<p>è¿½è¸ª/è¯Šæ–­</p>\n<p>WASMï¼ŒNAPI</p>\n","prev":{"title":"å‰ç«¯å¿…é¡»çŸ¥é“çš„å¼€å‘è°ƒè¯•çŸ¥è¯† - å­—èŠ‚é’è®­è¥","link":"learningNotes/ByteDance/05 ç§ƒå¤´æŠ«é£ä¾  å‰ç«¯å¿…é¡»çŸ¥é“çš„å¼€å‘è°ƒè¯•çŸ¥è¯†"},"next":{"title":"HTTP æŒ‡å— - å­—èŠ‚é’è®­è¥","link":"learningNotes/ByteDance/08 æ¨è¶…ç”· httpæŒ‡å—"},"plink":"https://shylees.github.io/learningNotes/ByteDance/09 æ¬§é˜³äºšä¸œ Nodejsä¸å‰ç«¯å¼€å‘å®æˆ˜/","toc":[{"id":"1.-nodejs-çš„åº”ç”¨åœºæ™¯-why","title":"1. Nodejs çš„åº”ç”¨åœºæ™¯ why","index":"1"},{"id":"2.-nodejs-è¿è¡Œæ—¶ç»“æ„-what","title":"2. Nodejs è¿è¡Œæ—¶ç»“æ„ what","index":"2"},{"id":"3.-ç¼–å†™-http-server-how","title":"3. ç¼–å†™ Http Server how","index":"3","children":[{"id":"3.0-å®‰è£…-nodejs","title":"3.0 å®‰è£… nodejs","index":"3.1"},{"id":"3.1-ç¼–å†™-http-server-+-client-ï¼Œæ”¶å‘-getï¼Œpost","title":"3.1 ç¼–å†™ Http Server + Client ï¼Œæ”¶å‘ GETï¼ŒPOST","index":"3.2"},{"id":"3.2-ç¼–å†™é™æ€èµ„æºæœåŠ¡å™¨","title":"3.2 ç¼–å†™é™æ€èµ„æºæœåŠ¡å™¨","index":"3.3"},{"id":"3.3-ç¼–å†™-react-ssr","title":"3.3 ç¼–å†™ React SSR","index":"3.4"},{"id":"3.4-é€‚ç”¨-inspector-è¿›è¡Œè°ƒè¯•ã€è¯Šæ–­","title":"3.4 é€‚ç”¨ inspector è¿›è¡Œè°ƒè¯•ã€è¯Šæ–­","index":"3.5"},{"id":"3.5-éƒ¨ç½²ç®€ä»‹","title":"3.5 éƒ¨ç½²ç®€ä»‹","index":"3.6"}]},{"id":"4.-å»¶ä¼¸è¯é¢˜","title":"4. å»¶ä¼¸è¯é¢˜","index":"4"}],"copyright":{"custom":"ä¸è®¸è½¬è½½ğŸ˜¡ï¼ï¼ï¼"},"reading_time":"1270 words in 6 min"}