{"title":"09 Vuex","date":"2021-04-20T16:00:00.000Z","date_formatted":{"ll":"Apr 21, 2021","L":"04/21/2021","MM-DD":"04-21"},"link":"learningNotes/vue/09 Vuex","tags":["vue"],"categories":["learningNotes"],"updated":"2021-05-01T16:00:00.000Z","content":"<p>[toc]</p>\n<h2 id=\"1.vue的概念和作用解析\">1.Vue的概念和作用解析<a title=\"#1.vue的概念和作用解析\" href=\"#1.vue的概念和作用解析\"></a></h2>\n<h3 id=\"1.1-vuex-是做什么的\">1.1 Vuex 是做什么的<a title=\"#1.1-vuex-是做什么的\" href=\"#1.1-vuex-是做什么的\"></a></h3>\n<p>官方解释：Vuex是一个专门为Vue.js应用程序开发的状态管理模式。</p>\n<p>采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p>\n<p>Vuex也集成到Vue的官方调试工具<code>devtools extension</code>，提供了诸如零配置的<code>time-travel</code>调试、状态快照导入导出等高级调试功能。</p>\n<blockquote>\n<p>状态管理模式相当于 封装一个大家都能访问的对象里 但Vuex跟自己封装的对象不一样的就是Vuex 实现了响应式</p>\n<p><code>Vuex就是为了提供这样一个在多个组件间共享状态的插件</code></p>\n</blockquote>\n<h3 id=\"1.2-管理什么状态呢？\">1.2 管理什么状态呢？<a title=\"#1.2-管理什么状态呢？\" href=\"#1.2-管理什么状态呢？\"></a></h3>\n<p>比如：用户的登录状态、用户名称、头像等</p>\n<p>比如：商品的收藏、购物车中的物品等</p>\n<p>这些状态信息，我们都可以放在统一的地方，对它进行保存和管理，而且他们还是响应式的</p>\n<h3 id=\"1.3-单页面的状态管理\">1.3 单页面的状态管理<a title=\"#1.3-单页面的状态管理\" href=\"#1.3-单页面的状态管理\"></a></h3>\n<img src='https://s1.328888.xyz/2022/04/09/XaTeC.png' style=\"zoom:67%;\" >\n<p>State：状态—data中的属性</p>\n<p>View：视图层，可以针对State的变化，显示不同的信息—模板</p>\n<p>Actions：用户的各种操作，会导致状态的改变—方法</p>\n<h3 id=\"1.4-多界面状态管理\">1.4 多界面状态管理<a title=\"#1.4-多界面状态管理\" href=\"#1.4-多界面状态管理\"></a></h3>\n<p>Vuex–全局单例模式 （大管家）—Vuex背后的思想</p>\n<ul>\n<li>将共享的状态抽取出来，交给大管家，统一管理</li>\n<li>每个视图，按照规定好的规定，进行访问和修改等操作</li>\n</ul>\n<h3 id=\"1.5-vuex状态管理图例\">1.5 Vuex状态管理图例<a title=\"#1.5-vuex状态管理图例\" href=\"#1.5-vuex状态管理图例\"></a></h3>\n<img src='https://s1.328888.xyz/2022/04/09/XacDg.png' style=\"zoom:50%;\" >\n<p>Devtools ：记录每一次status修改的状态，所以官方网站推荐改vuex时，在这里改</p>\n<p>如果绕过mutations，就没法跟踪修改的状态</p>\n<blockquote>\n<p>mutations 同步操作，所以只有同步操作时可以绕过actions</p>\n<p>actions 异步操作时 如网络请求</p>\n</blockquote>\n<p>backend：后端</p>\n<h3 id=\"1.6-安装devtools插件\">1.6 安装devtools插件<a title=\"#1.6-安装devtools插件\" href=\"#1.6-安装devtools插件\"></a></h3>\n<p>在f12中 的更多 如果又看到vue 就安装成功</p>\n<h2 id=\"2.-vuex的使用\">2. Vuex的使用<a title=\"#2.-vuex的使用\" href=\"#2.-vuex的使用\"></a></h2>\n<h3 id=\"2.1-vuex的下载\">2.1 Vuex的下载<a title=\"#2.1-vuex的下载\" href=\"#2.1-vuex的下载\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install vuex --save @<span class=\"number\">3.0</span><span class=\"number\">.1</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2.2-vuex使用\">2.2 Vuex使用<a title=\"#2.2-vuex使用\" href=\"#2.2-vuex使用\"></a></h3>\n<ol>\n<li>\n<p>把Vuex插件导入</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//main.js</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Vuex</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vuex&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//1.安装插件</span></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">use</span>(<span class=\"title class_\">Vuex</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//2.创建实例</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>一般不在main中写，重建文件夹，store，创建index.js</p>\n<blockquote>\n<p>导入模块   安装插件 创建store对象 导出对象   在main挂载Vue.prototype.$store = store</p>\n<p>在state保存状态</p>\n<p>在mutations写方法 修改state</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Vue</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Vuex</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vuex&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//1.安装插件</span></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">use</span>(<span class=\"title class_\">Vuex</span>)   <span class=\"comment\">//底层会执行这个插件的方法 ： Vuex.install</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//2.创建对象</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> store = <span class=\"keyword\">new</span> <span class=\"title class_\">Vuex</span>.<span class=\"title class_\">Store</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">state</span>:&#123;</span><br><span class=\"line\">        <span class=\"attr\">counter</span>:<span class=\"number\">1000</span></span><br><span class=\"line\">    &#125;,     <span class=\"comment\">//保存状态</span></span><br><span class=\"line\">    <span class=\"attr\">mutations</span>: &#123;</span><br><span class=\"line\">        <span class=\"comment\">//方法</span></span><br><span class=\"line\">        <span class=\"title function_\">increment</span>(<span class=\"params\">state</span>) &#123;</span><br><span class=\"line\">            state.<span class=\"property\">counter</span>++;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"title function_\">decrement</span>(<span class=\"params\">state</span>) &#123;</span><br><span class=\"line\">            state.<span class=\"property\">counter</span>--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">actions</span>:&#123;&#125;,</span><br><span class=\"line\">    <span class=\"attr\">getters</span>:&#123;&#125;,</span><br><span class=\"line\">    <span class=\"attr\">modules</span>:&#123;&#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//3.导出store对象</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> store</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//在main.js挂载</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> stroe <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./stroe&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//这样才会 多个组件使用它</span></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">$store</span> = store</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>在其他页面使用counter</p>\n<blockquote>\n<p>使用state的状态 $store.state.counter</p>\n<p>使用里面的方法 $store.commit(“方法名”)</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//app.vue</span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t&lt;h2&gt;------app内容：直接compontens 修改 state -------&lt;/h2&gt;</span><br><span class=\"line\">\t&lt;h2&gt;&#123;&#123;$store.state.counter&#125;&#125;&lt;/h2&gt;</span><br><span class=\"line\">\t&lt;button @click=&#x27;$store.state.counter++&#x27;&gt;+&lt;/button&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&lt;h2&gt;--------vuex内容：使用nutations--------&lt;/h2&gt;</span><br><span class=\"line\">\t&lt;button @click=&#x27;sub&#x27;&gt;-&lt;/button&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">import HelloVuex from &quot;./components/HelloVuex&quot;;</span><br><span class=\"line\">export default &#123;</span><br><span class=\"line\">\tname: &quot;App&quot;,</span><br><span class=\"line\">\tcomponents: &#123;</span><br><span class=\"line\">\t\tHelloVuex,</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\tdata() &#123;</span><br><span class=\"line\">\t\treturn &#123;</span><br><span class=\"line\">\t\t\tmessage: &quot;我是app组件&quot;,</span><br><span class=\"line\">\t\t\t// counter: 0,</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\tmethods: &#123;</span><br><span class=\"line\">\t\tadd() &#123;</span><br><span class=\"line\">\t\t\treturn this.$store.commit(&quot;increment&quot;);</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tsub() &#123;</span><br><span class=\"line\">\t\t\treturn this.$store.commit(&quot;decrement&quot;);</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<img src='https://s1.328888.xyz/2022/04/09/Xamw1.jpg' style=\"zoom: 50%;\" >\n</li>\n</ol>\n<h2 id=\"3.vuex核心概念（p133-2021/05/01)\">3.Vuex核心概念（p133 2021/05/01)<a title=\"#3.vuex核心概念（p133-2021/05/01)\" href=\"#3.vuex核心概念（p133-2021/05/01)\"></a></h2>\n<h3 id=\"3.1-state-单一状态树\">3.1 State 单一状态树<a title=\"#3.1-state-单一状态树\" href=\"#3.1-state-单一状态树\"></a></h3>\n<blockquote>\n<p>相当于data</p>\n</blockquote>\n<p>一个项目就一个store</p>\n<h3 id=\"3.2-getters\">3.2 Getters<a title=\"#3.2-getters\" href=\"#3.2-getters\"></a></h3>\n<blockquote>\n<p>相当于computed</p>\n</blockquote>\n<p>与计算属性相似，如果要发生什么变化再给其他组件使用</p>\n<ol>\n<li>\n<p>如果要对数据产生什么变化，就直接在getters变化后，去使用就可以了</p>\n<ul>\n<li>\n<p>在getters定义计算属性</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">getters</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"title function_\">powCounter</span>(<span class=\"params\">state</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> state.<span class=\"property\">counter</span> * state.<span class=\"property\">counter</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>在app的template使用计算属性  因为是计算属性 所以可以不用加括号</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t&lt;h3&gt;原来的方法：&#123;&#123;$store.state.counter * $store.state.counter&#125;&#125;&lt;/h3&gt;</span><br><span class=\"line\">\t&lt;h3&gt;使用getters:&#123;&#123;$store.getters.powCounter&#125;&#125;&lt;/h3&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li>\n<p>如果要使用对象中的某一个筛选对象，例如学生中选年龄大于12岁的,加学生个数，传入年龄 选出年龄大的学生</p>\n</li>\n</ol>\n<ul>\n<li>\n<pre><code class=\"language-js\">// index.js \nstate: &#123;\n        //保存状态\n        counter: 1000,\n        students: [\n            &#123; id: 111, name: 'why1', age: 11 &#125;,\n            &#123; id: 112, name: 'why2', age: 12 &#125;,\n            &#123; id: 113, name: 'why3', age: 13 &#125;,\n            &#123; id: 114, name: 'why4', age: 14 &#125;,\n        ]\n    &#125;,\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">+ &gt; 使用计算属性</span><br><span class=\"line\">  &gt;</span><br><span class=\"line\">  &gt; ~~~vue</span><br><span class=\"line\">  &gt; &lt;template&gt;</span><br><span class=\"line\">  &gt; \t&lt;h3&gt;&#123;&#123;more12stu&#125;&#125;&lt;/h3&gt;</span><br><span class=\"line\">  &gt; &lt;/template&gt;</span><br><span class=\"line\">  &gt; &lt;script&gt;</span><br><span class=\"line\">  &gt; computed: &#123;</span><br><span class=\"line\">  &gt; \t\t more12stu() &#123;</span><br><span class=\"line\">  &gt; \t\t \treturn this.$store.state.students.filter((s) =&gt; s.age &gt; 12);</span><br><span class=\"line\">  &gt; \t\t &#125;,</span><br><span class=\"line\">  &gt; \t&#125;,</span><br><span class=\"line\">  &gt; &lt;/script&gt;</span><br></pre></td></tr></table></figure>\n&gt;\n&gt; 要是别的页面要用就得复制过去，很麻烦\n\n</code></pre>\n</li>\n<li>\n<p>使用getters</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js </span></span><br><span class=\"line\"><span class=\"attr\">getters</span>: &#123;</span><br><span class=\"line\">        <span class=\"comment\">//大于12的学生</span></span><br><span class=\"line\">        <span class=\"title function_\">more12stu</span>(<span class=\"params\">state</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> state.<span class=\"property\">students</span>.<span class=\"title function_\">filter</span>(<span class=\"function\"><span class=\"params\">s</span> =&gt;</span> s.<span class=\"property\">age</span> &gt; <span class=\"number\">12</span>)</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"comment\">//大于12的学生的个数</span></span><br><span class=\"line\">        <span class=\"title function_\">more12stuLength</span>(<span class=\"params\">state,getters</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> getters.<span class=\"property\">more12stu</span>.<span class=\"property\">length</span>;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"comment\">//大于age的学生</span></span><br><span class=\"line\">        <span class=\"title function_\">moreAgestu</span>(<span class=\"params\">state</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">age</span> =&gt;</span> state.<span class=\"property\">students</span>.<span class=\"title function_\">filter</span>(<span class=\"function\"><span class=\"params\">s</span> =&gt;</span> s.<span class=\"property\">age</span> &gt; age)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>使用getters的数据</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//vue</span></span><br><span class=\"line\">&lt;h3&gt;年龄大于<span class=\"number\">20</span>的学生：&#123;&#123; $store.<span class=\"property\">getters</span>.<span class=\"property\">more12stu</span> &#125;&#125;&lt;/h3&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//大于12的学生的个数 可以直接 写length</span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>&#123;&#123; $store.getters.more12stu.length &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\">//也可以再写一个计算属性</span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>&#123;&#123; $store.getters.more12stuLength &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//年龄大于age的学生</span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>&#123;&#123; $store.getters.moreAgestu(11) &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"3.3-mutation\">3.3 Mutation<a title=\"#3.3-mutation\" href=\"#3.3-mutation\"></a></h3>\n<blockquote>\n<p>相当于methods</p>\n</blockquote>\n<ul>\n<li>\n<p>vuex的store状态的更新唯一方式：commit mutation</p>\n</li>\n<li>\n<p>mutation包括两个部分：</p>\n<ul>\n<li>字符串的事件类型type <code>increment</code></li>\n<li>一个回调函数handler，该回调函数的第一个参数是state<code>(state)&#123;state.couter--&#125;</code></li>\n</ul>\n</li>\n<li>\n<p>mutation的定义方式：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js</span></span><br><span class=\"line\"><span class=\"attr\">mutatuions</span>:&#123;</span><br><span class=\"line\">    <span class=\"title function_\">increment</span>(<span class=\"params\">state</span>)&#123;</span><br><span class=\"line\">        state,counter--</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>mutation的更新：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//vue</span></span><br><span class=\"line\"><span class=\"attr\">add</span>:<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">$store</span>.<span class=\"title function_\">commit</span>(<span class=\"string\">&#x27;increment&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"3.3.2-传入参数\">3.3.2 传入参数<a title=\"#3.3.2-传入参数\" href=\"#3.3.2-传入参数\"></a></h4>\n<p><strong>参数被称为mutation的载荷Payload</strong></p>\n<p>点击＋任意数量   添加学生</p>\n<ul>\n<li>\n<pre><code class=\"language-vue\">//vue\n&lt;button @click='addcount(5)'&gt;+5&lt;/button&gt;\n&lt;button @click=&quot;addstu&quot;&gt;添加学生&lt;/button&gt;\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">+ 写方法</span><br><span class=\"line\"></span><br><span class=\"line\">  ~~~js</span><br><span class=\"line\">  //vue</span><br><span class=\"line\">  methods:&#123;</span><br><span class=\"line\">      addcount(count)&#123;</span><br><span class=\"line\">          return this.$store.commit(&#x27;incrementcount&#x27;,count);</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      addstu() &#123;</span><br><span class=\"line\">  \t    const stu = &#123; id: 115, name: &quot;why5&quot;, age: 15 &#125;;</span><br><span class=\"line\">  \t\treturn this.$store.commit(&quot;addstu&quot;, stu);</span><br><span class=\"line\">  \t&#125;,</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n</code></pre>\n</li>\n<li>\n<p>mutation</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js</span></span><br><span class=\"line\"><span class=\"attr\">mutations</span>:&#123;</span><br><span class=\"line\">    <span class=\"title function_\">incrementcount</span>(<span class=\"params\">state,count</span>)&#123;</span><br><span class=\"line\">        state.<span class=\"property\">counter</span> += count;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">addstu</span>(<span class=\"params\">state, stu</span>) &#123;</span><br><span class=\"line\">        state.<span class=\"property\">students</span>.<span class=\"title function_\">push</span>(stu)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"3.3.3-mutation的提交风格\">3.3.3 mutation的提交风格<a title=\"#3.3.3-mutation的提交风格\" href=\"#3.3.3-mutation的提交风格\"></a></h4>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//vue methods</span></span><br><span class=\"line\"><span class=\"title function_\">addcount</span>(<span class=\"params\">count</span>) &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//1. 普通提交方式</span></span><br><span class=\"line\">\t <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">$store</span>.<span class=\"title function_\">commit</span>(<span class=\"string\">&quot;incrementcount&quot;</span>, count);</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"comment\">//2.特殊的封装方式</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">$store</span>.<span class=\"title function_\">commit</span>(&#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">type</span>: <span class=\"string\">&quot;incrementcount&quot;</span>,</span><br><span class=\"line\">\t\tcount,</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js mutation </span></span><br><span class=\"line\"><span class=\"title function_\">incrementcount</span>(<span class=\"params\">state, count</span>) &#123;</span><br><span class=\"line\">       <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(count);</span><br><span class=\"line\">       <span class=\"comment\">// 如果是普通提交 返回的是 count的数值</span></span><br><span class=\"line\">       <span class=\"comment\">// 如果是封装的提交 返回的是整个参数对象  </span></span><br><span class=\"line\">       <span class=\"comment\">// 这里就应该使用 payload参数命名 然后使用layload.count</span></span><br><span class=\"line\">       state.<span class=\"property\">counter</span> += count</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"title function_\">incrementcount</span>(<span class=\"params\">state,layload</span>)&#123;</span><br><span class=\"line\">    state.<span class=\"property\">counter</span> += layload.<span class=\"property\">count</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"3.3.4-vuex数据响应式原理(对组件也是一个道理)\">3.3.4 vuex数据响应式原理(对组件也是一个道理)<a title=\"#3.3.4-vuex数据响应式原理(对组件也是一个道理)\" href=\"#3.3.4-vuex数据响应式原理(对组件也是一个道理)\"></a></h4>\n<img src='https://s1.328888.xyz/2022/04/09/XawBt.jpg' style=\"zoom:50%;\" >\n<p>在里面的定义的每个属性 都会有一个Dep[watcher…]  watcher会监听每一个页面的属性变化</p>\n<h5 id=\"3.3.4.1在mutations增加删除数据事如何做到响应式\">3.3.4.1在mutations增加删除数据事如何做到响应式<a title=\"#3.3.4.1在mutations增加删除数据事如何做到响应式\" href=\"#3.3.4.1在mutations增加删除数据事如何做到响应式\"></a></h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">mutations</span>:&#123;</span><br><span class=\"line\">    <span class=\"title function_\">updateInfo</span>(<span class=\"params\">state</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//这样无法响应式 就是代码改了 无法在页面改 因为没有监听</span></span><br><span class=\"line\">        state.<span class=\"property\">info</span>[<span class=\"string\">&#x27;address&#x27;</span>] = <span class=\"string\">&#x27;china&#x27;</span>;</span><br><span class=\"line\">        <span class=\"comment\">//使用Vue.set方法就可以</span></span><br><span class=\"line\">        <span class=\"title class_\">Vue</span>.<span class=\"title function_\">set</span>(state.<span class=\"property\">info</span> , <span class=\"string\">&#x27;address&#x27;</span> , <span class=\"string\">&#x27;china&#x27;</span>);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//删除数据时 使用delete删除无法响应式</span></span><br><span class=\"line\">        <span class=\"keyword\">delete</span> state.<span class=\"property\">info</span>.<span class=\"property\">age</span>;</span><br><span class=\"line\">        <span class=\"comment\">//使用Vue.delete可以</span></span><br><span class=\"line\">        <span class=\"title class_\">Vue</span>.<span class=\"title function_\">delete</span>(state.<span class=\"property\">info</span> , <span class=\"string\">&#x27;age&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"3.3.5-mutation常量类型\">3.3.5 mutation常量类型<a title=\"#3.3.5-mutation常量类型\" href=\"#3.3.5-mutation常量类型\"></a></h4>\n<p>把vue里面methods里面commit括号里的”increment“，和index.js里mutations里的increment变成一个常量，这样不会写错</p>\n<ol>\n<li>\n<p>在store文件夹下面 新建 <code>mutations.types.js</code> 用来导出常量</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//mutations.types.js</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> <span class=\"variable constant_\">INCREMENT</span> = <span class=\"string\">&quot;increment&quot;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>导入文件，修改vue里的”increment“</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"variable constant_\">INCREMENT</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;../store/mutations.types&quot;</span>;</span><br><span class=\"line\"><span class=\"title function_\">add</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">$store</span>.<span class=\"title function_\">commit</span>(<span class=\"variable constant_\">INCREMENT</span>);</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>导入文件，修改index.js的increment</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"variable constant_\">INCREMENT</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./mutations.types&#x27;</span></span><br><span class=\"line\">[<span class=\"variable constant_\">INCREMENT</span>](state) &#123;</span><br><span class=\"line\">            state.<span class=\"property\">counter</span>++;</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"3.4-action\">3.4 Action<a title=\"#3.4-action\" href=\"#3.4-action\"></a></h3>\n<blockquote>\n<p>相当于异步methods</p>\n</blockquote>\n<p>在mutations中进行异步操作，devtools插件没有办法追踪到变化，页面变化，但是控制台的代码没有变</p>\n<p>所以用actions替代mutations</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js</span></span><br><span class=\"line\"><span class=\"attr\">mutations</span>:&#123;</span><br><span class=\"line\">    <span class=\"title function_\">updateInfo</span>(<span class=\"params\">state</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> state.<span class=\"property\">info</span>.<span class=\"property\">name</span> = <span class=\"string\">&#x27;why&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"attr\">actions</span>:&#123;</span><br><span class=\"line\">    <span class=\"comment\">//context:上下文  可看成state 不能跳过mutations</span></span><br><span class=\"line\">    <span class=\"comment\">//传参数</span></span><br><span class=\"line\">    <span class=\"title function_\">aUpdateInfo</span>(<span class=\"params\">context,payload</span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">setTimeOut</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            context.<span class=\"title function_\">commit</span>(<span class=\"string\">&#x27;updateInfo&#x27;</span>,payload); </span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(paylog);</span><br><span class=\"line\">        &#125;,<span class=\"number\">1000</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在vue中操作</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;button @click=<span class=\"string\">&quot;updateInfo&quot;</span>&gt;更新&lt;/button&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">updateInfo</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"comment\">//this.$store.commit(&#x27;updateInfo&#x27;);  //不会改代码</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">$store</span>.<span class=\"title function_\">dispatch</span>(<span class=\"string\">&#x27;aUpdateInfo&#x27;</span>,<span class=\"string\">&#x27;我是payload&#x27;</span>);  <span class=\"comment\">//这样才会经过actions mutations 然后被插件检测到</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>在修改成功的时候通知用户</strong></p>\n<p>一般在commit的地方就修改成功了</p>\n<ul>\n<li>\n<p>正常写法：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//vue</span></span><br><span class=\"line\"><span class=\"title function_\">updateInfo</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"comment\">//this.$store.dispatch(&#x27;aUpdateInfo&#x27;,()=&gt;&#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//    console.log(&quot;修改成功&quot;);</span></span><br><span class=\"line\">    <span class=\"comment\">//&#125;)</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">$store</span>.<span class=\"title function_\">dispatch</span>(<span class=\"string\">&#x27;aUpdateInfo&#x27;</span>,&#123;</span><br><span class=\"line\">        <span class=\"attr\">message</span>:<span class=\"string\">&quot;我是携带信息&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">success</span>:<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;修改成功&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js</span></span><br><span class=\"line\"><span class=\"attr\">actions</span>:&#123;</span><br><span class=\"line\">    <span class=\"title function_\">aUpdateInfo</span>(<span class=\"params\">context,payload</span>)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            context.<span class=\"title function_\">commit</span>(<span class=\"string\">&#x27;updateInfo&#x27;</span>);  <span class=\"comment\">//一般在这会修改成功</span></span><br><span class=\"line\">            <span class=\"comment\">//payload()</span></span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(layload.<span class=\"property\">message</span>);</span><br><span class=\"line\">            payload.<span class=\"title function_\">success</span>();</span><br><span class=\"line\">        &#125;,<span class=\"number\">1000</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>优雅的写法 使用promise</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//vue</span></span><br><span class=\"line\"><span class=\"title function_\">updateInfo</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">$store</span></span><br><span class=\"line\">    .<span class=\"title function_\">dispatch</span>(<span class=\"string\">&quot;aUpdateInfo&quot;</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js</span></span><br><span class=\"line\"><span class=\"title function_\">aUpdateInfo</span>(<span class=\"params\">context,payload</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            context.<span class=\"title function_\">commit</span>(<span class=\"string\">&#x27;updateInfo&#x27;</span>);</span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(payload);</span><br><span class=\"line\">            <span class=\"title function_\">resolve</span>(<span class=\"number\">111</span>);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"3.5-module\">3.5 Module<a title=\"#3.5-module\" href=\"#3.5-module\"></a></h3>\n<ul>\n<li>因为vue使用单一状态树意味着很多状态都给vuex来管理</li>\n<li>当应该很复杂时store就很臃肿</li>\n<li>所以vuex允许我们将store分割城模块，每个模块拥有自己的state、mutations、actions、getters</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> moduleA = &#123;</span><br><span class=\"line\">    <span class=\"attr\">state</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">name</span>: <span class=\"string\">&quot;lisi&quot;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">mutations</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">updatelisi</span>(<span class=\"params\">state.payload</span>)&#123;</span><br><span class=\"line\">            state.<span class=\"property\">name</span>=payload;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">actions</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">aupdatelisi</span>(<span class=\"params\">context</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//这里commit的是上面部分的mutations</span></span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(context);<span class=\"comment\">//有根的各种东西</span></span><br><span class=\"line\">            <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">                context.<span class=\"title function_\">commit</span>(<span class=\"string\">&#x27;updatelisi&#x27;</span>, <span class=\"string\">&#x27;wangwu&#x27;</span>);</span><br><span class=\"line\">            &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">getters</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">fullname</span>(<span class=\"params\">state</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> state.<span class=\"property\">name</span> + <span class=\"string\">&#x27; getters&#x27;</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"title function_\">fullname</span>(<span class=\"params\">state, getters ,rootState</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//rootState 根的state</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> getters.<span class=\"property\">fullname</span> + rootState.<span class=\"property\">counter</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> store = <span class=\"keyword\">new</span> <span class=\"title class_\">Vuex</span>.<span class=\"title class_\">Store</span>(&#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"attr\">modules</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">a</span>: moduleA</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">//vue使用</span></span><br><span class=\"line\">&lt;h3 style=<span class=\"string\">&quot;color: red&quot;</span>&gt;&#123;&#123; $store.<span class=\"property\">state</span>.<span class=\"property\">a</span>.<span class=\"property\">name</span> &#125;&#125;&lt;/h3&gt;</span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: red&quot;</span>&gt;</span>&#123;&#123; $store.getters.fullname &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: red&quot;</span>&gt;</span>&#123;&#123; $store.getters.fullname2 &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;change&quot;</span>&gt;</span>改名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;asyncChange&quot;</span>&gt;</span>异步改名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">methods</span>:&#123;</span><br><span class=\"line\">    <span class=\"title function_\">change</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">$store</span>.<span class=\"title function_\">commit</span>(<span class=\"string\">&#x27;updatelisi&#x27;</span>,<span class=\"string\">&quot;张三&quot;</span>);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">\t<span class=\"title function_\">asyncChange</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"variable language_\">this</span>.<span class=\"property\">$store</span>.<span class=\"title function_\">dispatch</span>(<span class=\"string\">&quot;aupdatelisi&quot;</span>);</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.6-actions的写法-对象的解构\">3.6 actions的写法 对象的解构<a title=\"#3.6-actions的写法-对象的解构\" href=\"#3.6-actions的写法-对象的解构\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">actions</span>:&#123;</span><br><span class=\"line\">    <span class=\"title function_\">add</span>(<span class=\"params\">context</span>)&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">//也可以写成</span></span><br><span class=\"line\">    <span class=\"title function_\">add</span>(<span class=\"params\">&#123;state,commit,rootState&#125;</span>)&#123;</span><br><span class=\"line\">       ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>解构：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> obj = &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>:<span class=\"string\">&#x27;11&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span><br><span class=\"line\">    <span class=\"attr\">height</span>:<span class=\"number\">1.88</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123;age , name&#125; = obj;</span><br></pre></td></tr></table></figure>\n<h2 id=\"4.store文件夹的目录组织\">4.store文件夹的目录组织<a title=\"#4.store文件夹的目录组织\" href=\"#4.store文件夹的目录组织\"></a></h2>\n<p>把mutations、actions、getters全部抽出文件 导入到<code>index.js</code></p>\n<p>建modules文件夹，放moduleA.js …文件 导入<code>index.js</code></p>\n<p>state一般不抽</p>\n","prev":{"title":"路径别名配置","link":"learningNotes/vue/07 封装tabbar的知识"},"next":{"title":"Promise 简述","link":"learningNotes/vue/08 Promise"},"plink":"https://shylees.github.io/learningNotes/vue/09 Vuex/","toc":[{"id":"1.vue的概念和作用解析","title":"1.Vue的概念和作用解析","index":"1","children":[{"id":"1.1-vuex-是做什么的","title":"1.1 Vuex 是做什么的","index":"1.1"},{"id":"1.2-管理什么状态呢？","title":"1.2 管理什么状态呢？","index":"1.2"},{"id":"1.3-单页面的状态管理","title":"1.3 单页面的状态管理","index":"1.3"},{"id":"1.4-多界面状态管理","title":"1.4 多界面状态管理","index":"1.4"},{"id":"1.5-vuex状态管理图例","title":"1.5 Vuex状态管理图例","index":"1.5"},{"id":"1.6-安装devtools插件","title":"1.6 安装devtools插件","index":"1.6"}]},{"id":"2.-vuex的使用","title":"2. Vuex的使用","index":"2","children":[{"id":"2.1-vuex的下载","title":"2.1 Vuex的下载","index":"2.1"},{"id":"2.2-vuex使用","title":"2.2 Vuex使用","index":"2.2"}]},{"id":"3.vuex核心概念（p133-2021/05/01)","title":"3.Vuex核心概念（p133 2021&#x2F;05&#x2F;01)","index":"3","children":[{"id":"3.1-state-单一状态树","title":"3.1 State 单一状态树","index":"3.1"},{"id":"3.2-getters","title":"3.2 Getters","index":"3.2"},{"id":"3.3-mutation","title":"3.3 Mutation","index":"3.3"},{"id":"3.4-action","title":"3.4 Action","index":"3.4"},{"id":"3.5-module","title":"3.5 Module","index":"3.5"},{"id":"3.6-actions的写法-对象的解构","title":"3.6 actions的写法 对象的解构","index":"3.6"}]},{"id":"4.store文件夹的目录组织","title":"4.store文件夹的目录组织","index":"4"}],"copyright":{"custom":"不许转载😡！！！"},"reading_time":"2662 words in 13 min"}