{"title":"Promise ç®€è¿°","date":"2021-04-20T16:00:00.000Z","date_formatted":{"ll":"Apr 21, 2021","L":"04/21/2021","MM-DD":"04-21"},"link":"learningNotes/vue/08 Promise","tags":["es6","js","promise"],"categories":["learningNotes"],"updated":"2021-04-20T16:00:00.000Z","content":"<h2 id=\"1.-promiseç®€ä»‹\">1. Promiseç®€ä»‹<a title=\"#1.-promiseç®€ä»‹\" href=\"#1.-promiseç®€ä»‹\"></a></h2>\n<ul>\n<li>Promise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ</li>\n</ul>\n<h2 id=\"2.-ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±\">2. ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±<a title=\"#2.-ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±\" href=\"#2.-ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±\"></a></h2>\n<blockquote>\n<p>ç®€è¿°ï¼š</p>\n<p>éœ€è¦é€šè¿‡url1ä»æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªæ•°æ®data1ï¼Œdata1ä¸­åŒ…å«äº†ä¸‹ä¸€ä¸ªè¯·æ±‚çš„url2ï¼›</p>\n<p>éœ€è¦é€šè¿‡data1å–å‡ºurl2ï¼Œä»æœåŠ¡å™¨åŠ è½½æ•°æ®data2ï¼Œdata2åŒ…å«äº†ä¸‹ä¸€ä¸ªè¯·æ±‚çš„url3ï¼›</p>\n<p>éœ€è¦é€šè¿‡data2å–å‡ºurl3ï¼Œä»æœåŠ¡å™¨åŠ è½½æ•°æ®data3ï¼Œdata3åŒ…å«äº†ä¸‹ä¸€ä¸ªè¯·æ±‚çš„url4ï¼›</p>\n<p>å‘é€ç½‘ç»œè¯·æ±‚url4ï¼Œè·å–æœ€ç»ˆçš„æ•°æ®data4</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$.<span class=\"title function_\">ajax</span>(<span class=\"string\">&#x27;url1&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\">data1</span>)&#123;</span><br><span class=\"line\">    $.<span class=\"title function_\">ajax</span>(data1[<span class=\"string\">&#x27;url2&#x27;</span>],<span class=\"keyword\">function</span>(<span class=\"params\">data2</span>)&#123;</span><br><span class=\"line\">        $.<span class=\"title function_\">ajax</span>(data1[<span class=\"string\">&#x27;url3&#x27;</span>],<span class=\"keyword\">function</span>(<span class=\"params\">data3</span>)&#123;</span><br><span class=\"line\">        \t$.<span class=\"title function_\">ajax</span>(data1[<span class=\"string\">&#x27;url4&#x27;</span>],<span class=\"keyword\">function</span>(<span class=\"params\">data4</span>)&#123;</span><br><span class=\"line\">        \t\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(data4);</span><br><span class=\"line\">    \t\t&#125;)</span><br><span class=\"line\">    \t&#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>è¿™æ ·çš„ä»£ç éš¾çœ‹ä¸”ä¸æ˜“ç»´æŠ¤</p>\n<p>æ›´åŠ æœŸæœ›ç”¨ä¸€ç§æ›´åŠ ä¼˜é›…çš„æ–¹å¼æ¥è¿›è¡Œè¿™ç§å¼‚æ­¥æ“ä½œâ€”â€”promise</p>\n</blockquote>\n<h2 id=\"3.å®šæ—¶å™¨çš„å¼‚æ­¥äº‹ä»¶\">3.å®šæ—¶å™¨çš„å¼‚æ­¥äº‹ä»¶<a title=\"#3.å®šæ—¶å™¨çš„å¼‚æ­¥äº‹ä»¶\" href=\"#3.å®šæ—¶å™¨çš„å¼‚æ­¥äº‹ä»¶\"></a></h2>\n<blockquote>\n<p>ä½¿ç”¨å®šæ—¶å™¨æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1. ä½¿ç”¨setTimeout</span></span><br><span class=\"line\"><span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> data = <span class=\"string\">&#x27;Hello World&#x27;</span></span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(data);</span><br><span class=\"line\">&#125;,<span class=\"number\">1000</span>)</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>ä¸Šè¿°æ˜¯æˆ‘ä»¬è¿‡å»çš„å¤„ç†æ–¹å¼ï¼Œå°†å…¶è½¬æ¢æˆpromiseä»£ç ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å‚æ•° -&gt; å‡½æ•°(resolve,reject)</span></span><br><span class=\"line\"><span class=\"comment\">// resolve,rejectæœ¬èº«ä¹Ÿæ˜¯å‡½æ•°</span></span><br><span class=\"line\"><span class=\"comment\">// é“¾å¼ç¼–ç¨‹</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//æˆåŠŸæ—¶è°ƒç”¨ resolve</span></span><br><span class=\"line\">        <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;Hello World&#x27;</span>)</span><br><span class=\"line\">        <span class=\"comment\">//å¤±è´¥æ—¶ è°ƒç”¨reject</span></span><br><span class=\"line\">        <span class=\"title function_\">reject</span>(<span class=\"string\">&#x27;Error Data&#x27;</span>)</span><br><span class=\"line\">    &#125;,<span class=\"number\">1000</span>)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(data);</span><br><span class=\"line\">&#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">error</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(error);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°promiseï¼Ÿ</p>\n<p>ä¸€èˆ¬æ˜¯æœ‰å¼‚æ­¥æ“ä½œæ—¶ï¼Œä½¿ç”¨promiseå¯¹è¿™ä¸ªå¼‚æ­¥æ“ä½œè¿›è¡Œå°è£…</p>\n</li>\n<li>\n<p>æ€ä¹ˆä½¿ç”¨</p>\n<p>new -&gt; æ„é€ å‡½æ•°ï¼ˆ1.ä¿å­˜äº†ä¸€äº›çŠ¶æ€ä¿¡æ¯ 2.æ‰§è¡Œä¼ å…¥çš„å‡½æ•°ï¼‰</p>\n<p>åœ¨æ‰§è¡Œä¼ å…¥çš„å›è°ƒå‡½æ•°æ—¶ï¼Œä¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œresolveï¼Œrejectï¼Œå…¶æœ¬èº«ä¹Ÿæ˜¯å‡½æ•°</p>\n</li>\n</ul>\n<h2 id=\"3.promiseä¸‰ç§çŠ¶æ€\">3.Promiseä¸‰ç§çŠ¶æ€<a title=\"#3.promiseä¸‰ç§çŠ¶æ€\" href=\"#3.promiseä¸‰ç§çŠ¶æ€\"></a></h2>\n<ul>\n<li>åœ¨å¼€å‘ä¸­æœ‰å¼‚æ­¥æ“ä½œæ—¶ï¼Œå°±å¯ä»¥ç»™å¼‚æ­¥æ“ä½œåŒ…è£…ä¸€ä¸ªPromiseã€‚å¼‚æ­¥æ“ä½œä¹‹åä¼šæœ‰ä¸‰ç§çŠ¶æ€:\n<ul>\n<li>pendingï¼šç­‰å¾…çŠ¶æ€ï¼Œå¦‚ï¼šæ­£åœ¨è¿›è¡Œç½‘è·¯è¯·æ±‚ï¼Œæˆ–è€…å®šæ—¶å™¨æ²¡æœ‰åˆ°æ—¶é—´</li>\n<li>fulfillï¼šæ»¡è¶³çŠ¶æ€ï¼Œå½“ä¸»åŠ¨å›è°ƒäº†resolveæ—¶ï¼Œå°±å¤„äºè¯¥çŠ¶æ€ï¼Œå¹¶ä¸”ä¼šå›è°ƒ.then()</li>\n<li>rejectï¼šæ‹’ç»çŠ¶æ€ï¼Œå½“ä¸»åŠ¨å›è°ƒäº†rejectæ—¶ï¼Œå°±å¤„äºè¯¥çŠ¶æ€ï¼Œå¹¶ä¸”ä¼šå›è°ƒ.catch()</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// promise çš„å¦å¤–å¤„ç†å½¢å¼</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve,reject</span>) =&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;Hello Vuejs&#x27;</span>)</span><br><span class=\"line\">        <span class=\"comment\">// reject(&#x27;error message&#x27;)</span></span><br><span class=\"line\">    &#125;,<span class=\"number\">1000</span>)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(data);</span><br><span class=\"line\">&#125;,<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-promise-é“¾å¼è°ƒç”¨\">4 Promise é“¾å¼è°ƒç”¨<a title=\"#4-promise-é“¾å¼è°ƒç”¨\" href=\"#4-promise-é“¾å¼è°ƒç”¨\"></a></h2>\n<ul>\n<li>åœ¨Promiseçš„æµç¨‹å›¾ä¸­ï¼Œæ— è®ºæ—¶thenè¿˜æ˜¯catchéƒ½å¯ä»¥è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡</li>\n<li>æ‰€ä»¥ï¼Œä»£ç å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨ï¼š\n<ul>\n<li>ç›´æ¥é€šè¿‡PromiseåŒ…è£…æ–°çš„æ•°æ®ï¼Œå°†Promiseå¯¹è±¡è¿”å›</li>\n<li>Promise.resolve()ï¼šå°†æ•°æ®åŒ…è£…æˆPromiseå¯¹è±¡ï¼Œå¹¶ä¸”åœ¨å†…éƒ¨è°ƒç”¨å›è°ƒresolve()å‡½æ•°</li>\n<li>Promiseã€‚reject()ï¼šå°†æ•°æ®åŒ…è£…æˆPromiseå¯¹è±¡ï¼Œå¹¶ä¸”åœ¨å†…éƒ¨å›è°ƒreject()å‡½æ•°</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//wapped into </span></span><br><span class=\"line\"><span class=\"comment\">//ç½‘ç»œè¯·æ±‚ï¼šaaa -&gt; è‡ªå·±å¤„ç†</span></span><br><span class=\"line\"><span class=\"comment\">// å¤„ç†: aaa111 -&gt; è‡ªå·±å¤„ç†</span></span><br><span class=\"line\"><span class=\"comment\">// å¤„ç†: aaa111222 -&gt; è‡ªå·±å¤„ç†</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;aaa&#x27;</span>)</span><br><span class=\"line\">    &#125;,<span class=\"number\">1000</span>)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//è‡ªå·±å¤„ç†</span></span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//å¯¹ç»“æœè¿›è¡Œç¬¬ä¸€æ¬¡å¤„ç†</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">resolve</span>(res + <span class=\"string\">&#x27;111&#x27;</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">     <span class=\"comment\">//è‡ªå·±å¤„ç†</span></span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//å¯¹ç»“æœè¿›è¡Œç¬¬äºŒæ¬¡å¤„ç†</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">resolve</span>(res + <span class=\"string\">&#x27;222&#x27;</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>é“¾å¼è°ƒç”¨ç®€å†™</p>\n<ul>\n<li>ifå¸Œæœ›æ•°æ®ç›´æ¥åŒ…è£…æˆPromise.resolveï¼Œé‚£ä¹ˆåœ¨thenä¸­å¯ä»¥ç›´æ¥è¿”å›æ•°æ®</li>\n<li>å½“æŠŠreturn Promise.resolve(data) æ”¹æˆreturn dataæ—¶ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   <span class=\"comment\">//å¯¹ç»“æœè¿›è¡Œç¬¬ä¸€æ¬¡å¤„ç†</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> &#123;</span><br><span class=\"line\">       <span class=\"title function_\">resolve</span>(res + <span class=\"string\">&#x27;111&#x27;</span>)</span><br><span class=\"line\">   &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 1. ä½¿ç”¨return Promise.resolve/reject</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"title class_\">Promise</span>.<span class=\"title function_\">resolve</span>(res + <span class=\"string\">&#x27;111&#x27;</span>)</span><br><span class=\"line\">/</span><br><span class=\"line\">   <span class=\"keyword\">return</span> <span class=\"title class_\">Promise</span>.<span class=\"title function_\">reject</span>(<span class=\"string\">&#x27;error message&#x27;</span>)  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 2. çœç•¥Promise.resolve</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> res + <span class=\"string\">&#x27;111&#x27;</span></span><br><span class=\"line\">/ </span><br><span class=\"line\">   <span class=\"keyword\">throw</span> <span class=\"string\">&#x27;error message&#x27;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"5.-é“¾å¼è°ƒç”¨äºŒ\">5. é“¾å¼è°ƒç”¨äºŒ<a title=\"#5.-é“¾å¼è°ƒç”¨äºŒ\" href=\"#5.-é“¾å¼è°ƒç”¨äºŒ\"></a></h2>\n<blockquote>\n<p>ç®€è¿°ï¼šå¦‚æœä¸€ä¸ªç»“æœéœ€è¦ä¸¤ä¸ªè¯·æ±‚æˆåŠŸåæ‰èƒ½å¾—åˆ°</p>\n<p>é‚£æ²¡æœ‰ä½¿ç”¨Promiseæ—¶æ˜¯è¿™æ ·çš„</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> isResult1 = <span class=\"literal\">false</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> isResult2 = <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//è¯·æ±‚1</span></span><br><span class=\"line\">$.<span class=\"title function_\">ajax</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>:<span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">success</span>:<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;result1&#x27;</span>);</span><br><span class=\"line\">        isResult1 = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"title function_\">handleResult</span>()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//è¯·æ±‚2</span></span><br><span class=\"line\">$.<span class=\"title function_\">ajax</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">url</span>:<span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">success</span>:<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;result2&#x27;</span>);</span><br><span class=\"line\">        isResult2 = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"title function_\">handleResult</span>()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleResult</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(isResult1 &amp;&amp; isResult2)&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>Promise.all</strong></p>\n<p>ä½¿ç”¨Promise</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title class_\">Promise</span>.<span class=\"title function_\">all</span>([</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">reslove,reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        $.<span class=\"title function_\">ajax</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">url</span>:<span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">success</span>:<span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">resolve</span>(data)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        $.<span class=\"title function_\">ajax</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">url</span>:<span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">success</span>:<span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123;</span><br><span class=\"line\">                <span class=\"title function_\">resolve</span>(data)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">]).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">results</span> =&gt;</span> &#123;</span><br><span class=\"line\">    results[<span class=\"number\">0</span>]</span><br><span class=\"line\">    results[<span class=\"number\">1</span>]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n","prev":{"title":"è·¯å¾„åˆ«åé…ç½®","link":"learningNotes/vue/vue/07 å°è£…tabbarçš„çŸ¥è¯†"},"next":{"title":"09 Vuex","link":"learningNotes/vue/vue/09 Vuex"},"plink":"https://shylees.github.io/learningNotes/vue/08 Promise/","toc":[{"id":"1.-promiseç®€ä»‹","title":"1. Promiseç®€ä»‹","index":"1"},{"id":"2.-ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±","title":"2. ç½‘ç»œè¯·æ±‚çš„å›è°ƒåœ°ç‹±","index":"2"},{"id":"3.å®šæ—¶å™¨çš„å¼‚æ­¥äº‹ä»¶","title":"3.å®šæ—¶å™¨çš„å¼‚æ­¥äº‹ä»¶","index":"3"},{"id":"3.promiseä¸‰ç§çŠ¶æ€","title":"3.Promiseä¸‰ç§çŠ¶æ€","index":"4"},{"id":"4-promise-é“¾å¼è°ƒç”¨","title":"4 Promise é“¾å¼è°ƒç”¨","index":"5"},{"id":"5.-é“¾å¼è°ƒç”¨äºŒ","title":"5. é“¾å¼è°ƒç”¨äºŒ","index":"6"}],"copyright":{"custom":"ä¸è®¸è½¬è½½ğŸ˜¡ï¼ï¼ï¼"},"reading_time":"1057 words in 5 min"}