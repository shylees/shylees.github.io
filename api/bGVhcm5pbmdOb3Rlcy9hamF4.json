{"title":"ajax å­¦ä¹ ç¬”è®°","date":"2021-09-08T16:00:00.000Z","date_formatted":{"ll":"2021å¹´9æœˆ9æ—¥","L":"2021/09/09","MM-DD":"09-09"},"link":"learningNotes/ajax","tags":["ajax","js"],"categories":["learningNotes"],"updated":"2021-09-09T16:00:00.000Z","content":"<h2 id=\"1.ç®€ä»‹\">1.ç®€ä»‹<a title=\"#1.ç®€ä»‹\" href=\"#1.ç®€ä»‹\"></a></h2>\n<h3 id=\"1.1-ajax\">1.1 ajax<a title=\"#1.1-ajax\" href=\"#1.1-ajax\"></a></h3>\n<p>ajax(asynchronous javascript and xml)ï¼Œå³å¼‚æ­¥ JS å’Œ XML</p>\n<p>é€šè¿‡ ajax å¯ä»¥åœ¨æµè§ˆå™¨ä¸­å‘æœåŠ¡å™¨å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œæœ€å¤§çš„ä¼˜åŠ¿ â€“&gt; æ— åˆ·æ–°è·å–æ•°æ®</p>\n<p>ajax æ˜¯ä¸€ç§å°†ç°æœ‰æ ‡å‡†ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨çš„æ–°æ–¹å¼</p>\n<h3 id=\"1.2-xml\">1.2 xml<a title=\"#1.2-xml\" href=\"#1.2-xml\"></a></h3>\n<p>xml å¯æ‰©å±•æ ‡è®°è¯­è¨€</p>\n<p>è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®</p>\n<p>ä¸ html ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ html ä¸­éƒ½æ˜¯é¢„å®šä¹‰æ ‡ç­¾ï¼Œè€Œ xml æ²¡æœ‰é¢„å®šäºæ ‡ç­¾ï¼Œå…¨éƒ¨æ˜¯è‡ªå®šä¹‰æ ‡ç­¾ï¼Œç”¨äº†è¡¨ç¤ºä¸€äº›æ•°æ®</p>\n<h3 id=\"1.3-json\">1.3 json<a title=\"#1.3-json\" href=\"#1.3-json\"></a></h3>\n<p>ç°åœ¨ xml å·²ç»çš„ä¼ è¾“å’Œå­˜å‚¨æ•°æ®çš„åŠŸèƒ½å·²ç»è¢« json å–ä»£äº†</p>\n<h3 id=\"1.4-ajax-çš„ç‰¹ç‚¹\">1.4 ajax çš„ç‰¹ç‚¹<a title=\"#1.4-ajax-çš„ç‰¹ç‚¹\" href=\"#1.4-ajax-çš„ç‰¹ç‚¹\"></a></h3>\n<h4 id=\"1.4.1-ä¼˜ç‚¹\">1.4.1 ä¼˜ç‚¹<a title=\"#1.4.1-ä¼˜ç‚¹\" href=\"#1.4.1-ä¼˜ç‚¹\"></a></h4>\n<ol>\n<li>å¯ä»¥æ— éœ€åˆ·æ–°é¡µé¢ä¸æœåŠ¡ç«¯è¿›è¡Œé€šä¿¡</li>\n<li>å…è®¸æ ¹æ®ç”¨æˆ·äº‹ä»¶æ¥æ›´æ–°éƒ¨åˆ†é¡µé¢å†…å®¹</li>\n</ol>\n<h4 id=\"1.4.2-ç¼ºç‚¹\">1.4.2 ç¼ºç‚¹<a title=\"#1.4.2-ç¼ºç‚¹\" href=\"#1.4.2-ç¼ºç‚¹\"></a></h4>\n<ol>\n<li>æ²¡æœ‰æµè§ˆå†å²ï¼Œä¸èƒ½å›é€€</li>\n<li>å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼ˆåŒæºï¼‰</li>\n<li>seoï¼ˆçˆ¬è™«ï¼‰ ä¸å‹å¥½</li>\n</ol>\n<h2 id=\"2.-http-æŠ¥æ–‡\">2. http æŠ¥æ–‡<a title=\"#2.-http-æŠ¥æ–‡\" href=\"#2.-http-æŠ¥æ–‡\"></a></h2>\n<h3 id=\"2.1-http\">2.1 http<a title=\"#2.1-http\" href=\"#2.1-http\"></a></h3>\n<p>hypertext transport protocol è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œè¯¦ç»†è§„å®šäº†æµè§ˆå™¨å’Œä¸‡ç»´ç½‘æœåŠ¡å™¨ä¹‹é—´äº’ç›¸é€šä¿¡çš„è§„åˆ™</p>\n<h3 id=\"2.2-è¯·æ±‚æŠ¥æ–‡\">2.2 è¯·æ±‚æŠ¥æ–‡<a title=\"#2.2-è¯·æ±‚æŠ¥æ–‡\" href=\"#2.2-è¯·æ±‚æŠ¥æ–‡\"></a></h3>\n<blockquote>\n<p>é‡ç‚¹ï¼šæ ¼å¼ã€å‚æ•°</p>\n</blockquote>\n<ul>\n<li>\n<p>è¡Œ   : POST    /s?ie=utf-8   HTTP/1.1</p>\n</li>\n<li>\n<p>å¤´   : Host: â€¦</p>\n<p>â€‹         Cookie: name=â€¦</p>\n<p>â€‹         Content-type:application/x-www-form-urlencoded</p>\n<p>â€‹         User-Agent:chrome 83</p>\n</li>\n<li>\n<p>ç©ºè¡Œ :</p>\n</li>\n<li>\n<p>ä½“    : username=admin&amp;password=admin</p>\n</li>\n</ul>\n<h3 id=\"2.3-å“åº”æŠ¥æ–‡\">2.3 å“åº”æŠ¥æ–‡<a title=\"#2.3-å“åº”æŠ¥æ–‡\" href=\"#2.3-å“åº”æŠ¥æ–‡\"></a></h3>\n<ul>\n<li>\n<p>è¡Œ   : HTTP/1.1  200  OK</p>\n</li>\n<li>\n<p>å¤´   : Content-type: text/html;charset=utf-8</p>\n<p>â€‹         Content-length:2048</p>\n<p>â€‹         Content-encoding:gzip</p>\n</li>\n<li>\n<p>ç©ºè¡Œ :</p>\n</li>\n<li>\n<p>ä½“    : <code>&lt;html&gt;....&lt;/html&gt;</code></p>\n</li>\n</ul>\n<h3 id=\"2.4-network-ä¸Šçš„è¯·æ±‚å“åº”\">2.4 network ä¸Šçš„è¯·æ±‚å“åº”<a title=\"#2.4-network-ä¸Šçš„è¯·æ±‚å“åº”\" href=\"#2.4-network-ä¸Šçš„è¯·æ±‚å“åº”\"></a></h3>\n<ul>\n<li>Headersï¼šè¯·æ±‚å†…å®¹\n<ul>\n<li>General</li>\n<li>Response Headersï¼šå“åº”å¤´å’Œè¡Œ</li>\n<li>Requset Headersï¼šè¯·æ±‚å¤´å’Œè¡Œ</li>\n<li>Query String Parametersï¼šè¯·æ±‚ä½“\n<ul>\n<li>get ï¼š æŸ¥è¯¢å­—ç¬¦ä¸²çš„é”®å€¼å¯¹</li>\n<li>postï¼šæŸ¥è¯¢å­—ç¬¦ä¸²</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Previewï¼šé¢„è§ˆå“åº”è¿‡æ¥çš„html</li>\n<li>Responseï¼šå“åº”çš„å†…å®¹</li>\n</ul>\n<h2 id=\"3.-ajaxçš„ä½¿ç”¨\">3. ajaxçš„ä½¿ç”¨<a title=\"#3.-ajaxçš„ä½¿ç”¨\" href=\"#3.-ajaxçš„ä½¿ç”¨\"></a></h2>\n<h3 id=\"3.1-node-express-çš„ä½¿ç”¨\">3.1 node express çš„ä½¿ç”¨<a title=\"#3.1-node-express-çš„ä½¿ç”¨\" href=\"#3.1-node-express-çš„ä½¿ç”¨\"></a></h3>\n<p>ä½¿ç”¨node expressæ­å»ºæœåŠ¡å™¨</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> express <span class=\"keyword\">from</span> <span class=\"string\">&#x27;express&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"title function_\">express</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">get</span>(<span class=\"string\">&#x27;/&#x27;</span>, <span class=\"function\">(<span class=\"params\">request, response</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  response.<span class=\"title function_\">send</span>(<span class=\"string\">&#x27;hello express&#x27;</span>);</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">listen</span>(<span class=\"number\">8000</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;8000ç«¯å£ç›‘å¬...&quot;</span>);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.2-åŸç”Ÿajaxä½¿ç”¨\">3.2 åŸç”Ÿajaxä½¿ç”¨<a title=\"#3.2-åŸç”Ÿajaxä½¿ç”¨\" href=\"#3.2-åŸç”Ÿajaxä½¿ç”¨\"></a></h3>\n<ol>\n<li>\n<p>åˆ›å»ºå¯¹è±¡</p>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> xhr = <span class=\"keyword\">new</span> <span class=\"title class_\">XMLHttpRequest</span>();</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>åˆå§‹åŒ– è®¾ç½®è¯·æ±‚æ–¹æ³•å’Œurl</p>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhr.<span class=\"title function_\">open</span>(<span class=\"string\">&#x27;GET&#x27;</span>,<span class=\"string\">&#x27;http://127.0.0.1:8000/server&#x27;</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>å‘é€ è®¾ç½®å‚æ•°</p>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhr.<span class=\"title function_\">send</span>();</span><br><span class=\"line\">xhr.<span class=\"title function_\">send</span>(<span class=\"string\">&#x27;a=10&amp;b=20&#x27;</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>äº‹ä»¶ç»‘å®š å¤„ç†æœåŠ¡ç«¯è¿”å›çš„ç»“æœ</p>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhr.<span class=\"property\">onreadystatechange</span> = <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;...&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>å…¶ä¸­ readystate æ˜¯ xhr å¯¹è±¡çš„å±æ€§ï¼Œ<br>\nå…¶å€¼ä¸º 0:åˆå§‹çŠ¶æ€ 1:openå  2:sendå  3:è¿”å›éƒ¨åˆ†æ•°æ® 4:è¿”å›å…¨éƒ¨æ•°æ®</p>\n</blockquote>\n<blockquote>\n<p>å…¶ä¸­ xhrçš„å¯¹è±¡<br>\nstate:çŠ¶æ€ç  statusText:çŠ¶æ€å­—ç¬¦ä¸² getAllResponseHeader():æ‰€æœ‰å“åº”å¤´ response:å“åº”ä½“</p>\n</blockquote>\n</li>\n</ol>\n<ul>\n<li>\n<p>æœåŠ¡å™¨ç«¯è¦åšçš„æ“ä½œï¼šè§£å†³è·¨åŸŸé—®é¢˜</p>\n  <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">response.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class=\"string\">&#x27;*&#x27;</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>if è®¾ç½®è¯·æ±‚å¤´ :  åœ¨sendå‰</p>\n   <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhr.<span class=\"title function_\">setRequestHeader</span>(<span class=\"string\">&#x27;Content-Type&#x27;</span>,<span class=\"string\">&#x27;application/x-www-form-urlencoded&#x27;</span>)</span><br><span class=\"line\">xhr.<span class=\"title function_\">setRequestHeader</span>(<span class=\"string\">&#x27;name&#x27;</span>,<span class=\"string\">&#x27;lee&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>åˆ™ è¦åœ¨æœåŠ¡å™¨ç«¯ è®¾ç½®å…è®¸çš„å“åº”å¤´ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">response.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Access-Control-Allow-Headers&#x27;</span>,<span class=\"string\">&#x27;*&#x27;</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>if å¤„ç†åç«¯ä¼ çš„å­—ç¬¦ä¸²jsonæ•°æ®</p>\n<ul>\n<li>\n<p>æœåŠ¡å™¨</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> data = &#123; name : <span class=\"string\">&#x27;lee&#x27;</span> &#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> str = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(data);</span><br><span class=\"line\">response.<span class=\"title function_\">send</span>(str)</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>å‰ç«¯å¤„ç†<br>\næ‰‹åŠ¨è½¬æ¢æ•°æ®æ ¼å¼ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> data = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(xhr.<span class=\"property\">response</span>);</span><br><span class=\"line\">res.<span class=\"property\">value</span> = data.<span class=\"property\">name</span>;</span><br></pre></td></tr></table></figure>\n<p>è‡ªåŠ¨è½¬æ¢ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//åœ¨openå‰ è®¾ç½®å“åº”ä½“æ•°æ®çš„ç±»å‹</span></span><br><span class=\"line\">xhr.<span class=\"property\">responseType</span> = <span class=\"string\">&#x27;json&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">//åœ¨äº‹ä»¶é‡Œç›´æ¥ä½¿ç”¨å°±å¯ä»¥äº†</span></span><br><span class=\"line\">res.<span class=\"property\">value</span> = xhr.<span class=\"property\">response</span>.<span class=\"property\">name</span>;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li>\n<p>è§£å†³ieç¼“å­˜é—®é¢˜ï¼šåœ¨openä¸­åŠ æ—¶é—´æˆ³ ä¿è¯æ¯æ¬¡å‘ç”Ÿçš„è¯·æ±‚éƒ½ä¸ä¸€æ ·</p>\n  <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xhr.<span class=\"title function_\">open</span>(<span class=\"string\">&#x27;GET&#x27;</span>,<span class=\"string\">&#x27;http://127.0.0.1:8000/ie?t=&#x27;</span> + <span class=\"title class_\">Date</span>.<span class=\"title function_\">now</span>());</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>å¤„ç†è¯·æ±‚å¼‚å¸¸<br>\næœåŠ¡å™¨å¯ä»¥è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œä¸‰ç§’åæ‰è¿”å›å“åº”<br>\nåœ¨openå‰ï¼š</p>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//è¶…æ—¶è®¾ç½® </span></span><br><span class=\"line\">xhr.<span class=\"property\">timeout</span> = <span class=\"number\">2000</span>;</span><br><span class=\"line\"><span class=\"comment\">//è¶…æ—¶å›è°ƒ </span></span><br><span class=\"line\">xhr.<span class=\"property\">ontimeout</span> = <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123; <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;ç½‘ç»œå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•&#x27;</span>) &#125;</span><br><span class=\"line\"><span class=\"comment\">//ç½‘ç»œå¼‚å¸¸å›è°ƒ å¯ä»¥åœ¨f12 ä½¿ç”¨offline æµ‹è¯•</span></span><br><span class=\"line\">xhr.<span class=\"property\">onerror</span> = <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123; <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;ä½ çš„ç½‘ç»œä¼¼ä¹å‡ºç°äº†é—®é¢˜&#x27;</span>) &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>å–æ¶ˆå‘é€è¯·æ±‚äº‹ä»¶</p>\n  <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> x = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"comment\">//å‘é€è¯·æ±‚ x ä¸º å‰é¢çš„xhrå¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">//ä½¿ç”¨ x.abort() å¯ä»¥å–æ¶ˆå‘é€è¯·æ±‚</span></span><br><span class=\"line\"><span class=\"comment\">//åˆ©ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥å¤„ç† å¤šæ¬¡å‘é€è¯·æ±‚ åªä¿ç•™ä¸€ä¸ªè¯·æ±‚çš„æƒ…å†µ</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"3.2.1-åŸç”Ÿajaxæ¡ˆä¾‹-â€“-ç‚¹å‡»æŒ‰é’®-å°†å“åº”çš„æ•°æ®æ”¾åœ¨æ–‡æœ¬æ¡†é‡Œ\">3.2.1 åŸç”Ÿajaxæ¡ˆä¾‹ â€“ ç‚¹å‡»æŒ‰é’® å°†å“åº”çš„æ•°æ®æ”¾åœ¨æ–‡æœ¬æ¡†é‡Œ<a title=\"#3.2.1-åŸç”Ÿajaxæ¡ˆä¾‹-â€“-ç‚¹å‡»æŒ‰é’®-å°†å“åº”çš„æ•°æ®æ”¾åœ¨æ–‡æœ¬æ¡†é‡Œ\" href=\"#3.2.1-åŸç”Ÿajaxæ¡ˆä¾‹-â€“-ç‚¹å‡»æŒ‰é’®-å°†å“åº”çš„æ•°æ®æ”¾åœ¨æ–‡æœ¬æ¡†é‡Œ\"></a></h4>\n<h3 id=\"3.3-jquery-ä¸­çš„-ajax\">3.3 jquery ä¸­çš„ ajax<a title=\"#3.3-jquery-ä¸­çš„-ajax\" href=\"#3.3-jquery-ä¸­çš„-ajax\"></a></h3>\n<ol>\n<li>\n<p>get/postè¯·æ±‚<br>\n<code>$.get/post(url, dataè¯·æ±‚æºå¸¦çš„å‚æ•°, callbackæˆåŠŸæ—¶çš„å›è°ƒå‡½æ•°, typeè¿”å›æ•°æ®æ ¼å¼)  åé¢ä¸‰ä¸ªå‚æ•°å¯é€‰å¡«</code></p>\n  <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$.<span class=\"title function_\">get</span>(<span class=\"string\">&#x27;http://127.0.0.1:8000/jq-server&#x27;</span>, &#123;<span class=\"attr\">a</span>:<span class=\"number\">10</span>,<span class=\"attr\">b</span>:<span class=\"number\">20</span>&#125;, <span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123;</span><br><span class=\"line\">      <span class=\"title function_\">log</span>(data);</span><br><span class=\"line\">&#125;,<span class=\"string\">&#x27;json&#x27;</span>)</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>ajaxé€šç”¨è¯·æ±‚</p>\n  <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> $.<span class=\"title function_\">ajax</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">url</span>:<span class=\"string\">&#x27;http://127.0.0.1:8000/delay&#x27;</span>,   <span class=\"comment\">//url</span></span><br><span class=\"line\">      <span class=\"attr\">data</span>: &#123;<span class=\"attr\">a</span>:<span class=\"number\">10</span>,<span class=\"attr\">b</span>:<span class=\"number\">20</span>&#125;,       <span class=\"comment\">//å‚æ•°</span></span><br><span class=\"line\">      <span class=\"attr\">type</span>: <span class=\"string\">&#x27;GET&#x27;</span>,             <span class=\"comment\">//è¯·æ±‚ç±»å‹</span></span><br><span class=\"line\">      <span class=\"attr\">dataType</span>:<span class=\"string\">&#x27;json&#x27;</span>,         <span class=\"comment\">//å“åº”ä½“ç»“æœ</span></span><br><span class=\"line\">      <span class=\"attr\">success</span>:<span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123;  <span class=\"comment\">//æˆåŠŸå›è°ƒ</span></span><br><span class=\"line\">           <span class=\"title function_\">log</span>(data);</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">timeout</span>:<span class=\"number\">2000</span>,            <span class=\"comment\">//è¶…æ—¶å›è°ƒ</span></span><br><span class=\"line\">      <span class=\"attr\">error</span>:<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;...&#125;    <span class=\"comment\">//å¤±è´¥å›è°ƒ</span></span><br><span class=\"line\">     <span class=\"attr\">headers</span>:&#123;...&#125;            <span class=\"comment\">//è‡ªå®šä¹‰å¤´éƒ¨</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"3.4-axios\">3.4 axios<a title=\"#3.4-axios\" href=\"#3.4-axios\"></a></h3>\n<ol>\n<li>\n<p>å¯¼å…¥axiosåŠ è½½æ–‡ä»¶ bootcdn</p>\n</li>\n<li>\n<p>axioså¯ä»¥é…ç½® baseURL</p>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.<span class=\"property\">defaults</span>.<span class=\"property\">baseURL</span> = <span class=\"string\">&#x27;http://127.0.0.1:8000&#x27;</span>;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>axiosä½¿ç”¨ è¿”å›promiseå¯¹è±¡<br>\ngetè¯·æ±‚: axios.get(url [, config] )<br>\npostè¯·æ±‚: axios.post(url [, data [, config]] ) //ç¬¬äºŒä¸ªæ˜¯è¯·æ±‚ä½“å‚æ•°<br>\naxiosè¯·æ±‚: axios(config)</p>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> axios.<span class=\"title function_\">get</span>(<span class=\"string\">&#x27;/axios-server&#x27;</span>,&#123;</span><br><span class=\"line\">       <span class=\"attr\">params</span>:&#123;          <span class=\"comment\">//urlå‚æ•°</span></span><br><span class=\"line\">            <span class=\"attr\">id</span>:<span class=\"number\">100</span>,</span><br><span class=\"line\">            <span class=\"attr\">vip</span>:<span class=\"number\">7</span></span><br><span class=\"line\">       &#125;,</span><br><span class=\"line\">       <span class=\"attr\">headers</span>:&#123;         <span class=\"comment\">//è¯·æ±‚å¤´ä¿¡æ¯</span></span><br><span class=\"line\">            <span class=\"attr\">name</span>:<span class=\"string\">&#x27;lee&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">age</span>:<span class=\"string\">&#x27;20&#x27;</span></span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123; ... &#125; )</span><br></pre></td></tr></table></figure>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> axios.<span class=\"title function_\">post</span>(<span class=\"string\">&#x27;/axios-server&#x27;</span>,&#123; <span class=\"attr\">username</span>:<span class=\"string\">&#x27;admin&#x27;</span>, <span class=\"attr\">password</span>:<span class=\"string\">&#x27;admin&#x27;</span> &#125;,&#123;</span><br><span class=\"line\">       <span class=\"attr\">params</span>:&#123;          <span class=\"comment\">//urlå‚æ•°</span></span><br><span class=\"line\">            <span class=\"attr\">id</span>:<span class=\"number\">100</span>,</span><br><span class=\"line\">            <span class=\"attr\">vip</span>:<span class=\"number\">7</span></span><br><span class=\"line\">       &#125;,</span><br><span class=\"line\">       <span class=\"attr\">headers</span>:&#123;         <span class=\"comment\">//è¯·æ±‚å¤´ä¿¡æ¯</span></span><br><span class=\"line\">            <span class=\"attr\">name</span>:<span class=\"string\">&#x27;lee&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">age</span>:<span class=\"string\">&#x27;20&#x27;</span></span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123; ... &#125; )</span><br></pre></td></tr></table></figure>\n <figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">axios</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">method</span>:<span class=\"string\">&#x27;POST&#x27;</span>,              <span class=\"comment\">//è¯·æ±‚æ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"attr\">url</span>:<span class=\"string\">&#x27;/axios-server&#x27;</span>,        <span class=\"comment\">//url</span></span><br><span class=\"line\">    <span class=\"attr\">params</span>:&#123;<span class=\"attr\">id</span>:<span class=\"number\">100</span>, <span class=\"attr\">vip</span>:<span class=\"number\">7</span> &#125;,    <span class=\"comment\">//urlå‚æ•°</span></span><br><span class=\"line\">    <span class=\"attr\">headers</span>:&#123; a=<span class=\"number\">10</span>, b=<span class=\"number\">20</span> &#125;,     <span class=\"comment\">//å¤´ä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"attr\">data</span>:&#123; <span class=\"attr\">username</span>:<span class=\"string\">&#x27;admin&#x27;</span>, <span class=\"attr\">password</span>:<span class=\"string\">&#x27;admin&#x27;</span> &#125;,  <span class=\"comment\">//è¯·æ±‚ä½“å‚æ•°</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>( <span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123; <span class=\"title function_\">log</span>(res) &#125; )</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"3.5-fetch\">3.5 fetch<a title=\"#3.5-fetch\" href=\"#3.5-fetch\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">fetch</span>(<span class=\"string\">&#x27;http://127.0.0.1:8000/fecth-server?vip=10&#x27;</span>,&#123;</span><br><span class=\"line\">    <span class=\"attr\">method</span>:<span class=\"string\">&#x27;POST&#x27;</span>,                          <span class=\"comment\">//è¯·æ±‚æ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"attr\">headers</span>:&#123; <span class=\"attr\">name</span>:<span class=\"string\">&#x27;lee&#x27;</span> &#125;,                 <span class=\"comment\">//è¯·æ±‚å¤´</span></span><br><span class=\"line\">    <span class=\"attr\">body</span>:<span class=\"string\">&#x27;username=admin&amp;password=admin&#x27;</span>    <span class=\"comment\">//è¯·æ±‚ä½“</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res.<span class=\"title function_\">text</span>();  <span class=\"comment\">//å­—ç¬¦ä¸²</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res.<span class=\"title function_\">json</span>();  <span class=\"comment\">//json</span></span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"4.-è·¨åŸŸé—®é¢˜\">4. è·¨åŸŸé—®é¢˜<a title=\"#4.-è·¨åŸŸé—®é¢˜\" href=\"#4.-è·¨åŸŸé—®é¢˜\"></a></h2>\n<h3 id=\"4.1åŒæºç­–ç•¥\">4.1åŒæºç­–ç•¥<a title=\"#4.1åŒæºç­–ç•¥\" href=\"#4.1åŒæºç­–ç•¥\"></a></h3>\n<p>æµè§ˆå™¨çš„ä¸€ç§å®‰å…¨ç­–ç•¥</p>\n<p>åŒæºï¼šåè®®ã€åŸŸåã€ç«¯å£å·å®Œå…¨ç›¸åŒ</p>\n<p>è¿èƒŒåŒæºç­–ç•¥å°±æ˜¯è·¨åŸŸ</p>\n<h3 id=\"4.2-åŒæºçš„ä¸€ä¸ªä¾‹å­\">4.2 åŒæºçš„ä¸€ä¸ªä¾‹å­<a title=\"#4.2-åŒæºçš„ä¸€ä¸ªä¾‹å­\" href=\"#4.2-åŒæºçš„ä¸€ä¸ªä¾‹å­\"></a></h3>\n<p>htmlé¡µé¢è·Ÿ å‘é€è¯·æ±‚æ—¶åŒä¸€ä¸ªåœ°å€</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//server.js</span></span><br><span class=\"line\">...</span><br><span class=\"line\">app.<span class=\"title function_\">get</span>(<span class=\"string\">&#x27;/home&#x27;</span>,<span class=\"function\">(<span class=\"params\">req,res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    res.<span class=\"title function_\">sendFile</span>(__dirname + <span class=\"string\">&#x27;/index.html&#x27;</span>);  <span class=\"comment\">//å“åº”ä¸€ä¸ªé¡µé¢</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">get</span>(<span class=\"string\">&#x27;/data&#x27;</span>,<span class=\"function\">(<span class=\"params\">req,res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    res.<span class=\"title function_\">send</span>(<span class=\"string\">&#x27;ç”¨æˆ·æ•°æ®&#x27;</span>);   <span class=\"comment\">//è¯·æ±‚æ•°æ®</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//index.html</span></span><br><span class=\"line\">...</span><br><span class=\"line\">btn.<span class=\"property\">onlick</span> = <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> xhr = <span class=\"keyword\">new</span> <span class=\"title class_\">XMLHttpRequest</span>();</span><br><span class=\"line\">    <span class=\"comment\">// å› ä¸ºæ˜¯åŒæºçš„ æ‰€ä»¥url å¯ä»¥ç®€å†™</span></span><br><span class=\"line\">    xhr.<span class=\"title function_\">open</span>(<span class=\"string\">&#x27;GET&#x27;</span>,<span class=\"string\">&#x27;/data&#x27;</span>);</span><br><span class=\"line\">    xhr.<span class=\"title function_\">send</span>();</span><br><span class=\"line\">    xhr.<span class=\"property\">onreadystatechange</span> = <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4.3-jsonp-åŸç†\">4.3 jsonp åŸç†<a title=\"#4.3-jsonp-åŸç†\" href=\"#4.3-jsonp-åŸç†\"></a></h3>\n<p>ä¸»è¦å°±æ˜¯åˆ©ç”¨äº† <code>script</code> æ ‡ç­¾çš„<code>src</code>æ²¡æœ‰è·¨åŸŸé™åˆ¶æ¥å®Œæˆçš„</p>\n<p>ç¼ºç‚¹ï¼š</p>\n<ul>\n<li>åªèƒ½è¿›è¡Œ<code>GET</code>è¯·æ±‚</li>\n</ul>\n<p>ä¼˜ç‚¹ï¼š</p>\n<ul>\n<li>å…¼å®¹æ€§å¥½ï¼Œåœ¨ä¸€äº›å¤è€çš„æµè§ˆå™¨ä¸­éƒ½å¯ä»¥è¿è¡Œ</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//server.js</span></span><br><span class=\"line\">app.<span class=\"title function_\">all</span>(<span class=\"string\">&#x27;/jsonp&#x27;</span>, <span class=\"function\">(<span class=\"params\">req, res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// res.send(&#x27;console.log(hello jsonp)&#x27;)</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> data = &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;lee&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  res.<span class=\"title function_\">end</span>(<span class=\"string\">`handle(<span class=\"subst\">$&#123;<span class=\"built_in\">JSON</span>.stringify(data)&#125;</span>)`</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//html</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">function</span> <span class=\"title function_\">handle</span>(<span class=\"params\">data</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"keyword\">const</span> res = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;div&#x27;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">      res.<span class=\"property\">innerHTML</span> = data.<span class=\"property\">name</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;http://127.0.0.1:8000/jsonp&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"4.4-jsonp-å®è·µ\">4.4 jsonp å®è·µ<a title=\"#4.4-jsonp-å®è·µ\" href=\"#4.4-jsonp-å®è·µ\"></a></h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//server</span></span><br><span class=\"line\">app.<span class=\"title function_\">all</span>(<span class=\"string\">&#x27;/jsonp-exe&#x27;</span>, <span class=\"function\">(<span class=\"params\">req, res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// res.send(&#x27;console.log(hello jsonp)&#x27;)</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> data = &#123;</span><br><span class=\"line\">    <span class=\"attr\">exist</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">mes</span>: <span class=\"string\">&#x27;ç”¨æˆ·åå­˜åœ¨&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  res.<span class=\"title function_\">end</span>(<span class=\"string\">`handle(<span class=\"subst\">$&#123;<span class=\"built_in\">JSON</span>.stringify(data)&#125;</span>)`</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">const</span> p = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;p&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">const</span> input = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;input&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">function</span> <span class=\"title function_\">handle</span>(<span class=\"params\">data</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    input.<span class=\"property\">style</span>.<span class=\"property\">border</span> = <span class=\"string\">&#x27;1px solid red&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    p.<span class=\"property\">innerHTML</span> = data.<span class=\"property\">mes</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  input.<span class=\"property\">onblur</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// è·å–ç”¨æˆ·çš„è¾“å…¥</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">let</span> username = <span class=\"variable language_\">this</span>.<span class=\"property\">value</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ æ£€æµ‹ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// 1.åˆ›å»ºscript</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;script&#x27;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// 2.è®¾ç½®æ ‡ç­¾ src</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    script.<span class=\"property\">src</span> = <span class=\"string\">&#x27;http://127.0.0.1:8000/jsonp-exe&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// 3.æ’å…¥åˆ°dom</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"title function_\">appendChild</span>(script);</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"4.5-jq-jsonp\">4.5 jq-jsonp<a title=\"#4.5-jq-jsonp\" href=\"#4.5-jq-jsonp\"></a></h3>\n<h3 id=\"4.6-cors\">4.6 cors<a title=\"#4.6-cors\" href=\"#4.6-cors\"></a></h3>\n<img src=\"https://s1.328888.xyz/2022/04/09/X3BLX.jpg\">\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//server</span></span><br><span class=\"line\">app.<span class=\"title function_\">all</span>(<span class=\"string\">&#x27;/cors&#x27;</span>, <span class=\"function\">(<span class=\"params\">req, res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 1.è®¾ç½®å“åº”å¤´ï¼Œå…è®¸è·¨åŸŸ</span></span><br><span class=\"line\">  res.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class=\"string\">&#x27;*&#x27;</span>);</span><br><span class=\"line\">  <span class=\"comment\">// 2.è®¾ç½®å“åº”å¤´</span></span><br><span class=\"line\">  res.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class=\"string\">&#x27;*&#x27;</span>);</span><br><span class=\"line\">  res.<span class=\"title function_\">setHeader</span>(<span class=\"string\">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class=\"string\">&#x27;*&#x27;</span>);</span><br><span class=\"line\">  <span class=\"comment\">// 3.å“åº”ä½“</span></span><br><span class=\"line\">  res.<span class=\"title function_\">send</span>(<span class=\"string\">&#x27;hello cors&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">const</span> btn = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;button&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">const</span> text = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;textarea&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  btn.<span class=\"property\">onclick</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> xhr = <span class=\"keyword\">new</span> <span class=\"title class_\">XMLHttpRequest</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    xhr.<span class=\"title function_\">open</span>(<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;http://127.0.0.1:8000/cors&#x27;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    xhr.<span class=\"title function_\">send</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    xhr.<span class=\"property\">onreadystatechange</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"keyword\">if</span> (xhr.<span class=\"property\">readyState</span> === <span class=\"number\">4</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        text.<span class=\"property\">value</span> = xhr.<span class=\"property\">response</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">      &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n","prev":{"title":"webpack å­¦ä¹ ç¬”è®°","link":"learningNotes/webpack"},"next":{"title":"nodejs å­¦ä¹ ç¬”è®°","link":"learningNotes/js/nodejs"},"plink":"https://shylees.github.io/learningNotes/ajax/","toc":[{"id":"1.ç®€ä»‹","title":"1.ç®€ä»‹","index":"1","children":[{"id":"1.1-ajax","title":"1.1 ajax","index":"1.1"},{"id":"1.2-xml","title":"1.2 xml","index":"1.2"},{"id":"1.3-json","title":"1.3 json","index":"1.3"},{"id":"1.4-ajax-çš„ç‰¹ç‚¹","title":"1.4 ajax çš„ç‰¹ç‚¹","index":"1.4"}]},{"id":"2.-http-æŠ¥æ–‡","title":"2. http æŠ¥æ–‡","index":"2","children":[{"id":"2.1-http","title":"2.1 http","index":"2.1"},{"id":"2.2-è¯·æ±‚æŠ¥æ–‡","title":"2.2 è¯·æ±‚æŠ¥æ–‡","index":"2.2"},{"id":"2.3-å“åº”æŠ¥æ–‡","title":"2.3 å“åº”æŠ¥æ–‡","index":"2.3"},{"id":"2.4-network-ä¸Šçš„è¯·æ±‚å“åº”","title":"2.4 network ä¸Šçš„è¯·æ±‚å“åº”","index":"2.4"}]},{"id":"3.-ajaxçš„ä½¿ç”¨","title":"3. ajaxçš„ä½¿ç”¨","index":"3","children":[{"id":"3.1-node-express-çš„ä½¿ç”¨","title":"3.1 node express çš„ä½¿ç”¨","index":"3.1"},{"id":"3.2-åŸç”Ÿajaxä½¿ç”¨","title":"3.2 åŸç”Ÿajaxä½¿ç”¨","index":"3.2"},{"id":"3.3-jquery-ä¸­çš„-ajax","title":"3.3 jquery ä¸­çš„ ajax","index":"3.3"},{"id":"3.4-axios","title":"3.4 axios","index":"3.4"},{"id":"3.5-fetch","title":"3.5 fetch","index":"3.5"}]},{"id":"4.-è·¨åŸŸé—®é¢˜","title":"4. è·¨åŸŸé—®é¢˜","index":"4","children":[{"id":"4.1åŒæºç­–ç•¥","title":"4.1åŒæºç­–ç•¥","index":"4.1"},{"id":"4.2-åŒæºçš„ä¸€ä¸ªä¾‹å­","title":"4.2 åŒæºçš„ä¸€ä¸ªä¾‹å­","index":"4.2"},{"id":"4.3-jsonp-åŸç†","title":"4.3 jsonp åŸç†","index":"4.3"},{"id":"4.4-jsonp-å®è·µ","title":"4.4 jsonp å®è·µ","index":"4.4"},{"id":"4.5-jq-jsonp","title":"4.5 jq-jsonp","index":"4.5"},{"id":"4.6-cors","title":"4.6 cors","index":"4.6"}]}],"copyright":{"custom":"ä¸è®¸è½¬è½½ğŸ˜¡ï¼ï¼ï¼"},"reading_time":"1949 words in 10 min"}