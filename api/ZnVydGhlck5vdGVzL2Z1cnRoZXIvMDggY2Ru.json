{"title":"CDN内容分发网络","date":"2021-11-16T16:00:00.000Z","date_formatted":{"ll":"Nov 17, 2021","L":"11/17/2021","MM-DD":"11-17"},"link":"furtherNotes/further/08 cdn","tags":["前端安全"],"categories":["furtherNotes"],"updated":"2021-12-16T16:00:00.000Z","content":"<blockquote>\n<p>由前端安全引申出的 cdn 的知识</p>\n<p><a href=\"https://juejin.cn/post/6913704568325046279\" target=\"_blank\">cdn</a></p>\n</blockquote>\n<h4 id=\"4.1-简介\">4.1 简介<a title=\"#4.1-简介\" href=\"#4.1-简介\"></a></h4>\n<p>CDN ( Content Delivery Network )，内容分发网络（跟菜鸟的仓配网络一样）。</p>\n<ul>\n<li>\n<p><strong>主要思路：</strong> 尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。</p>\n</li>\n<li>\n<p><strong>实现方法：</strong> 通过在网络各处放置<strong>节点服务器</strong>所构成的在现有的互联网基础之上的一层<strong>智能虚拟网络</strong>，CDN系统能够实时地根据网络流量和各节点的<strong>连接和负载</strong>状况以及到用户的<strong>距离</strong>和<strong>响应时间</strong>等综合信息将用户的请求重新<strong>导向离用户最近的服务节点</strong>上，加快访问速度。</p>\n</li>\n<li>\n<p><strong>目的：</strong> 使用户可<strong>就近</strong>取得所需内容，解决Internet网络拥挤的状况，提高用户访问网站的<strong>响应速度</strong>。</p>\n</li>\n<li>\n<p><strong>优势：</strong></p>\n<ol>\n<li>CDN节点解决了跨运营商和跨地域访问的问题，访问延时大大降低；</li>\n<li>大部分请求在CDN边缘节点完成，CDN起到了分流作用，减轻了源站的负载。</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"4.2-组成\">4.2 组成<a title=\"#4.2-组成\" href=\"#4.2-组成\"></a></h4>\n<p>内容分发网络（CDN）是由多个节点组成的。一般来讲，CDN网络主要由<strong>中心节点</strong>、<strong>边缘节点</strong>两部分构成。</p>\n<h5 id=\"4.2.1-中心节点\">4.2.1 中心节点<a title=\"#4.2.1-中心节点\" href=\"#4.2.1-中心节点\"></a></h5>\n<p>中心节点包括CDN网管中心和全局负载均衡DNS重定向解析系统，负责整个CDN网络的分发及管理</p>\n<h5 id=\"4.2.2-边缘节点\">4.2.2 边缘节点<a title=\"#4.2.2-边缘节点\" href=\"#4.2.2-边缘节点\"></a></h5>\n<p>CDN边缘节点主要指异地分发节点，由<strong>负载均衡设备、高速缓存服务器</strong>两部分组成。</p>\n<p><strong>负载均衡设备</strong>负责每个节点中各个Cache的负载均衡，保证节点的工作效率；同时还负责收集节点与周围环境的信息，保持与全局负载均衡DNS的通信，实现整个系统的负载均衡。</p>\n<p><strong>高速缓存服务器</strong>（Cache）负责存储客户网站的大量信息，就像一个靠近用户的网站服务器一样响应本地用户的访问请求。通过全局负载均衡DNS的控制，用户的请求被透明地指向离他最近的节点，节点中Cache服务器就像网站的原始服务器一样，响应终端用户的请求。因其距离用户更近，故其响应时间才更快。</p>\n<p><strong>中心节点就像仓配网络中负责货物调配的总仓，而边缘节点就是负责存储货物的各个城市的本地仓库。</strong></p>\n<h4 id=\"4.3-基本工作流程\">4.3 基本工作流程<a title=\"#4.3-基本工作流程\" href=\"#4.3-基本工作流程\"></a></h4>\n<h5 id=\"4.3.1-传统方式\">4.3.1 传统方式<a title=\"#4.3.1-传统方式\" href=\"#4.3.1-传统方式\"></a></h5>\n<ol>\n<li>用户在自己的浏览器中输入要访问的网站域名。</li>\n<li>浏览器向 本地DNS服务器 请求对该域名的解析。</li>\n<li>本地DNS服务器中如果缓存有这个域名的解析结果，则直接响应用户的解析请求。</li>\n<li>本地DNS服务器中如果没有关于这个域名的解析结果的缓存，则以递归方式向整个DNS系统请求解析，获得应答后将结果反馈给浏览器。</li>\n<li>浏览器得到域名解析结果，就是该域名相应的服务设备的 IP地址 。</li>\n<li>浏览器向服务器请求内容。</li>\n<li>服务器将用户请求内容传送给浏览器。</li>\n</ol>\n<p>当<strong>使用了CDN</strong>时，DNS 服务器根据用户 IP 地址，将域名解析成相应节点的缓存服务器IP地址，实现用户就近访问。使用 CDN 服务的网站，只需将其域名解析权交给 CDN 的全局负载均衡（GSLB）设备，将需要分发的内容注入 CDN，就可以实现内容加速了。</p>\n<h5 id=\"4.3.2-cdn\">4.3.2 CDN<a title=\"#4.3.2-cdn\" href=\"#4.3.2-cdn\"></a></h5>\n<ol>\n<li>当用户点击网址页面上的内容 URL，经过<strong>本地 DNS</strong> 系统解析，DNS 系统会最终将域名的解析权交给 <strong>CNAME</strong> 指向的 CDN 专用 DNS 服务器。</li>\n<li>CDN 的 DNS 服务器将 CDN 的<strong>全局负载均衡设备</strong> IP 地址返回用户</li>\n<li>用户向 CDN 的全局负载均衡设备发起内容 URL 访问请求</li>\n<li>CDN 全局负载均衡设备根据用户 IP 地址，以及用户请求的内容 URL，选择一台<strong>用户所属区域的区域负载均衡设备</strong>，告诉用户向这太设备发起请求</li>\n<li>基于以下这些条件的综合分析之后，区域负载均衡设备会<strong>向全局负载均衡设备返回</strong>一台缓存服务器的 IP 地址：\n<ul>\n<li>根据用户 IP 地址，判断哪一台服务器距用户最近；</li>\n<li>根据用户所请求的 URL 中携带的内容名称，判断哪一台服务器上有用户所需内容</li>\n<li>查询各个服务器当前的负载请求，判断哪一台服务器尚有服务能能力</li>\n</ul>\n</li>\n<li>全局负载均衡设备把服务器 IP 地址返回给用户</li>\n<li>用户向<strong>缓存服务器</strong>发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域均衡设备依然将它分配给了用户，那么这服务器就要向他的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地。</li>\n</ol>\n<h4 id=\"4.4-作用\">4.4 作用<a title=\"#4.4-作用\" href=\"#4.4-作用\"></a></h4>\n<p>CDN 最常用的功能是<strong>加速</strong></p>\n<ol>\n<li>\n<p><strong>加速访问</strong></p>\n</li>\n<li>\n<p><strong>实现跨运营商、跨地域的全网覆盖</strong></p>\n</li>\n<li>\n<p><strong>保障网络安全</strong></p>\n<blockquote>\n<p>CDN的负载均衡和分布式存储技术，可以加强网站的可靠性，相当无无形中给你的网站添加了一把保护伞，应对绝大部分的互联网攻击事件。防攻击系统也能避免网站遭到恶意攻击。</p>\n</blockquote>\n</li>\n<li>\n<p><strong>异地备援</strong></p>\n</li>\n<li>\n<p><strong>节约成本</strong></p>\n<blockquote>\n<p>能克服<strong>网站分布不均</strong>的问题，投入使用CDN加速可以实现网站的全国铺设，你根据不用考虑购买服务器与后续的托管运维，服务器之间镜像同步，也不用为了管理维护技术人员而烦恼，并且能降低网站自身建设和维护成本。</p>\n</blockquote>\n</li>\n<li>\n<p><strong>让你更专注业务本身</strong></p>\n<blockquote>\n<p>CDN加速厂商一般都会提供一站式服务，业务不仅限于CDN，还有配套的云存储、大数据服务、视频云服务等，而且一般会提供7x24运维监控支持，保证网络随时畅通，你可以放心使用。并且将更多的精力投入到发展自身的核心业务之上。</p>\n</blockquote>\n</li>\n</ol>\n<h4 id=\"4.5-工作原理\">4.5 工作原理<a title=\"#4.5-工作原理\" href=\"#4.5-工作原理\"></a></h4>\n<p>基本原理是广泛采用各种缓存服务器，将这些缓存服务器分布到用户访问相对集中的地区或网络中，在用户访问网站时，利用全局负载技术将用户的访问指向距离最近的工作正常的缓存服务器上，由缓存服务器直接响应用户请求。</p>\n<h5 id=\"4.5.1-用户访问cdn资源的过程\">4.5.1 用户访问cdn资源的过程<a title=\"#4.5.1-用户访问cdn资源的过程\" href=\"#4.5.1-用户访问cdn资源的过程\"></a></h5>\n<ol>\n<li>用户向浏览器输入www.web.com这个域名，浏览器第一次发现本地没有DNS缓存，则向网站的DNS服务器请求；</li>\n<li>网站的DNS域名解析器设置了CNAME，<a href=\"http://xn--www-0h9dk7wt9x.web.51cdn.com\">指向了www.web.51cdn.com</a>,请求指向了CDN网络中的智能DNS负载均衡系统；</li>\n<li>智能DNS负载均衡系统解析域名，把对用户响应速度最快的IP节点（CDN服务器）返回给用户；</li>\n<li>用户向该IP节点（CDN服务器）发出请求；</li>\n<li>由于是第一次访问，CDN服务器会向原web站点请求，并缓存内容；</li>\n<li>请求结果发给用户。</li>\n</ol>\n<h5 id=\"4.5.2-cdn主要特点\">4.5.2 cdn主要特点<a title=\"#4.5.2-cdn主要特点\" href=\"#4.5.2-cdn主要特点\"></a></h5>\n<ol>\n<li><strong>本地Cache加速</strong> 提高了企业站点（尤其含有大量图片和静态页面站点）的访问速度，并大大提高以上性质站点的稳定性</li>\n<li><strong>镜像服务</strong> 消除了不同运营商之间互联的瓶颈造成的影响，实现了跨运营商的网络加速，保证不同网络中的用户都能得到良好的访问质量。</li>\n<li><strong>远程加速</strong> 远程访问用户根据DNS负载均衡技术智能自动选择Cache服务器，选择最快的Cache服务器，加快远程访问的速度</li>\n<li><strong>带宽优化</strong> 自动生成服务器的远程Mirror（镜像）cache服务器，远程用户访问时从cache服务器上读取数据，减少远程访问的带宽、分担网络流量、减轻原站点WEB服务器负载等功能。</li>\n<li><strong>集群抗攻击</strong> 广泛分布的CDN节点加上节点之间的智能冗余机制，可以有效地预防黑客入侵以及降低各种D.D.o.S攻击对网站的影响，同时保证较好的服务质量 。</li>\n</ol>\n<h4 id=\"4.6-对网络的优化\">4.6 对网络的优化<a title=\"#4.6-对网络的优化\" href=\"#4.6-对网络的优化\"></a></h4>\n<ol>\n<li>解决服务器端的 “ 第一公里 ”问题</li>\n<li>缓解甚至消除了不同运营商之间互联的瓶颈造成的影响</li>\n<li>减轻了各省的出口带宽压力</li>\n<li>缓解了骨干网的压力</li>\n<li>优化了网上热点内容的分布</li>\n</ol>\n<p>**第一公里：**指万维网流量向用户传送的第一个出口，是网站服务器接入互联网的链路所能提供的带宽。这个带宽决定了一个网站能为用户提供的访问速度和并发访问量。如果业务繁忙，用户的访问数越多，拥塞越严重，网站会在最需要向用户提供服务时失去用户。</p>\n<p>**中间一公里：**代表互联网中节点与节点之间的传输网络</p>\n<p>**最后一公里：**万维网流量向用户传送的最后一段接入链路</p>\n<h4 id=\"4.7-应用场景\">4.7 应用场景<a title=\"#4.7-应用场景\" href=\"#4.7-应用场景\"></a></h4>\n<ol>\n<li>网站站点 / 应用加速</li>\n<li>视音频点播 / 大文件下载分发加速</li>\n<li>视频直播加速</li>\n<li>移动应用加速</li>\n</ol>\n","prev":{"title":"回调地狱及其解决方案","link":"furtherNotes/further/03 回调地狱解决"},"next":{"title":"节流throttle、防抖debounce","link":"furtherNotes/further/06 this指向 call bind apply"},"plink":"https://shylees.github.io/furtherNotes/further/08 cdn/","copyright":{"custom":"不许转载😡！！！"},"reading_time":"2568 words in 13 min"}