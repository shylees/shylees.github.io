---
title: 红宝书 - 第1章 什么是JavaScript
date: 2021/1/24
updated: 2021/1/25
comments:
tags:
 - js
categories:
 - readNotes
layout:
permalink:
meta: true
---


## 1.1 简短的历史回顾

* <font color='blue'>初想法——</font>1995年，网景公司的Brendan Eich的工程师，开始为即将发布的Netscape Navigator2开发一个叫`Mocha`(后来改名为`LiveScript`)的脚本语言，当时计划在客户端和服务器端都使用它，在服务端叫`LiveWire`.

* <font color='blue'>发布1.0——</font>为赶上发布时间，网景与Sun结为开发联盟，共同完成`LiveScript`的开发，在Netscape Navigator2正式发布前，网景把`LiveScript` 改名为`JavaScript`(搭上媒体当时炒作Java的顺风车)

* <font color='blue'>发布1.1、竞争——</font>`JavaScript1.0`很成功，网景又在Netscape Navigator3发布了1.1版本，不久后微软发布了IE3，其中包含自己名为`JScript`的`JavaScript`实现

  > 意味着出现了两个版本的`JavaScript`：Netscape Navigator中的`JavaScript`、IE中的`JScript`

* <font color='blue'>打造标准->es——</font>1997年，`JavaScript`作为提案被提交给欧洲计算机制造商协会(Ecma)。第39技术委员会(TC39)承担了“标准化一门通用、跨平台、厂商中立的脚本语言的语法和语义”的任务(参见`TC39-ECMAScript`)。

  > TC39委员会由来自网景、Sun、微软、Borland、Nombas和其他对这门脚本语言有兴趣的公司的工程师组成。

  他们花了数月打造出ECMA-262，也就是<font color='red'>`ECMAScript`</font>这个新的脚本语言标准。

* <font color='blue'>使用es标准——</font>1998年，国际标准化组织（ISO）和国际电工委员会（IEC）也将`ECMScript`采纳为标准（ISO/IEC-16262），自此以后，各家浏览器均以`ECMAScript`作为自己`JavaScript`实现的依据，虽然具体实现各有不同。

## 1.2 JavaScript实现

> 虽然`JavaScript`和`ECMAScript`基本上是同义词，但`JavaScript`远远不限于`ECMA-262`所定义的那样

完整的`JavaScript`实现包括：

1. <font color='red'>核心（ECMAScript）</font>
2. <font color='red'>文档对象模型（DOM）</font>
3. <font color='red'>浏览器对象模型（BOM）</font>

### 1.2.1 ECMAScript

**定义：**`ECMAScript`，即`ECMA-262`定义的语言，并不局限Web浏览器。

> * 这门语言没有输入输出之类的方法。
>
> * `ECMA-262`将这门语言作为一个基准来定义，以便在它之上再构建更稳健的脚本语言。
> * Web浏览器只是`ECMAScript`实现可能存在的一种**宿主环境**
> * 宿主环境提供`ECMAScript`的基准实现和与环境自身交互必需的扩展
> * 扩展（比如DOM）使用`ECMAScript`核心类型和语法，提供特定的于环境的额外功能。
> * 其他宿主环境还有服务器端JavaScript平台Node.js和即将被淘汰的Adobe Flash

不涉及浏览器的话，ECMA-262的定义:(在基本的层面，它描述这门语言的部分：)

* 语法
* 类型
* 语句
* 关键字
* 保留字
* 操作符
* 全局对象

`ECMAScript`只是对实现这个规范描述的所有方面的一门语言的称呼。

#### 1.ECMAScript版本

ECMAScript不同的版本以‘edition’表示（也就是描述特定实现的ECMA-262的版本），最近的版本是第10版，发布于2019年06月。

1. ECMA-262第1版：本质上与网景的JavaScript1.1相同，只不过删除了所有浏览器特定的代码，外加少量细微的修改

   > ECMA-262要求支持Unicode标准，以支持多语言，而且对象要与平台无关。但Netscape JavaScript1.1的对象不是这样的，比如Date对象就依赖平台。这也是JavaScript1.1和JavaScript1.2不符合ECMA-262第1版的原因

2. ECMA-262第2版：做了一些编校工作，主要是为了更新之后严格符合ISO/IEC-16262的要求，并没有增减或改变任何特性 

   > ECMAScript实现通常不使用第2版来衡量符合性

3. ECMA-262第3版：第一次真正对这个标准进行更新，更新了字符串处理、错误定义和数值输出，还增加了对正则表达式、新的控制语句、try/catch异常处理的支持，以及为了更好地让国际化所做的少量修改

4. ECMA-262第4版：是对这门语言的一次彻底修订。Ecma39再次被召集起来，几乎在第3版的基础上完全定义了一门新语言。包括强类型变量、新语句、数据结构、真正的类、经典的继承、操作数据的新手段。因为跳跃太大，所以在正式发布前就被放弃了

5. ECMA-262第5版：Ecma39在研究第4版的同时也提出了‘ECMAScript3.1’，只对这门语言进行较少的改进，只要在现有JavaScript引擎基础上做一些增改就可以实现，最终ES3.1变成了ECMA-262的第5版，其致力于厘清第3版存在的歧义，也增加了新功能。包括**原生的解析**和**序列化JOSN数据的json对象**、**方便继承和高级属性定义的方法**、**新的增强ECMAScript引擎解释**和**执行代码能力的严格模式**

6. ECMA-262第6版：ES6、ES2015、ES Harmony（和谐版），于2015年6月发布。这一版包含了大概这个规范有史以来最重要的一批增强特性。ES6正式支持了**类**、**模块**、**迭代器**、**生成器**、**箭头函数**、**期约**、**反射**、**代理**和**众多新的数据类型**。

7. ECMA-262第7版：ES7、ES2016，于2016年6月发布，这次修订只包含少量语法层面的增强，如**Array.proptotype.includes**和**指数操作符****.

8. ECMA-262第8版：ES8、ES2017，完成于2017年6月，这一版主要增加了**异步函数**(async/await)、**SharedArrayBuffer**及**Atomics API**，以及Objec**t.values() / Object.entries() / Object.getOwnPropertyDescriptors()** 和**字符串填充方法**，另外明确**支持对象字面量最后的逗号**。

9. ECMA-262第9版：ES9、ES2018，发布于2018年6月，这次修订包括**异步迭代**、**剩余和扩展属性**、**一组新的正则表达式特性**、**Promise finally()**，以及**模板字面量修改**。

10. ECMA-262第10版：ES10、ES2019，发布于2019年6月，这次修订增加了**Array.prototype.flat() / flatMap()** 、 **String.prototype.trimStart() / trimEnd()** **、Object.fromEntries() 方法**，以及**Symbol.prototype.description属性**，**明确定义了Function.prototype.toString() 的返回值值并固定了Array.prototype.sort() 的顺序**。解决了**JSON字符串兼容的问题**，并**定义了catch子句的可选绑定**。

#### 2.ECMAScript符合性是什么意思

ECMA-262阐述了什么是ECMAScript符合性，要成为ECMAScript实现，必须满足：

1. 支持ECMA-262中描述的所有“类型、值、对象、属性、函数，以及程序语法与语义”；
2. 支持Unicode字符标准

此外，符合性实现还可以满足下列要求：

1. 增加ECMA-262中未提及的“额外的类型、值、对象、属性和函数”。ECMA-262所说的这些额外内容主要指规范中未给出的新对象或对象的新属性
2. 支持ECMA-262中，没有定义的“程序和正则表达式语法”(允许修改和扩展内置的正则表达式特性)

#### 3. 浏览器对ECMAScript的支持

| 浏览器                        | ECMAScript符合性 |
| ----------------------------- | ---------------- |
| Netscape Navigator2           | —                |
| Netscape Navigator3           | —                |
| Netscape Navigator4~4.05      | —                |
| Netscape Navigator4.06~4.79   | 第1版            |
| Netscape 6+（Mozilla 0.6.0+） | 第3版            |
| IE3~4                         | —                |
| IE5                           | 第1版            |
| IE5.5~8                       | 第3版            |
| IE9                           | 第5版（部分）    |
| IE10~11                       | 第5版            |
| Edge12+                       | 第6版            |
| Opera6~7.1                    | 2                |
| Opera7.2+                     | 3                |
| Opera15~28                    | 5                |
| Opera29~35                    | 6（部分）        |
| Opera36+                      | 6                |
| Safari1~2.0.x                 | 第3版（部分）    |
| Safari3.1~5.1                 | 第5版（部分）    |
| Safari6~8                     | 第5版            |
| Safari9+                      | 第6版            |
| iOS Safari3.2~5.1             | 5（部分）        |
| iOS Safari6~8.4               | 5                |
| iOS Safari9.2+                | 6                |
| Chrome1~3                     | 第3版            |
| Chrome4~22                    | 第5版（部分）    |
| Chrome23+                     | 第5版            |
| Chrome42~48                   | 第6版（部分）    |
| Chrome79+                     | 第6版            |
| Firefox1~2                    | 3                |
| Firefox3.0.x~20               | 5（部分）        |
| Firefox21~44                  | 5                |
| Firefox45+                    | 6                |



### 1.2.2 DOM

**文档对象模型**（DOM，Document Object Model）是一个应用程序接口（API），用于在HTML中使用扩展的XML。DOM将整个页面抽象为一组分层节点。HTML或XML页面的每个组成部分都是一种节点，包含不同的数据。

> DOM通过创建表示文档的树，让开发者可以随心所欲地控制网页的内容和结构。使用DOM API，可以轻松的删除、添加、替换、修改节点。

#### 1.为什么DOM是必需的

在IE4和Netscape Navigator4支持不同形式的动态HTML（DHTML）的情况下，开发者首先可以做到不刷新页面而修改页面外观和内容。为了保持Web跨平台性，万维网联盟（W3C，World Wide Web Consortium）开始制定DOM标准的进程。

#### 2.DOM级别

1. 1998年10月，**DOM Level 1** 成为W3C的推荐标准。由以下两个模块组成：

* DOM Core  ： 映射XML文档，从而方便访问和操作文档任意部分的方式
* DOM HTML  ：扩展了Core，并增加了特定于HTML的对象和方法

2. DOM Level 1 的目标是映射文档结构，而**DOM Level 2**的目标则宽泛得多。对最初DOM的扩展增加了<u>对（DHTML早就支持的）鼠标和用户界面事件、范围、遍历的支持</u>，而且<u>通过对象接口支持了层叠样式表CSS</u>。DOM Level 1 中的DOM Core也<u>被扩展以包含对XML命名空间的支持</u>。

​       DOM Level 2新增了以下模块，以支持新的接口

* DOM视图：描述追踪文档不同视图（如应用CSS样式前后的文档）的接口
* DOM事件：描述事件及事件处理接口
* DOM样式：描述处理元素CSS样式的接口
* DOM遍历和范围：描述遍历和操作DOM树的接口

3. **DOM Level 3**进一步扩展了DOM，增加了以统一的方式加载和保存文档的方法（包含在一个叫DOM Load and Save的新模块中），还有验证文档的方法（DOM Validation）。在Level3中，DOM Core经过扩展支持了所有XML1.0的特性，包括XML Infoset、XPath 和 XML Base
4. 目前，W3C不再按照Level来维护DOM了，而是作为DOM Living Standard来维护，其快照称为DOM4，DOM4新增的内容包括替代Mutation Events的Mutation Observers

#### 3.其他DOM

> 除了DOM Core和DOM HTML接口，有些其他语言也发布了自己的DOM标准。

以下语言均基于XML，每一种都增加了该语言独有的DOM方法和接口：

W3C推荐标准：

* 可伸缩矢量图（SVG，Scalable Vector Graphics）
* 数学标记语言（MathML，Mathematical Markup Language）
* 同步多媒体集成语言（SMIL，Synchronization Multimedia Integration Language）

非W3C推荐的标准：

* Mozilla的XML用户界面语言（XUL，XML　User　Interface　Language）

#### ４.Web浏览器对DOM的支持情况


| 浏览器                        | DOM兼容                                       |
| ----------------------------- | --------------------------------------------- |
| Netscape Navigator１～４.ｘ   | —                                             |
| Netscape 6+（Mozilla 0.6.0+） | Level１、Level２（几乎全部）、Level３（部分） |
| IE２～4.ｘ                    | —                                             |
| IE5                           | Level１（很少）                               |
| IE5.5~8                       | Level１（几乎全部）                           |
| IE９＋                        | Level１、Level２、Level３                     |
| Edge                          | Level１、Level２、Level３                     |
| Opera１～６                   | —                                             |
| Opera7～８.ｘ                 | Level１（几乎全部）、Level２（部分）          |
| Opera９～９.９                | Level１、Level２（几乎全部）、Level３（部分） |
| Opera１０＋                   | Level１、Level２、Level３（部分）             |
| Safari１.０.ｘ                | Level１                                       |
| Safari２＋                    | Level１、Level２（全部）、Level３（部分）     |
| iOS Safari3.２＋              | Level１、Level２（全部）、Level３（部分）     |
| Chrome1＋                     | Level１、Level２（全部）、Level３（部分）     |
| Firefox1＋                    | Level１、Level２（几乎全部）、Level３（部分） |

### 1.2.3 BOM

**浏览器对象模型**（BOM）API，用于支持访问和操作浏览器的窗口。

> 它是唯一一个没有相关标准的JavaScript实现。后来html5以正式规范的形式涵盖了尽可能多的DOM特性

BOM主要针对浏览器窗口和子窗口（frame），通常人们会把任何特定于浏览器的扩展都归在BOM的范畴内，下面就是这样一些扩展：

* 弹出新浏览器窗口的能力
* 移动、缩放和关闭浏览器窗口的能力
* navigator对象，提供关于浏览器的详尽信息
* location对象，提供浏览器加载页面的详尽信息
* screen对象，提供关于用户屏幕分辨率的详尽信息
* performance对象，提供浏览器内存占用，导航行为和事件统计的详尽信息
* 对cookie的支持
* 其他自定义对象，如XMLHttpRequest和IE的ActiveXObject



## 1.3 JavaScript版本

| 浏览器                       | JavaScript版本 |
| ---------------------------- | -------------- |
| Netscape Navigator2          | 1.0            |
| Netscape Navigator3          | 1.1            |
| Netscape Navigator4          | 1.2            |
| Netscape Navigator4.06       | 1.3            |
| Navigator6+（Mozilla0.6.0+） | 1.5            |
| Firefox1                     | 1.5            |
| Firefox1.5                   | 1.6            |
| Firefox2                     | 1.7            |
| Firefox3                     | 1.8            |
| Firefox3.5                   | 1.8.1          |
| Firefox3.6                   | 1.8.2          |
| Firefox4                     | 1.8.5          |

> Netscape/Mozilla仍然沿用这种版本方案，而IE的JScript有不同的版本号规则
>
> 多数浏览器对JavaScript的支持，指的是实现ECMAScript和DOM的程度

## 1.4 小结

JavaScript是一门用来于网页交互的脚本语言，包含以下三个组成部分：

* ECMAScript
* DOM
* BOM

JavaScript的这三个部分得到了五大web浏览器（IE、Firefox、Chrome、Safari和Opera）不同程度的支持；

所有浏览器基本上对ES5提供了完善的支持，对ES6和ES7的支持度也在不断提升；

这些浏览器对DOM的支持各不相同，但对Level3的支持日益趋于规范；

HTML5中收录的BOM会因浏览器而异，不过开发者可以假定存在很大一部分公共特性