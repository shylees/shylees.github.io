---
title: 回调地狱及其解决方案
date: 2021/11/20
updated: 2021/11/26
comments:
tags:
 - es6
 - promise
categories:
 - furtherNotes
layout:
permalink:
meta: true
---


> 同步异步 promise 引申
>
> https://www.cnblogs.com/sonsmart/p/15265626.html


### 1. 回调地狱

#### 1.1 先导概念

**回调函数**：当一个函数作为参数传入另一个参数中，其不会立即执行，只有当满足一定条件后该函数才可以执行，这种函数称为回调函数。

> 其中定时器和ajax就存在回调函数

> eg：
>
> ~~~js
> setTimeout(function(){
>     console.log('执行回调函数');
> },3000)
> ~~~
>
> ~~~js
> let xhr = new XMLHttpRequest();
> xhr.onreadystatechange = function(){ ... }
> xhr.open(...);
> xhr.send();
> ~~~
>
> 上面的回调函数分别为：function(){ console.log() }、和onreadystatechange 绑定的函数，其中的执行条件分别为 3秒后 和 send发送请求并拿到响应后执行。



**同步任务**：在主线程上排队执行，只有前一个任务执行完毕，才能执行下一个任务。

**异步任务**：不进入主线程，而是进入异步队列，前一个任务是否执行完毕不影响下一个任务的执行。

> eg：
>
> ~~~js
> setTimeout(function(){
>     console.log('执行回调函数');
> },3000)
> console.log('111');
> ~~~
>
> 这种不阻塞后面任务执行的任务就叫异步任务。



#### 1.2 回调地狱

— 为了在异步函数当中顺序执行代码而不断**嵌套调用回调函数**

> eg：
>
> ~~~js
> setTimeout(function(){
>     console.log('first');
>     setTimeout(function(){
>         console.log('sencond');
>         setTimeout(function(){
>             console.log('thrid')
>         },1000)
>     },1000)
> },1000)
> ~~~
>
> 这种回调函数中嵌套回调函数的情况就是回调地狱

总结：**回调地狱就是为了实现代码顺序执行而出现的一种操作，**它会造成代码可读性差，后期不好维护。



### 2. 如何解决回调地狱

1. Promise：编写异步代码的一种方式，它仍然以自顶向下的方式执行，并且由于鼓励使用try / catch 样式错误处理而处理更多类型的错误
2. generators 生成器可以让你暂停单个函数，而不会暂停整个程序的状态，但代码稍微复杂一些，以使代码看起来像自上而下地执行
3. async / await 异步函数是一个建议的 es7 功能，将以更高级别的语法进一步包装生成器和承诺

#### 2.1 Promise

#### 2.2 Generators

#### 2.3 async / await































